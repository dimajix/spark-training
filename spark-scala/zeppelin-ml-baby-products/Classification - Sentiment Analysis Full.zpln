{"paragraphs":[{"text":"%md\n# Load Data\n\nFirst we load data from HDFS or S3. It is stored as a trivial CSV file with three columns\n\n* product name\n* review text\n* rating (1 - 5)\n\nWe will explicitly specify a Schema, because the CSV might not contain a valid header. Moreover this keeps us in detailed control over the column types and saves us from one Spark run trying to guess the types. ","dateUpdated":"2018-03-24T17:50:10+0000","config":{"editorSetting":{},"colWidth":12,"editorMode":"ace/mode/markdown","editorHide":true,"results":[{"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}}}],"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h1>Load Data</h1>\n<p>First we load data from HDFS or S3. It is stored as a trivial CSV file with three columns</p>\n<ul>\n<li>product name</li>\n<li>review text</li>\n<li>rating (1 - 5)</li>\n</ul>\n<p>We will explicitly specify a Schema, because the CSV might not contain a valid header. Moreover this keeps us in detailed control over the column types and saves us from one Spark run trying to guess the types.</p>\n"}]},"apps":[],"jobName":"paragraph_1521913810465_-2136591714","id":"20170129-041356_575741458","dateCreated":"2018-03-24T17:50:10+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:30013"},{"text":"//val basedir = \"file:///home/cloudera/Training/data/\"\nval basedir = \"s3://dimajix-training/data/\"","dateUpdated":"2018-03-24T17:50:10+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false},"colWidth":12,"editorMode":"ace/mode/scala","results":{},"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1521913810466_-2135437467","id":"20170129-045843_673583787","dateCreated":"2018-03-24T17:50:10+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:30014"},{"text":"import org.apache.spark.sql.types.StructType\nimport org.apache.spark.sql.types.StructField\nimport org.apache.spark.sql.types.StringType\nimport org.apache.spark.sql.types.IntegerType\nimport org.apache.spark.sql.functions.col\n\n// Explicitly build the schema as we expect it in the CSV file. Note that we also assume \"rating\" to be string type. This saves\n// us from errors due to wrong entries. Casting a String to something else later only produces SQL NULL values, but no errors.\nval schema = StructType(\n        StructField(\"name\", StringType) ::\n        StructField(\"review\", StringType) ::\n        StructField(\"rating\", StringType) ::\n        Nil\n    )\n// Read in CSV data and cast rating column to integer    \nval csvdata = spark.read\n    .schema(schema)\n    .csv(basedir + \"amazon_baby\")\n    .withColumn(\"rating\", col(\"rating\").cast(IntegerType))\n    .filter(col(\"rating\").isNotNull)\nz.show(csvdata.limit(10))","dateUpdated":"2018-03-24T17:50:10+0000","config":{"colWidth":12,"editorMode":"ace/mode/scala","results":[{"graph":{"mode":"table","height":230.36666870117188,"optionOpen":false,"keys":[{"name":"name","index":0,"aggr":"sum"}],"values":[{"name":"review","index":1,"aggr":"sum"}],"groups":[],"scatter":{"xAxis":{"name":"name","index":0,"aggr":"sum"},"yAxis":{"name":"review","index":1,"aggr":"sum"}}}}],"enabled":true,"editorSetting":{"language":"scala","editOnDblClick":false}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"name\treview\trating\nPlanetwise Flannel Wipes\tThese flannel wipes are OK, but in my opinion not worth keeping.  I also ordered someImse Vimse Cloth Wipes-Ocean Blue-12 countwhich are larger, had a nicer, softer texture and just seemed higher quality.  I use cloth wipes for hands and faces and have been usingThirsties 6 Pack Fab Wipes, Boyfor about 8 months now and need to replace them because they are starting to get rough and have had stink issues for a while that stripping no longer handles.\t3\nPlanetwise Wipe Pouch\tit came early and was not disappointed. i love planet wise bags and now my wipe holder. it keps my osocozy wipes moist and does not leak. highly recommend it.\t5\nAnnas Dream Full Quilt with 2 Shams\tVery soft and comfortable and warmer than it looks...fit the full size bed perfectly...would recommend to anyone looking for this type of quilt\t5\nStop Pacifier Sucking without tears with Thumbuddy To Love's Binky Fairy Puppet and Adorable Book\tThis is a product well worth the purchase.  I have not found anything else like this, and it is a positive, ingenious approach to losing the binky.  What I love most about this product is how much ownership my daughter has in getting rid of the binky.  She is so proud of herself, and loves her little fairy.  I love the artwork, the chart in the back, and the clever approach of this tool.\t5\nStop Pacifier Sucking without tears with Thumbuddy To Love's Binky Fairy Puppet and Adorable Book\tAll of my kids have cried non-stop when I tried to ween them off their pacifier, until I found Thumbuddy To Love's Binky Fairy Puppet.  It is an easy way to work with your kids to allow them to understand where their pacifier is going and help them part from it.This is a must buy book, and a great gift for expecting parents!!  You will save them soo many headaches.Thanks for this book!  You all rock!!\t5\nStop Pacifier Sucking without tears with Thumbuddy To Love's Binky Fairy Puppet and Adorable Book\tWhen the Binky Fairy came to our house, we didn't have any special gift and book to help explain to her about how important it is to stop using a pacifier. This book does a great job to help prepare your child for the loss of their favorite item. The doll is adorable and we made lots of cute movies with the Binky Fairy telling our daughter about what happens when the Binky Fairy comes. I would highly recommend this product for any parent trying to break the pacifier or thumb sucking habit.\t5\nA Tale of Baby's Days with Peter Rabbit\tLovely book, it's bound tightly so you may not be able to add alot of photos/cards aside from the designated spaces in the book. Shop around before you purchase, as it is currently listed at Barnes & Noble for 29.95!\t4\nBaby Tracker&reg; - Daily Childcare Journal, Schedule Log\tPerfect for new parents. We were able to keep track of baby's feeding, sleep and diaper change schedule for the first two and a half months of her life. Made life easier when the doctor would ask questions about habits because we had it all right there!\t5\nBaby Tracker&reg; - Daily Childcare Journal, Schedule Log\tA friend of mine pinned this product on Pinterest so I decided to give it a whirl! It is fantastic! If you are a new parent, this will help you keep track of feedings, diaper changes and the like!\t5\nBaby Tracker&reg; - Daily Childcare Journal, Schedule Log\tThis has been an easy way for my nanny to record all the key events that happen with my baby when I'm not at home.  Would highly recommend it to someone who wants to stay informed of what your baby is up to while you're not home.The only reason this isn't a 5 is because I think there could have been some more standarad pre-printed options.I plan on ordering another one when we run out of pages in this journal.\t4\n"}]},"apps":[],"jobName":"paragraph_1521913810467_-2135822216","id":"20170129-041420_2034427172","dateCreated":"2018-03-24T17:50:10+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:30015"},{"text":"%md\n# Extract Features from raw data\n\nWe want to train a logistic regression for predicting the sentiment of a product review given its text. Since a logistic regression does not directly work with text, we need to extract some numeric features from the data.\n\nWe will perform the two following extractions, one for the label to be binary and a multi-step extraction for the features.\n\n1. Extract binary sentiment from given review value\n2. Extract bag-of-words model as features","dateUpdated":"2018-03-24T17:50:10+0000","config":{"editorSetting":{},"colWidth":12,"editorMode":"ace/mode/markdown","editorHide":true,"results":[{"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}}}],"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h1>Extract Features from raw data</h1>\n<p>We want to train a logistic regression for predicting the sentiment of a product review given its text. Since a logistic regression does not directly work with text, we need to extract some numeric features from the data.</p>\n<p>We will perform the two following extractions, one for the label to be binary and a multi-step extraction for the features.</p>\n<ol>\n<li>Extract binary sentiment from given review value</li>\n<li>Extract bag-of-words model as features</li>\n</ol>\n"}]},"apps":[],"jobName":"paragraph_1521913810467_-2135822216","id":"20170129-052423_858609389","dateCreated":"2018-03-24T17:50:10+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:30016"},{"text":"%md\n## 1. Extract Sentiment\n\nSince we want to perform a classification (positive review vs negative review), we need to extract a binary sentiment value. We will map the ratings as follows:\n\n* Ratings 1 and 2 count as a negative review\n* Rating 3 counts as a neutral review\n* Ratings 4 and 5 count as a positive review\n\nSince we want a binary classification, we will also remove neutral reviews altogether.\n","dateUpdated":"2018-03-24T17:50:10+0000","config":{"editorSetting":{},"colWidth":12,"editorMode":"ace/mode/markdown","editorHide":true,"results":[{"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}}}],"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h2>1. Extract Sentiment</h2>\n<p>Since we want to perform a classification (positive review vs negative review), we need to extract a binary sentiment value. We will map the ratings as follows:</p>\n<ul>\n<li>Ratings 1 and 2 count as a negative review</li>\n<li>Rating 3 counts as a neutral review</li>\n<li>Ratings 4 and 5 count as a positive review</li>\n</ul>\n<p>Since we want a binary classification, we will also remove neutral reviews altogether.</p>\n"}]},"apps":[],"jobName":"paragraph_1521913810468_-2137745961","id":"20170129-042008_1516671555","dateCreated":"2018-03-24T17:50:10+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:30017"},{"text":"val data = csvdata.filter(csvdata(\"rating\") !== 3)\n        .withColumn(\"sentiment\", when(csvdata(\"rating\") < 3, 0.0).otherwise(1.0))\n\nz.show(data.limit(10))","dateUpdated":"2018-03-24T17:50:10+0000","config":{"colWidth":12,"editorMode":"ace/mode/scala","results":[{"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}}}],"enabled":true,"editorSetting":{"language":"scala","editOnDblClick":false}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"name\treview\trating\tsentiment\nPlanetwise Wipe Pouch\tit came early and was not disappointed. i love planet wise bags and now my wipe holder. it keps my osocozy wipes moist and does not leak. highly recommend it.\t5\t1.0\nAnnas Dream Full Quilt with 2 Shams\tVery soft and comfortable and warmer than it looks...fit the full size bed perfectly...would recommend to anyone looking for this type of quilt\t5\t1.0\nStop Pacifier Sucking without tears with Thumbuddy To Love's Binky Fairy Puppet and Adorable Book\tThis is a product well worth the purchase.  I have not found anything else like this, and it is a positive, ingenious approach to losing the binky.  What I love most about this product is how much ownership my daughter has in getting rid of the binky.  She is so proud of herself, and loves her little fairy.  I love the artwork, the chart in the back, and the clever approach of this tool.\t5\t1.0\nStop Pacifier Sucking without tears with Thumbuddy To Love's Binky Fairy Puppet and Adorable Book\tAll of my kids have cried non-stop when I tried to ween them off their pacifier, until I found Thumbuddy To Love's Binky Fairy Puppet.  It is an easy way to work with your kids to allow them to understand where their pacifier is going and help them part from it.This is a must buy book, and a great gift for expecting parents!!  You will save them soo many headaches.Thanks for this book!  You all rock!!\t5\t1.0\nStop Pacifier Sucking without tears with Thumbuddy To Love's Binky Fairy Puppet and Adorable Book\tWhen the Binky Fairy came to our house, we didn't have any special gift and book to help explain to her about how important it is to stop using a pacifier. This book does a great job to help prepare your child for the loss of their favorite item. The doll is adorable and we made lots of cute movies with the Binky Fairy telling our daughter about what happens when the Binky Fairy comes. I would highly recommend this product for any parent trying to break the pacifier or thumb sucking habit.\t5\t1.0\nA Tale of Baby's Days with Peter Rabbit\tLovely book, it's bound tightly so you may not be able to add alot of photos/cards aside from the designated spaces in the book. Shop around before you purchase, as it is currently listed at Barnes & Noble for 29.95!\t4\t1.0\nBaby Tracker&reg; - Daily Childcare Journal, Schedule Log\tPerfect for new parents. We were able to keep track of baby's feeding, sleep and diaper change schedule for the first two and a half months of her life. Made life easier when the doctor would ask questions about habits because we had it all right there!\t5\t1.0\nBaby Tracker&reg; - Daily Childcare Journal, Schedule Log\tA friend of mine pinned this product on Pinterest so I decided to give it a whirl! It is fantastic! If you are a new parent, this will help you keep track of feedings, diaper changes and the like!\t5\t1.0\nBaby Tracker&reg; - Daily Childcare Journal, Schedule Log\tThis has been an easy way for my nanny to record all the key events that happen with my baby when I'm not at home.  Would highly recommend it to someone who wants to stay informed of what your baby is up to while you're not home.The only reason this isn't a 5 is because I think there could have been some more standarad pre-printed options.I plan on ordering another one when we run out of pages in this journal.\t4\t1.0\nBaby Tracker&reg; - Daily Childcare Journal, Schedule Log\tI love this journal and our nanny uses it everyday to track on our daughter's sleep, eating and other activities. The layout and design make it very easy to fill in quickly with a comments column to add in details (i.e. we ask the nanny to specify what food she had for lunch, amount of milk she took, specifics of play time--tummy time, walk to park, etc.) I love knowing the details of my baby's day, and I also use it to track weekly on overall schedule patterns and changes (i.e. baby's nap time has moved naturally as she gets older).My only complaint is that there is no real space to communicate back to the nanny, as I sometimes want to reply to the nanny's comments and/or leave her notes about the previous night (i.e. Baby didn't sleep well or baby has rash, etc) or other instructions (Please use sun screen on the baby - it's hot out today) that I often forget to tell her in the rush of the morning. I just stick in post-its now for my notes. All in all, I highly recommend this baby tracker.\t4\t1.0\n"}]},"apps":[],"jobName":"paragraph_1521913810468_-2137745961","id":"20170129-042350_2056232695","dateCreated":"2018-03-24T17:50:10+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:30018"},{"text":"%md\n## 2. Extract Features from Reviews\n\nNow we want to split the review text into individual words, so we can create a \"bag of words\" model. In order to get a somewhat nice model, we also need to remove all punctuations from the reviews.\n\n### 2.1. Remove Punctuations\nSo the first step is to remove all puncuations.  This will be done as the first step using a user defined function (UDF) in Spark, which will simply replace any punctuation character by a space.","dateUpdated":"2018-03-24T17:50:10+0000","config":{"editorSetting":{},"colWidth":12,"editorMode":"ace/mode/markdown","editorHide":true,"results":[{"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}}}],"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h2>2. Extract Features from Reviews</h2>\n<p>Now we want to split the review text into individual words, so we can create a &ldquo;bag of words&rdquo; model. In order to get a somewhat nice model, we also need to remove all punctuations from the reviews.</p>\n<h3>2.1. Remove Punctuations</h3>\n<p>So the first step is to remove all puncuations.  This will be done as the first step using a user defined function (UDF) in Spark, which will simply replace any punctuation character by a space.</p>\n"}]},"apps":[],"jobName":"paragraph_1521913810469_-2138130710","id":"20170129-043924_1480728312","dateCreated":"2018-03-24T17:50:10+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:30019"},{"text":"import org.apache.spark.sql.functions.udf\n\nval removePunctuation = udf { text:String => if (text != null) text.replaceAll(\"\\\\p{Punct}\", \" \") else \"\" }\nval data2 = data.withColumn(\"review\",removePunctuation(data(\"review\")))\nz.show(data2.limit(10))","dateUpdated":"2018-03-24T17:50:10+0000","config":{"colWidth":12,"editorMode":"ace/mode/scala","results":[{"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}}}],"enabled":true,"editorSetting":{"language":"scala","editOnDblClick":false}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"name\treview\trating\tsentiment\nPlanetwise Wipe Pouch\tit came early and was not disappointed  i love planet wise bags and now my wipe holder  it keps my osocozy wipes moist and does not leak  highly recommend it \t5\t1.0\nAnnas Dream Full Quilt with 2 Shams\tVery soft and comfortable and warmer than it looks   fit the full size bed perfectly   would recommend to anyone looking for this type of quilt\t5\t1.0\nStop Pacifier Sucking without tears with Thumbuddy To Love's Binky Fairy Puppet and Adorable Book\tThis is a product well worth the purchase   I have not found anything else like this  and it is a positive  ingenious approach to losing the binky   What I love most about this product is how much ownership my daughter has in getting rid of the binky   She is so proud of herself  and loves her little fairy   I love the artwork  the chart in the back  and the clever approach of this tool \t5\t1.0\nStop Pacifier Sucking without tears with Thumbuddy To Love's Binky Fairy Puppet and Adorable Book\tAll of my kids have cried non stop when I tried to ween them off their pacifier  until I found Thumbuddy To Love s Binky Fairy Puppet   It is an easy way to work with your kids to allow them to understand where their pacifier is going and help them part from it This is a must buy book  and a great gift for expecting parents    You will save them soo many headaches Thanks for this book   You all rock  \t5\t1.0\nStop Pacifier Sucking without tears with Thumbuddy To Love's Binky Fairy Puppet and Adorable Book\tWhen the Binky Fairy came to our house  we didn t have any special gift and book to help explain to her about how important it is to stop using a pacifier  This book does a great job to help prepare your child for the loss of their favorite item  The doll is adorable and we made lots of cute movies with the Binky Fairy telling our daughter about what happens when the Binky Fairy comes  I would highly recommend this product for any parent trying to break the pacifier or thumb sucking habit \t5\t1.0\nA Tale of Baby's Days with Peter Rabbit\tLovely book  it s bound tightly so you may not be able to add alot of photos cards aside from the designated spaces in the book  Shop around before you purchase  as it is currently listed at Barnes   Noble for 29 95 \t4\t1.0\nBaby Tracker&reg; - Daily Childcare Journal, Schedule Log\tPerfect for new parents  We were able to keep track of baby s feeding  sleep and diaper change schedule for the first two and a half months of her life  Made life easier when the doctor would ask questions about habits because we had it all right there \t5\t1.0\nBaby Tracker&reg; - Daily Childcare Journal, Schedule Log\tA friend of mine pinned this product on Pinterest so I decided to give it a whirl  It is fantastic  If you are a new parent  this will help you keep track of feedings  diaper changes and the like \t5\t1.0\nBaby Tracker&reg; - Daily Childcare Journal, Schedule Log\tThis has been an easy way for my nanny to record all the key events that happen with my baby when I m not at home   Would highly recommend it to someone who wants to stay informed of what your baby is up to while you re not home The only reason this isn t a 5 is because I think there could have been some more standarad pre printed options I plan on ordering another one when we run out of pages in this journal \t4\t1.0\nBaby Tracker&reg; - Daily Childcare Journal, Schedule Log\tI love this journal and our nanny uses it everyday to track on our daughter s sleep  eating and other activities  The layout and design make it very easy to fill in quickly with a comments column to add in details  i e  we ask the nanny to specify what food she had for lunch  amount of milk she took  specifics of play time  tummy time  walk to park  etc   I love knowing the details of my baby s day  and I also use it to track weekly on overall schedule patterns and changes  i e  baby s nap time has moved naturally as she gets older  My only complaint is that there is no real space to communicate back to the nanny  as I sometimes want to reply to the nanny s comments and or leave her notes about the previous night  i e  Baby didn t sleep well or baby has rash  etc  or other instructions  Please use sun screen on the baby   it s hot out today  that I often forget to tell her in the rush of the morning  I just stick in post its now for my notes  All in all  I highly recommend this baby tracker \t4\t1.0\n"}]},"apps":[],"jobName":"paragraph_1521913810469_-2138130710","id":"20170129-043943_507827673","dateCreated":"2018-03-24T17:50:10+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:30020"},{"text":"%md\n### 2.2 Split Reviews into Words\n\nNow we want to split every review into multiple words, resulting in a new data column containing an array with all words of the review. We could do that ourselves using some Scala methods, but we use a Transformer provided by Spark instead. Saves us some time and helps to create clean code.\n\nSpark ML contains a whole bunch of Transformers for extracting features. You can find them in the `org.apache.spark.ml.feature` package. Each Transformer accepts some parameters for specifying the details of the transformation. In particular most Transformers know about an input column and and output column which can be set via `setInputCol` and `setOutputCol`.\n\nOur specific task for splitting a string column into an array column with individual words can be performed with the `Tokenizer` Transform.\n","dateUpdated":"2018-03-24T17:50:10+0000","config":{"editorSetting":{},"colWidth":12,"editorMode":"ace/mode/markdown","editorHide":true,"results":[{"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}}}],"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h3>2.2 Split Reviews into Words</h3>\n<p>Now we want to split every review into multiple words, resulting in a new data column containing an array with all words of the review. We could do that ourselves using some Scala methods, but we use a Transformer provided by Spark instead. Saves us some time and helps to create clean code.</p>\n<p>Spark ML contains a whole bunch of Transformers for extracting features. You can find them in the <code>org.apache.spark.ml.feature</code> package. Each Transformer accepts some parameters for specifying the details of the transformation. In particular most Transformers know about an input column and and output column which can be set via <code>setInputCol</code> and <code>setOutputCol</code>.</p>\n<p>Our specific task for splitting a string column into an array column with individual words can be performed with the <code>Tokenizer</code> Transform.</p>\n"}]},"apps":[],"jobName":"paragraph_1521913810470_-2136976463","id":"20170129-043958_121242280","dateCreated":"2018-03-24T17:50:10+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:30021"},{"text":"import org.apache.spark.ml.feature.Tokenizer\n\nval tokenizer = new Tokenizer()\n    .setInputCol(\"review\")\n    .setOutputCol(\"words\")\nval words = tokenizer.transform(data2)\n\nz.show(words.limit(6))","dateUpdated":"2018-03-24T17:50:10+0000","config":{"colWidth":12,"editorMode":"ace/mode/scala","results":[{"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[{"name":"name","index":0,"aggr":"sum"}],"values":[{"name":"review","index":1,"aggr":"sum"}],"groups":[],"scatter":{"xAxis":{"name":"name","index":0,"aggr":"sum"},"yAxis":{"name":"review","index":1,"aggr":"sum"}}}}],"enabled":true,"editorSetting":{"language":"scala","editOnDblClick":false}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"name\treview\trating\tsentiment\twords\nPlanetwise Wipe Pouch\tit came early and was not disappointed  i love planet wise bags and now my wipe holder  it keps my osocozy wipes moist and does not leak  highly recommend it \t5\t1.0\tWrappedArray(it, came, early, and, was, not, disappointed, , i, love, planet, wise, bags, and, now, my, wipe, holder, , it, keps, my, osocozy, wipes, moist, and, does, not, leak, , highly, recommend, it)\nAnnas Dream Full Quilt with 2 Shams\tVery soft and comfortable and warmer than it looks   fit the full size bed perfectly   would recommend to anyone looking for this type of quilt\t5\t1.0\tWrappedArray(very, soft, and, comfortable, and, warmer, than, it, looks, , , fit, the, full, size, bed, perfectly, , , would, recommend, to, anyone, looking, for, this, type, of, quilt)\nStop Pacifier Sucking without tears with Thumbuddy To Love's Binky Fairy Puppet and Adorable Book\tThis is a product well worth the purchase   I have not found anything else like this  and it is a positive  ingenious approach to losing the binky   What I love most about this product is how much ownership my daughter has in getting rid of the binky   She is so proud of herself  and loves her little fairy   I love the artwork  the chart in the back  and the clever approach of this tool \t5\t1.0\tWrappedArray(this, is, a, product, well, worth, the, purchase, , , i, have, not, found, anything, else, like, this, , and, it, is, a, positive, , ingenious, approach, to, losing, the, binky, , , what, i, love, most, about, this, product, is, how, much, ownership, my, daughter, has, in, getting, rid, of, the, binky, , , she, is, so, proud, of, herself, , and, loves, her, little, fairy, , , i, love, the, artwork, , the, chart, in, the, back, , and, the, clever, approach, of, this, tool)\nStop Pacifier Sucking without tears with Thumbuddy To Love's Binky Fairy Puppet and Adorable Book\tAll of my kids have cried non stop when I tried to ween them off their pacifier  until I found Thumbuddy To Love s Binky Fairy Puppet   It is an easy way to work with your kids to allow them to understand where their pacifier is going and help them part from it This is a must buy book  and a great gift for expecting parents    You will save them soo many headaches Thanks for this book   You all rock  \t5\t1.0\tWrappedArray(all, of, my, kids, have, cried, non, stop, when, i, tried, to, ween, them, off, their, pacifier, , until, i, found, thumbuddy, to, love, s, binky, fairy, puppet, , , it, is, an, easy, way, to, work, with, your, kids, to, allow, them, to, understand, where, their, pacifier, is, going, and, help, them, part, from, it, this, is, a, must, buy, book, , and, a, great, gift, for, expecting, parents, , , , you, will, save, them, soo, many, headaches, thanks, for, this, book, , , you, all, rock)\nStop Pacifier Sucking without tears with Thumbuddy To Love's Binky Fairy Puppet and Adorable Book\tWhen the Binky Fairy came to our house  we didn t have any special gift and book to help explain to her about how important it is to stop using a pacifier  This book does a great job to help prepare your child for the loss of their favorite item  The doll is adorable and we made lots of cute movies with the Binky Fairy telling our daughter about what happens when the Binky Fairy comes  I would highly recommend this product for any parent trying to break the pacifier or thumb sucking habit \t5\t1.0\tWrappedArray(when, the, binky, fairy, came, to, our, house, , we, didn, t, have, any, special, gift, and, book, to, help, explain, to, her, about, how, important, it, is, to, stop, using, a, pacifier, , this, book, does, a, great, job, to, help, prepare, your, child, for, the, loss, of, their, favorite, item, , the, doll, is, adorable, and, we, made, lots, of, cute, movies, with, the, binky, fairy, telling, our, daughter, about, what, happens, when, the, binky, fairy, comes, , i, would, highly, recommend, this, product, for, any, parent, trying, to, break, the, pacifier, or, thumb, sucking, habit)\nA Tale of Baby's Days with Peter Rabbit\tLovely book  it s bound tightly so you may not be able to add alot of photos cards aside from the designated spaces in the book  Shop around before you purchase  as it is currently listed at Barnes   Noble for 29 95 \t4\t1.0\tWrappedArray(lovely, book, , it, s, bound, tightly, so, you, may, not, be, able, to, add, alot, of, photos, cards, aside, from, the, designated, spaces, in, the, book, , shop, around, before, you, purchase, , as, it, is, currently, listed, at, barnes, , , noble, for, 29, 95)\n"}]},"apps":[],"jobName":"paragraph_1521913810471_-2137361212","id":"20170129-044010_2048325285","dateCreated":"2018-03-24T17:50:10+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:30022"},{"text":"%md\n### 2.3 Remove Stop words\n\nWe also want to remove so called stop words, which are all those tiny words which mainly serve as glue for building sentences. Usually they do not contain much information in a simple bag of words model. So we get rid of them.\n\nThis is so common practice that Spark already contains a `StopWordsRemover` Transformer class for just doing that. Again we need to specify some parameters like `inputCol`, `outputCol` and `stopWords`.\n","dateUpdated":"2018-03-24T17:50:10+0000","config":{"editorSetting":{},"colWidth":12,"editorMode":"ace/mode/markdown","editorHide":true,"results":[{"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}}}],"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h3>2.3 Remove Stop words</h3>\n<p>We also want to remove so called stop words, which are all those tiny words which mainly serve as glue for building sentences. Usually they do not contain much information in a simple bag of words model. So we get rid of them.</p>\n<p>This is so common practice that Spark already contains a <code>StopWordsRemover</code> Transformer class for just doing that. Again we need to specify some parameters like <code>inputCol</code>, <code>outputCol</code> and <code>stopWords</code>.</p>\n"}]},"apps":[],"jobName":"paragraph_1521913810471_-2137361212","id":"20170129-044024_1653567754","dateCreated":"2018-03-24T17:50:10+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:30023"},{"text":"import org.apache.spark.ml.feature.StopWordsRemover\n\nval stopWords = Array(\"the\",\"a\",\"and\",\"or\", \"it\", \"this\", \"of\", \"an\", \"as\", \"in\", \"on\", \"is\", \"are\", \"to\", \"was\", \"for\", \"then\", \"i\", \"my\", \"that\", \"with\", \"we\", \"have\", \"so\", \"you\", \"s\", \"\")\n    \nval stopWordsRemover = new StopWordsRemover()\n    .setInputCol(\"words\")\n    .setOutputCol(\"vwords\")\n    .setStopWords(stopWords)\nval vwords = stopWordsRemover.transform(words)\n\nz.show(vwords.limit(6))","dateUpdated":"2018-03-24T17:50:10+0000","config":{"colWidth":12,"editorMode":"ace/mode/scala","results":[{"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}}}],"enabled":true,"editorSetting":{"language":"scala","editOnDblClick":false}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"name\treview\trating\tsentiment\twords\tvwords\nPlanetwise Wipe Pouch\tit came early and was not disappointed  i love planet wise bags and now my wipe holder  it keps my osocozy wipes moist and does not leak  highly recommend it \t5\t1.0\tWrappedArray(it, came, early, and, was, not, disappointed, , i, love, planet, wise, bags, and, now, my, wipe, holder, , it, keps, my, osocozy, wipes, moist, and, does, not, leak, , highly, recommend, it)\tWrappedArray(came, early, not, disappointed, love, planet, wise, bags, now, wipe, holder, keps, osocozy, wipes, moist, does, not, leak, highly, recommend)\nAnnas Dream Full Quilt with 2 Shams\tVery soft and comfortable and warmer than it looks   fit the full size bed perfectly   would recommend to anyone looking for this type of quilt\t5\t1.0\tWrappedArray(very, soft, and, comfortable, and, warmer, than, it, looks, , , fit, the, full, size, bed, perfectly, , , would, recommend, to, anyone, looking, for, this, type, of, quilt)\tWrappedArray(very, soft, comfortable, warmer, than, looks, fit, full, size, bed, perfectly, would, recommend, anyone, looking, type, quilt)\nStop Pacifier Sucking without tears with Thumbuddy To Love's Binky Fairy Puppet and Adorable Book\tThis is a product well worth the purchase   I have not found anything else like this  and it is a positive  ingenious approach to losing the binky   What I love most about this product is how much ownership my daughter has in getting rid of the binky   She is so proud of herself  and loves her little fairy   I love the artwork  the chart in the back  and the clever approach of this tool \t5\t1.0\tWrappedArray(this, is, a, product, well, worth, the, purchase, , , i, have, not, found, anything, else, like, this, , and, it, is, a, positive, , ingenious, approach, to, losing, the, binky, , , what, i, love, most, about, this, product, is, how, much, ownership, my, daughter, has, in, getting, rid, of, the, binky, , , she, is, so, proud, of, herself, , and, loves, her, little, fairy, , , i, love, the, artwork, , the, chart, in, the, back, , and, the, clever, approach, of, this, tool)\tWrappedArray(product, well, worth, purchase, not, found, anything, else, like, positive, ingenious, approach, losing, binky, what, love, most, about, product, how, much, ownership, daughter, has, getting, rid, binky, she, proud, herself, loves, her, little, fairy, love, artwork, chart, back, clever, approach, tool)\nStop Pacifier Sucking without tears with Thumbuddy To Love's Binky Fairy Puppet and Adorable Book\tAll of my kids have cried non stop when I tried to ween them off their pacifier  until I found Thumbuddy To Love s Binky Fairy Puppet   It is an easy way to work with your kids to allow them to understand where their pacifier is going and help them part from it This is a must buy book  and a great gift for expecting parents    You will save them soo many headaches Thanks for this book   You all rock  \t5\t1.0\tWrappedArray(all, of, my, kids, have, cried, non, stop, when, i, tried, to, ween, them, off, their, pacifier, , until, i, found, thumbuddy, to, love, s, binky, fairy, puppet, , , it, is, an, easy, way, to, work, with, your, kids, to, allow, them, to, understand, where, their, pacifier, is, going, and, help, them, part, from, it, this, is, a, must, buy, book, , and, a, great, gift, for, expecting, parents, , , , you, will, save, them, soo, many, headaches, thanks, for, this, book, , , you, all, rock)\tWrappedArray(all, kids, cried, non, stop, when, tried, ween, them, off, their, pacifier, until, found, thumbuddy, love, s, binky, fairy, puppet, easy, way, work, your, kids, allow, them, understand, where, their, pacifier, going, help, them, part, from, must, buy, book, great, gift, expecting, parents, will, save, them, soo, many, headaches, thanks, book, all, rock)\nStop Pacifier Sucking without tears with Thumbuddy To Love's Binky Fairy Puppet and Adorable Book\tWhen the Binky Fairy came to our house  we didn t have any special gift and book to help explain to her about how important it is to stop using a pacifier  This book does a great job to help prepare your child for the loss of their favorite item  The doll is adorable and we made lots of cute movies with the Binky Fairy telling our daughter about what happens when the Binky Fairy comes  I would highly recommend this product for any parent trying to break the pacifier or thumb sucking habit \t5\t1.0\tWrappedArray(when, the, binky, fairy, came, to, our, house, , we, didn, t, have, any, special, gift, and, book, to, help, explain, to, her, about, how, important, it, is, to, stop, using, a, pacifier, , this, book, does, a, great, job, to, help, prepare, your, child, for, the, loss, of, their, favorite, item, , the, doll, is, adorable, and, we, made, lots, of, cute, movies, with, the, binky, fairy, telling, our, daughter, about, what, happens, when, the, binky, fairy, comes, , i, would, highly, recommend, this, product, for, any, parent, trying, to, break, the, pacifier, or, thumb, sucking, habit)\tWrappedArray(when, binky, fairy, came, our, house, didn, t, any, special, gift, book, help, explain, her, about, how, important, stop, using, pacifier, book, does, great, job, help, prepare, your, child, loss, their, favorite, item, doll, adorable, made, lots, cute, movies, binky, fairy, telling, our, daughter, about, what, happens, when, binky, fairy, comes, would, highly, recommend, product, any, parent, trying, break, pacifier, thumb, sucking, habit)\nA Tale of Baby's Days with Peter Rabbit\tLovely book  it s bound tightly so you may not be able to add alot of photos cards aside from the designated spaces in the book  Shop around before you purchase  as it is currently listed at Barnes   Noble for 29 95 \t4\t1.0\tWrappedArray(lovely, book, , it, s, bound, tightly, so, you, may, not, be, able, to, add, alot, of, photos, cards, aside, from, the, designated, spaces, in, the, book, , shop, around, before, you, purchase, , as, it, is, currently, listed, at, barnes, , , noble, for, 29, 95)\tWrappedArray(lovely, book, s, bound, tightly, may, not, be, able, add, alot, photos, cards, aside, from, designated, spaces, book, shop, around, before, purchase, currently, listed, at, barnes, noble, 29, 95)\n"}]},"apps":[],"jobName":"paragraph_1521913810472_-2139284956","id":"20170129-044037_1562436005","dateCreated":"2018-03-24T17:50:10+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:30024"},{"text":"%md\nNow lets have a look at common words. Maybe we want to change the list of stop words?","dateUpdated":"2018-03-24T17:50:10+0000","config":{"editorSetting":{},"colWidth":12,"editorMode":"ace/mode/scala","editorHide":true,"results":[{"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}}}],"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<p>Now lets have a look at common words. Maybe we want to change the list of stop words?</p>\n"}]},"apps":[],"jobName":"paragraph_1521913810472_-2139284956","id":"20170129-103148_909017422","dateCreated":"2018-03-24T17:50:10+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:30025"},{"text":"import org.apache.spark.sql.functions.explode\n\nval term_freq = vwords\n    .select(explode(vwords(\"vwords\")).alias(\"word\"))\n    .groupBy(col(\"word\")).count()\n\nz.show(term_freq.orderBy(col(\"count\").desc).limit(10))","dateUpdated":"2018-03-24T17:50:10+0000","config":{"colWidth":12,"editorMode":"ace/mode/scala","results":[{"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[{"name":"word","index":0,"aggr":"sum"}],"values":[{"name":"count","index":1,"aggr":"sum"}],"groups":[],"scatter":{"xAxis":{"name":"word","index":0,"aggr":"sum"},"yAxis":{"name":"count","index":1,"aggr":"sum"}}}}],"enabled":true,"editorSetting":{"language":"scala","editOnDblClick":false}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"word\tcount\nbut\t87326\nt\t84871\ns\t75227\nnot\t73570\nbaby\t64630\nthey\t61610\none\t60035\nvery\t57412\nwhen\t52551\ngreat\t52288\n"}]},"apps":[],"jobName":"paragraph_1521913810473_-2139669705","id":"20170129-103147_26603517","dateCreated":"2018-03-24T17:50:10+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:30026"},{"text":"%md\n### 2.4 Create Bag of Words Features\n\nFinally we simply count the number of occurances of all words within the reviews. Again we can simply use a `CountVectorizer` Transformer from the `org.apache.spark.ml.feature` package in Spark to perform that task. Again we need to specify `inputCol` and `outputCol`. Additionally we require that each word appears in at least two documents, to ensure some basic significance and avoid fitting the sentiment of a document onto single words.\n","dateUpdated":"2018-03-24T17:50:10+0000","config":{"editorSetting":{},"colWidth":12,"editorMode":"ace/mode/markdown","editorHide":true,"results":[{"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}}}],"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h3>2.4 Create Bag of Words Features</h3>\n<p>Finally we simply count the number of occurances of all words within the reviews. Again we can simply use a <code>CountVectorizer</code> Transformer from the <code>org.apache.spark.ml.feature</code> package in Spark to perform that task. Again we need to specify <code>inputCol</code> and <code>outputCol</code>. Additionally we require that each word appears in at least two documents, to ensure some basic significance and avoid fitting the sentiment of a document onto single words.</p>\n"}]},"apps":[],"jobName":"paragraph_1521913810474_-2138515459","id":"20170129-044054_945211724","dateCreated":"2018-03-24T17:50:10+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:30027"},{"text":"import org.apache.spark.ml.feature.CountVectorizer\n\nval countVectorizer = new CountVectorizer()\n    .setInputCol(\"vwords\")\n    .setOutputCol(\"features\")\n    .setMinDF(2.0)\nval countVectorizerModel = countVectorizer.fit(vwords)","dateUpdated":"2018-03-24T17:50:10+0000","config":{"colWidth":12,"editorMode":"ace/mode/scala","results":[{"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}}}],"enabled":true,"editorSetting":{"language":"scala","editOnDblClick":false}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"\nimport org.apache.spark.ml.feature.CountVectorizer\n\ncountVectorizer: org.apache.spark.ml.feature.CountVectorizer = cntVec_e15fb2aedf0c\n\ncountVectorizerModel: org.apache.spark.ml.feature.CountVectorizerModel = cntVec_e15fb2aedf0c\n"}]},"apps":[],"jobName":"paragraph_1521913810474_-2138515459","id":"20170129-044111_370443742","dateCreated":"2018-03-24T17:50:10+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:30028"},{"text":"%md\n### 2.4 Bag of Words - Inspect Vocabulary\n\nThe countVectorizerModel contains an implcit vocabulary containing all words. This can be useful for mapping features back to words\n","dateUpdated":"2018-03-24T17:50:10+0000","config":{"editorSetting":{},"colWidth":12,"editorMode":"ace/mode/markdown","editorHide":true,"results":[{"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}}}],"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h3>2.4 Bag of Words - Inspect Vocabulary</h3>\n<p>The countVectorizerModel contains an implcit vocabulary containing all words. This can be useful for mapping features back to words</p>\n"}]},"apps":[],"jobName":"paragraph_1521913810475_-2138900207","id":"20170129-044132_249596213","dateCreated":"2018-03-24T17:50:10+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:30029"},{"text":"println(countVectorizerModel.vocabulary.take(50))","dateUpdated":"2018-03-24T17:50:10+0000","config":{"colWidth":12,"editorMode":"ace/mode/scala","results":[{"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}}}],"enabled":true,"editorSetting":{"language":"scala","editOnDblClick":false}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"\nmy\nthat\nwith\nwe\nhave\nbut\nt\nso\ns\nnot\nyou\nbaby\nthey\none\nvery\nwhen\ngreat\ncan\nbe\nhe\nshe\nwould\nat\njust\nup\nuse\nthese\nout\nall\nour\nthem\nlike\nlove\nhad\nher\nif\neasy\nhas\nlittle\nseat\nold\nwell\nget\nonly\nfrom\nwill\nproduct\nbecause\nmore\n"}]},"apps":[],"jobName":"paragraph_1521913810475_-2138900207","id":"20170129-044143_1368822013","dateCreated":"2018-03-24T17:50:10+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:30030"},{"text":"%md\n### 2.5 Tidy up DataFrame\n\nWe now carry so many columns inside the DataFrame, let's remove some intermediate columns to get more focus on our model. In particular we remove the following columns:\n* `words`\n* `rating`\n \nWe keep the columns `review`, `name`, `sentiment` and `features`. For the model itself, we do not need `review` and `vwords`, but we will perform some simple checks with these columns later on.\n","dateUpdated":"2018-03-24T17:50:10+0000","config":{"editorSetting":{},"colWidth":12,"editorMode":"ace/mode/markdown","editorHide":true,"results":[{"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}}}],"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h3>2.5 Tidy up DataFrame</h3>\n<p>We now carry so many columns inside the DataFrame, let's remove some intermediate columns to get more focus on our model. In particular we remove the following columns:</p>\n<ul>\n<li><code>words</code></li>\n<li><code>rating</code></li>\n</ul>\n<p>We keep the columns <code>review</code>, <code>name</code>, <code>sentiment</code> and <code>features</code>. For the model itself, we do not need <code>review</code> and <code>vwords</code>, but we will perform some simple checks with these columns later on.</p>\n"}]},"apps":[],"jobName":"paragraph_1521913810476_-2140823952","id":"20170129-044155_1317352834","dateCreated":"2018-03-24T17:50:10+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:30031"},{"text":"val features = countVectorizerModel.transform(vwords).drop(\"words\",\"rating\")\n\nz.show(features.limit(6))","dateUpdated":"2018-03-24T17:50:10+0000","config":{"colWidth":12,"editorMode":"ace/mode/scala","results":[{"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[{"name":"name","index":0,"aggr":"sum"}],"values":[],"groups":[],"scatter":{"xAxis":{"name":"name","index":0,"aggr":"sum"}}}}],"enabled":true,"editorSetting":{"language":"scala","editOnDblClick":false}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"name\treview\tsentiment\tvwords\tfeatures\nPlanetwise Wipe Pouch\tit came early and was not disappointed  i love planet wise bags and now my wipe holder  it keps my osocozy wipes moist and does not leak  highly recommend it \t1.0\tWrappedArray(came, early, not, disappointed, , love, planet, wise, bags, now, my, wipe, holder, , keps, my, osocozy, wipes, moist, does, not, leak, , highly, recommend)\t(29579,[0,1,10,33,63,83,99,224,244,345,422,437,454,657,716,1051,2045,3564,3970,5094],[3.0,2.0,2.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0])\nAnnas Dream Full Quilt with 2 Shams\tVery soft and comfortable and warmer than it looks   fit the full size bed perfectly   would recommend to anyone looking for this type of quilt\t1.0\tWrappedArray(very, soft, comfortable, warmer, than, looks, , , fit, full, size, bed, perfectly, , , would, recommend, anyone, looking, type, quilt)\t(29579,[0,15,22,60,83,97,125,127,176,189,199,238,265,354,457,712,789,2669],[4.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0])\nStop Pacifier Sucking without tears with Thumbuddy To Love's Binky Fairy Puppet and Adorable Book\tThis is a product well worth the purchase   I have not found anything else like this  and it is a positive  ingenious approach to losing the binky   What I love most about this product is how much ownership my daughter has in getting rid of the binky   She is so proud of herself  and loves her little fairy   I love the artwork  the chart in the back  and the clever approach of this tool \t1.0\tWrappedArray(product, well, worth, purchase, , , have, not, found, anything, else, like, , positive, , ingenious, approach, losing, binky, , , what, love, most, about, product, how, much, ownership, my, daughter, has, getting, rid, binky, , , she, so, proud, herself, , loves, her, little, fairy, , , love, artwork, , chart, back, , clever, approach, tool)\t(29579,[0,1,5,8,10,21,32,33,35,38,39,42,47,55,61,62,71,76,88,106,183,204,210,214,218,317,480,792,1644,1885,2099,2449,2975,3116,3523,3780,5119,6647,7068,7783,12259],[13.0,1.0,1.0,1.0,1.0,1.0,1.0,2.0,1.0,1.0,1.0,1.0,2.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,2.0,1.0,1.0,1.0,1.0,1.0,2.0,1.0,1.0])\nStop Pacifier Sucking without tears with Thumbuddy To Love's Binky Fairy Puppet and Adorable Book\tAll of my kids have cried non stop when I tried to ween them off their pacifier  until I found Thumbuddy To Love s Binky Fairy Puppet   It is an easy way to work with your kids to allow them to understand where their pacifier is going and help them part from it This is a must buy book  and a great gift for expecting parents    You will save them soo many headaches Thanks for this book   You all rock  \t1.0\tWrappedArray(all, my, kids, have, cried, non, stop, when, tried, ween, them, off, their, pacifier, , until, found, thumbuddy, love, s, binky, fairy, puppet, , , easy, way, work, with, your, kids, allow, them, understand, where, their, pacifier, going, help, them, part, from, must, buy, book, , great, gift, expecting, parents, , , , you, will, save, them, soo, many, headaches, thanks, book, , , you, all, rock)\t(29579,[0,1,3,5,9,11,16,17,29,31,33,37,45,46,74,80,101,118,126,163,179,190,197,209,210,227,256,276,287,324,348,501,608,737,758,835,864,874,902,933,1193,1363,2640,2975,3585,6363,6647,6676,10423],[9.0,1.0,1.0,1.0,1.0,2.0,1.0,1.0,2.0,4.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,2.0,2.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,2.0,1.0,2.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0])\nStop Pacifier Sucking without tears with Thumbuddy To Love's Binky Fairy Puppet and Adorable Book\tWhen the Binky Fairy came to our house  we didn t have any special gift and book to help explain to her about how important it is to stop using a pacifier  This book does a great job to help prepare your child for the loss of their favorite item  The doll is adorable and we made lots of cute movies with the Binky Fairy telling our daughter about what happens when the Binky Fairy comes  I would highly recommend this product for any parent trying to break the pacifier or thumb sucking habit \t1.0\tWrappedArray(when, binky, fairy, came, our, house, , we, didn, t, have, any, special, gift, book, help, explain, her, about, how, important, stop, using, pacifier, , book, does, great, job, help, prepare, your, child, loss, their, favorite, item, , doll, adorable, we, made, lots, cute, movies, with, binky, fairy, telling, our, daughter, about, what, happens, when, binky, fairy, comes, , would, highly, recommend, product, any, parent, trying, break, pacifier, thumb, sucking, habit)\t(29579,[0,3,4,5,7,16,17,22,30,35,47,55,62,74,83,88,96,98,99,106,111,117,134,146,163,212,224,227,244,266,275,324,355,444,471,532,575,608,629,758,793,859,874,1205,1684,1714,1809,2975,2999,3429,3439,3543,3759,4069,6647,6955],[4.0,1.0,2.0,1.0,1.0,2.0,1.0,1.0,2.0,1.0,1.0,2.0,1.0,1.0,1.0,1.0,1.0,2.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,2.0,1.0,1.0,1.0,1.0,1.0,2.0,1.0,2.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,3.0,1.0,1.0,1.0,1.0,1.0,1.0,3.0,1.0])\nA Tale of Baby's Days with Peter Rabbit\tLovely book  it s bound tightly so you may not be able to add alot of photos cards aside from the designated spaces in the book  Shop around before you purchase  as it is currently listed at Barnes   Noble for 29 95 \t1.0\tWrappedArray(lovely, book, , s, bound, tightly, so, you, may, not, be, able, add, alot, photos, cards, aside, from, designated, spaces, book, , shop, around, before, you, purchase, , currently, listed, at, barnes, , , noble, 29, 95)\t(29579,[0,8,9,10,11,19,23,45,103,160,165,204,353,673,758,1208,1267,1545,1759,2051,2089,2157,2166,2191,2898,3787,3814,6435,7465,17121,18364],[5.0,1.0,1.0,1.0,2.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,2.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0])\n"}]},"apps":[],"jobName":"paragraph_1521913810477_-2141208701","id":"20170129-044205_190711273","dateCreated":"2018-03-24T17:50:10+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:30032"},{"text":"%md\n# Split Train Data / Validation Data\n\nNow let's do the usual split of our data into a training data set and a validation data set. Let's use 80% of all reviews for training and 20% for validation. Again the Spark DataFrame class offers a built in core method to perform the split.\n","dateUpdated":"2018-03-24T17:50:10+0000","config":{"editorSetting":{},"colWidth":12,"editorMode":"ace/mode/markdown","editorHide":true,"results":[{"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}}}],"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h1>Split Train Data / Validation Data</h1>\n<p>Now let's do the usual split of our data into a training data set and a validation data set. Let's use 80% of all reviews for training and 20% for validation. Again the Spark DataFrame class offers a built in core method to perform the split.</p>\n"}]},"apps":[],"jobName":"paragraph_1521913810477_-2141208701","id":"20170129-044218_1046591560","dateCreated":"2018-03-24T17:50:10+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:30033"},{"text":"val Array(trainingData, validationData) = features.randomSplit(Array(0.8,0.2), seed=0)\n\nprintln(s\"Training Data: ${trainingData.count()}\")\nprintln(s\"Validation Data: ${validationData.count()}\")","dateUpdated":"2018-03-24T17:50:10+0000","config":{"colWidth":12,"editorMode":"ace/mode/scala","results":[{"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}}}],"enabled":true,"editorSetting":{"language":"scala","editOnDblClick":false}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"\n\ntrainingData: org.apache.spark.sql.Dataset[org.apache.spark.sql.Row] = [name: string, review: string ... 2 more fields]\nvalidationData: org.apache.spark.sql.Dataset[org.apache.spark.sql.Row] = [name: string, review: string ... 2 more fields]\nTraining Data: 127435\nValidation Data: 31917\n"}]},"apps":[],"jobName":"paragraph_1521913810478_-2140054454","id":"20170129-044229_383362931","dateCreated":"2018-03-24T17:50:10+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:30034"},{"text":"%md\n# Train Classifier\n\nThere are many different classification algorithms out there. We will use a LogisticRegression, of course a DecisionTreeClassifier could be another interesting option.\n","dateUpdated":"2018-03-24T17:50:10+0000","config":{"editorSetting":{},"colWidth":12,"editorMode":"ace/mode/markdown","editorHide":true,"results":[{"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}}}],"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h1>Train Classifier</h1>\n<p>There are many different classification algorithms out there. We will use a LogisticRegression, of course a DecisionTreeClassifier could be another interesting option.</p>\n"}]},"apps":[],"jobName":"paragraph_1521913810479_-2140439203","id":"20170129-044249_824800015","dateCreated":"2018-03-24T17:50:10+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:30035"},{"text":"import org.apache.spark.ml.classification.LogisticRegression\n\nval logisticRegression = new LogisticRegression()\n    .setFeaturesCol(\"features\")\n    .setLabelCol(\"sentiment\")\nval logisticModel = logisticRegression.fit(trainingData)","dateUpdated":"2018-03-24T17:50:10+0000","config":{"colWidth":12,"editorMode":"ace/mode/scala","results":[{"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}}}],"enabled":true,"editorSetting":{"language":"scala","editOnDblClick":false}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"\nimport org.apache.spark.ml.classification.LogisticRegression\n\nlogisticRegression: org.apache.spark.ml.classification.LogisticRegression = logreg_21ef70c0a60a\n\nlogisticModel: org.apache.spark.ml.classification.LogisticRegressionModel = logreg_21ef70c0a60a\n"}]},"apps":[],"jobName":"paragraph_1521913810479_-2140439203","id":"20170129-044302_1834217762","dateCreated":"2018-03-24T17:50:10+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:30036"},{"text":"%md\n# Inspect Model\n\nThe LogisticRegressionModel also uses coefficients mapped to individual words. Let's have a look at them.\n\n","dateUpdated":"2018-03-24T17:50:10+0000","config":{"editorSetting":{},"colWidth":12,"editorMode":"ace/mode/markdown","editorHide":true,"results":[{"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}}}],"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h1>Inspect Model</h1>\n<p>The LogisticRegressionModel also uses coefficients mapped to individual words. Let's have a look at them.</p>\n"}]},"apps":[],"jobName":"paragraph_1521913810480_-2130050983","id":"20170129-044314_1157019956","dateCreated":"2018-03-24T17:50:10+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:30037"},{"text":"logisticModel.coefficients.toArray.take(20).foreach(println)","dateUpdated":"2018-03-24T17:50:10+0000","config":{"colWidth":12,"editorMode":"ace/mode/scala","results":[{"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}}}],"enabled":true,"editorSetting":{"language":"scala","editOnDblClick":false}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"-0.017561437939671715\n0.295161682716593\n0.25021992730435205\n0.27733921214890384\n0.7107988554222496\n0.29477846424060833\n-0.24605239408756102\n-2.6303691532993927\n0.6363081830799967\n0.1592892960051039\n-3.2170773563426023\n-0.09822885696612584\n-0.009343468661259131\n0.24760979861360516\n0.09872012291094587\n-0.10360025738897112\n0.013817174757856548\n4.144903920455417\n1.1193100146109878\n-0.32815204397575903\n"}]},"apps":[],"jobName":"paragraph_1521913810480_-2130050983","id":"20170129-044329_1169250287","dateCreated":"2018-03-24T17:50:10+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:30038"},{"text":"%md\nLet's have a quick look about how many words have a positive weight and how many words have a negative weight.","dateUpdated":"2018-03-24T17:50:10+0000","config":{"editorSetting":{},"colWidth":12,"editorMode":"ace/mode/markdown","editorHide":true,"results":[{"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}}}],"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<p>Let's have a quick look about how many words have a positive weight and how many words have a negative weight.</p>\n"}]},"apps":[],"jobName":"paragraph_1521913810481_-2130435732","id":"20170129-101914_1671147041","dateCreated":"2018-03-24T17:50:10+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:30039"},{"text":"val coefficients = logisticModel.coefficients.toArray\nval numPositiveWeights = coefficients.count(_ > 0)\nval numNegativeWeights = coefficients.count(_ < 0)\n\nprintln(s\"Number positive weights $numPositiveWeights\")\nprintln(s\"Number negative weights $numNegativeWeights\")","dateUpdated":"2018-03-24T17:50:10+0000","config":{"colWidth":12,"editorMode":"ace/mode/scala","results":[{"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}}}],"enabled":true,"editorSetting":{"language":"scala","editOnDblClick":false}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"coefficients: Array[Double] = Array(-0.017561437939671715, 0.295161682716593, 0.25021992730435205, 0.27733921214890384, 0.7107988554222496, 0.29477846424060833, -0.24605239408756102, -2.6303691532993927, 0.6363081830799967, 0.1592892960051039, -3.2170773563426023, -0.09822885696612584, -0.009343468661259131, 0.24760979861360516, 0.09872012291094587, -0.10360025738897112, 0.013817174757856548, 4.144903920455417, 1.1193100146109878, -0.32815204397575903, 0.7291297967074306, 0.9203937758281956, -0.794667308388645, -0.4282252876569603, -0.08061295048887308, -0.00676313387646479, -0.10343827564229385, 0.7125169451993731, -0.5386895485201948, -0.18634222624791286, 0.299533392201347, 0.24415239076737305, 1.2487307728678385, 5.546061728756544, 0.22028981833032443, 0.3299301473534606, -0.5563482...\nnumPositiveWeights: Int = 18132\n\nnumNegativeWeights: Int = 11137\nNumber positive weights 18132\nNumber negative weights 11137\n"}]},"apps":[],"jobName":"paragraph_1521913810481_-2130435732","id":"20170129-044553_1980650936","dateCreated":"2018-03-24T17:50:10+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:30040"},{"text":"%md\n## Find Weights of some Words\n\nLet's check how coefficients look like for some clearly positive or negative words. This can be done by first looking up a specific word in the vocabulary of the CountVectorizerModel and then using that index to retrieve the weight in the LogisticRegressionModel we just trained. ","dateUpdated":"2018-03-24T17:50:10+0000","config":{"editorSetting":{},"colWidth":12,"editorMode":"ace/mode/markdown","editorHide":true,"results":[{"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}}}],"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h2>Find Weights of some Words</h2>\n<p>Let's check how coefficients look like for some clearly positive or negative words. This can be done by first looking up a specific word in the vocabulary of the CountVectorizerModel and then using that index to retrieve the weight in the LogisticRegressionModel we just trained.</p>\n"}]},"apps":[],"jobName":"paragraph_1521913810482_-2129281485","id":"20170129-044409_841287254","dateCreated":"2018-03-24T17:50:10+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:30041"},{"text":"def printWordWeight(word:String) = {\n    val index = countVectorizerModel.vocabulary.indexOf(word)\n    val weight = logisticModel.coefficients(index)\n    println(s\"$word : $weight\")\n}\n    \nprintWordWeight(\"good\")\nprintWordWeight(\"great\")    \nprintWordWeight(\"best\")    \nprintWordWeight(\"ugly\")\nprintWordWeight(\"worst\")\nprintWordWeight(\"cheap\")\n","dateUpdated":"2018-03-24T17:50:10+0000","config":{"colWidth":12,"editorMode":"ace/mode/scala","results":[{"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}}}],"enabled":true,"editorSetting":{"language":"scala","editOnDblClick":false}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"\nprintWordWeight: (word: String)Unit\ngood : 1.6318796942307014\ngreat : 4.144903920455417\nbest : 4.13280592328618\nugly : 2.788884753667541\nworst : -11.463664764540798\ncheap : -2.4951556769690697\n"}]},"apps":[],"jobName":"paragraph_1521913810483_-2129666234","id":"20170129-044413_362370312","dateCreated":"2018-03-24T17:50:10+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:30042"},{"text":"%md\n## Find Extreme Words\n\nLet us try to find the most positive and most negative word according to the weights. This can be achieved using a argmin function to find the index and the vocabulary to map the index to the actual word. Unfortunately Scala does not provide an argmin or argmax function out of the box, so we need to create our own.","dateUpdated":"2018-03-24T17:50:10+0000","config":{"editorSetting":{},"colWidth":12,"editorMode":"ace/mode/markdown","editorHide":true,"results":[{"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}}}],"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h2>Find Extreme Words</h2>\n<p>Let us try to find the most positive and most negative word according to the weights. This can be achieved using a argmin function to find the index and the vocabulary to map the index to the actual word. Unfortunately Scala does not provide an argmin or argmax function out of the box, so we need to create our own.</p>\n"}]},"apps":[],"jobName":"paragraph_1521913810483_-2129666234","id":"20170129-044426_1753481605","dateCreated":"2018-03-24T17:50:10+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:30043"},{"text":"import scala.reflect.ClassTag\n\ndef argmin[X: ClassTag, Y <% Ordered[Y] : ClassTag](n: Iterable[X], f: X => Y): X = {\n  val (argmin: X, min: Y) = n.tail.fold((n.head, f(n.head))) { case ((a: X, m: Y), x: X) =>\n    val fOfx: Y = f(x)\n    if (fOfx < m) (x, fOfx) else (a, m)\n  }\n  return argmin\n}\n  \ndef argmax[X: ClassTag, Y <% Ordered[Y] : ClassTag](n: Iterable[X], f: X => Y): X = {\n  val (argmin: X, min: Y) = n.tail.fold((n.head, f(n.head))) { case ((a: X, m: Y), x: X) =>\n    val fOfx: Y = f(x)\n    if (fOfx > m) (x, fOfx) else (a, m)\n  }\n return argmin\n}","dateUpdated":"2018-03-24T17:50:10+0000","config":{"colWidth":12,"editorMode":"ace/mode/scala","results":[{"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}}}],"enabled":true,"editorSetting":{"language":"scala","editOnDblClick":false}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"\nimport scala.reflect.ClassTag\n\nargmin: [X, Y](n: Iterable[X], f: X => Y)(implicit evidence$1: scala.reflect.ClassTag[X], implicit evidence$2: Y => Ordered[Y], implicit evidence$3: scala.reflect.ClassTag[Y])X\n\nargmax: [X, Y](n: Iterable[X], f: X => Y)(implicit evidence$1: scala.reflect.ClassTag[X], implicit evidence$2: Y => Ordered[Y], implicit evidence$3: scala.reflect.ClassTag[Y])X\n"}]},"apps":[],"jobName":"paragraph_1521913810484_-2131589978","id":"20170129-061136_221790378","dateCreated":"2018-03-24T17:50:10+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:30044"},{"text":"%md\nAlternatively, we can also create simple function idxmin and idxmax.","dateUpdated":"2018-03-24T17:50:10+0000","config":{"editorSetting":{},"colWidth":12,"editorMode":"ace/mode/markdown","editorHide":true,"results":[{"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}}}],"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<p>Alternatively, we can also create simple function idxmin and idxmax.</p>\n"}]},"apps":[],"jobName":"paragraph_1521913810484_-2131589978","id":"20170129-063053_50130364","dateCreated":"2018-03-24T17:50:10+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:30045"},{"text":"import scala.collection.IndexedSeq\nimport scala.reflect.ClassTag\n\ndef idxmin[X  <% Ordered[X]: ClassTag](seq:IndexedSeq[X]) = {\n    seq.zipWithIndex.minBy(_._1)._2\n}\ndef idxmax[X  <% Ordered[X]: ClassTag](seq:IndexedSeq[X]) = {\n    seq.zipWithIndex.maxBy(_._1)._2\n}","dateUpdated":"2018-03-24T17:50:10+0000","config":{"colWidth":12,"editorMode":"ace/mode/scala","results":[{"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}}}],"enabled":true,"editorSetting":{"language":"scala","editOnDblClick":false}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"\nimport scala.collection.IndexedSeq\n\nimport scala.reflect.ClassTag\n\nidxmin: [X](seq: IndexedSeq[X])(implicit evidence$1: X => Ordered[X], implicit evidence$2: scala.reflect.ClassTag[X])Int\n\nidxmax: [X](seq: IndexedSeq[X])(implicit evidence$1: X => Ordered[X], implicit evidence$2: scala.reflect.ClassTag[X])Int\n"}]},"apps":[],"jobName":"paragraph_1521913810485_-2131974727","id":"20170129-062847_749373872","dateCreated":"2018-03-24T17:50:10+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:30046"},{"text":"%md\nWith argmin and argmax in place, we can now find the best and worst words","dateUpdated":"2018-03-24T17:50:10+0000","config":{"editorSetting":{},"colWidth":12,"editorMode":"ace/mode/markdown","editorHide":true,"results":[{"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}}}],"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<p>With argmin and argmax in place, we can now find the best and worst words</p>\n"}]},"apps":[],"jobName":"paragraph_1521913810485_-2131974727","id":"20170129-062010_1045358891","dateCreated":"2018-03-24T17:50:10+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:30047"},{"text":"//val worstWordIndex = argmin(logisticModel.coefficients.toArray.indices, { n:Int => logisticModel.coefficients.toArray(n)} )\nval worstWordIndex = idxmin(logisticModel.coefficients.toArray)\nval worstWord = countVectorizerModel.vocabulary(worstWordIndex)\nval worstWeight = logisticModel.coefficients(worstWordIndex)\nprintln(s\"Worst word: $worstWord value $worstWeight\")\n\n//val bestWordIndex = argmax(logisticModel.coefficients.toArray.indices, { n:Int => logisticModel.coefficients.toArray(n)} )\nval bestWordIndex = idxmax(logisticModel.coefficients.toArray)\nval bestWord = countVectorizerModel.vocabulary(bestWordIndex)\nval bestWeight = logisticModel.coefficients(bestWordIndex)\nprintln(s\"Best word: $bestWord value $bestWeight\")","dateUpdated":"2018-03-24T17:50:10+0000","config":{"colWidth":12,"editorMode":"ace/mode/scala","results":[{"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}}}],"enabled":true,"editorSetting":{"language":"scala","editOnDblClick":false}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"\nworstWordIndex: Int = 24973\n\nworstWord: String = 23oz\n\nworstWeight: Double = -162.02050102161516\nWorst word: 23oz value -162.02050102161516\n\nbestWordIndex: Int = 29244\n\nbestWord: String = i5\n\nbestWeight: Double = 147.51233497886673\nBest word: i5 value 147.51233497886673\n"}]},"apps":[],"jobName":"paragraph_1521913810486_-2130820481","id":"20170129-044442_1516043671","dateCreated":"2018-03-24T17:50:10+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:30048"},{"text":"%md\n# Making Predictions\n\nThe primary idea is of course to make predictions of the sentiment using the learned model.\n","dateUpdated":"2018-03-24T17:50:10+0000","config":{"editorSetting":{},"colWidth":12,"editorMode":"ace/mode/markdown","editorHide":true,"results":[{"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}}}],"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h1>Making Predictions</h1>\n<p>The primary idea is of course to make predictions of the sentiment using the learned model.</p>\n"}]},"apps":[],"jobName":"paragraph_1521913810487_-2131205229","id":"20170129-044654_1617813197","dateCreated":"2018-03-24T17:50:10+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:30051"},{"text":"val pred = logisticModel.transform(validationData)\n\nz.show(pred.drop(\"features\").limit(10))","dateUpdated":"2018-03-24T17:50:10+0000","config":{"colWidth":12,"editorMode":"ace/mode/scala","results":[{"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}}}],"enabled":true,"editorSetting":{"language":"scala","editOnDblClick":false}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"name\treview\tsentiment\tvwords\trawPrediction\tprobability\tprediction\n\t I ordered this because I wanted something easy and no installation   It arrived and I am about to stick them on when I realize there is no key in the package  I then see in tiny print on the box    key sold seperatley  Ridiculous and frustrating   Beware if you order to also buy your seperate key  \t0.0\tWrappedArray(, ordered, because, wanted, something, easy, no, installation, , , arrived, am, about, stick, them, when, realize, there, no, key, package, , see, tiny, print, box, , , , key, sold, seperatley, , ridiculous, frustrating, , , beware, if, you, order, also, buy, your, seperate, key)\t[8.834412821844213,-8.834412821844213]\t[0.9998543870444017,1.4561295559834073E-4]\t0.0\n\tA slight pain to install  drawers are easy  but cabinet doors  have to be perfectly aligned   but once installed they work great  Easy to keep locked  or unlocked  At least for my kid  once she saw she couldn t open it  she stopped trying  I never installed any screws  The tape was plenty for me  One note of caution    the tape is very sticky and does what it s suppose to  so when you are ready to remove it   it s not easy \t1.0\tWrappedArray(slight, pain, install, , drawers, easy, , but, cabinet, doors, , have, be, perfectly, aligned, , , but, once, installed, they, work, great, , easy, keep, locked, , unlocked, , at, least, my, kid, , once, she, saw, she, couldn, t, open, , she, stopped, trying, , never, installed, any, screws, , tape, plenty, me, , one, note, caution, , , , tape, very, sticky, does, what, s, suppose, , so, when, you, ready, remove, , , s, not, easy)\t[-12.003959052094809,12.003959052094809]\t[6.119897732158565E-6,0.9999938801022679]\t1.0\n\tBeen using for a number of months now and these have successfully stopped out two year old from getting into things in the kitchen and bathroom \t1.0\tWrappedArray(been, using, number, months, now, these, have, successfully, stopped, out, two, year, old, from, getting, into, things, kitchen, bathroom)\t[-1.1220987568527192,1.1220987568527192]\t[0.24562219325659423,0.7543778067434057]\t1.0\n\tInitially  I bought this 4 pack of locks  and the set that has the key and 2 locks  I installed them right away  never thinking to check each lock before I did  Out of my 6 locks  2 worked properly  2 would lock as long as I used to the key to lock them from the outside  and 2 didn t lock at all  no matter what I did  I returned the 4 that didn t work and ordered a new set of 4 because I really liked the way the working locks worked This time  my new set of 4 was fully functional  It was a pain to remove all the sticky residue from my cabinets so I could reinstall my new locks  but it was worth it  For almost 2 5 months  I had locked cabinets  They unlocked easily with the key  and when I closed the cabinet  the lock would reengage  I was a happy mommy Over the past two weeks  every single one of my locks has stopped working  No matter what I do  the lock will not engage  The moving part is floppy  and keeps falling into the unlocked position  I cannot even use the key to engage the lock from the outside I do not have a lot of double cabinets  so these locks were an ideal solution  Now I have no way of keeping my toddler out of my cabinets and I feel like I ve wasted money buying expensive locks \t0.0\tWrappedArray(initially, , bought, 4, pack, locks, , set, that, has, key, 2, locks, , installed, them, right, away, , never, thinking, check, each, lock, before, did, , out, my, 6, locks, , 2, worked, properly, , 2, would, lock, long, used, key, lock, them, from, outside, , 2, didn, t, lock, at, all, , no, matter, what, did, , returned, 4, that, didn, t, work, ordered, new, set, 4, because, really, liked, way, working, locks, worked, time, , my, new, set, 4, fully, functional, , pain, remove, all, sticky, residue, from, my, cabinets, so, could, reinstall, my, new, locks, , but, worth, , almost, 2, 5, months, , had, locked, cabinets, , they, unlocked, easily, with, key, , when, closed, cabinet, , lock, would, reengage, , happy, mommy, over, past, two, weeks, , every, single, one, my, locks, has, stopped, working, , no, matter, what, do, , lock, will, not, engage, , moving, part, floppy, , keeps, falling, into, unlocked, position, , cannot, even, use, key, engage, lock, from, outside, do, not, have, lot, double, cabinets, , so, these, locks, were, ideal, solution, , now, have, no, way, keeping, my, toddler, out, my, cabinets, feel, like, ve, wasted, money, buying, expensive, locks)\t[11.55234944259552,-11.55234944259552]\t[0.9999903866620692,9.613337930776277E-6]\t0.0\n\tIt took us some research to decide on this stroller  but we re very pleased with this purchase Pro  It has huge wheels that makes it very stable  sturdy   Perfect with the Companion infant seat   It s very nice looking and a lot cheaper than PegPrego  or Boogaboo  so you feel different when you go out  kind of like using AMEX black      I have other mothers talking to me or smiling to me in the mall  because they have the same strollers Con   It s very big  so if you have a small car  it may not fit   Even with our Volvo XC 70  it feels cramped in the trunk   Without taking the seat off  it s almost impossible for a petite girl like me to lift it and put it in the car   And when this thing is in the trunk  forget about going grocery shopping Overall this is a very good stroller and I would recommend to anyone who has a big cargo space \t1.0\tWrappedArray(took, us, some, research, decide, stroller, , but, we, re, very, pleased, with, purchase, pro, , has, huge, wheels, that, makes, very, stable, , sturdy, , , perfect, with, companion, infant, seat, , , s, very, nice, looking, lot, cheaper, than, pegprego, , boogaboo, , so, you, feel, different, when, you, go, out, , kind, like, using, amex, black, , , , , , have, other, mothers, talking, me, smiling, me, mall, , because, they, have, same, strollers, con, , , s, very, big, , so, if, you, have, small, car, , may, not, fit, , , even, with, our, volvo, xc, 70, , feels, cramped, trunk, , , without, taking, seat, off, , s, almost, impossible, petite, girl, like, me, lift, put, car, , , when, thing, trunk, , forget, about, going, grocery, shopping, overall, very, good, stroller, would, recommend, anyone, who, has, big, cargo, space)\t[-85.55060226260326,85.55060226260326]\t[7.0120582286715E-38,1.0]\t1.0\n\tSo far so good   It would be nice if they were less bulky and could be mounted on all doors drawers   They do come with screws and mounting tape   I use the tape to get the locks in place and then screw them in   There is no way that these would hold with just the mounting tape   It would be nice if there was an easy way to re mount these in new location should one change their mind   IMO  the prices is too high \t1.0\tWrappedArray(so, far, so, good, , , would, be, nice, if, they, were, less, bulky, could, be, mounted, all, doors, drawers, , , they, do, come, with, screws, mounting, tape, , , use, tape, get, locks, place, screw, them, , , there, no, way, that, these, would, hold, with, just, mounting, tape, , , would, be, nice, if, there, easy, way, re, mount, these, new, location, should, one, change, their, mind, , , imo, , prices, too, high)\t[-30.249765738316924,30.249765738316924]\t[7.289431530317072E-14,0.9999999999999272]\t1.0\n\tSoft snuggly practical item  Great service  Baby and parents both love this product  Safer than blankets for sleeping  This is the second one we have owned for our baby \t1.0\tWrappedArray(soft, snuggly, practical, item, , great, service, , baby, parents, both, love, product, , safer, than, blankets, sleeping, , second, one, we, have, owned, our, baby)\t[-25.275652417193978,25.275652417193978]\t[1.0542014972718493E-11,0.999999999989458]\t1.0\n\tThese are fabulous   We just moved into a new house and didn t want to screw into the brand new cabinets but these were just the solution we needed   Adhesive is really easy to apply and get on straight   My   Hulk   as we have nicknamed him is 18 months and can t get into the cabinets now   I would absolutely recommend these locks   They even have a feature that you can leave them installed but not set up for   lock   when your little one is old enough    and then they can be used to lock again if you should happen to have a next baby and need babyproofing again \t1.0\tWrappedArray(these, fabulous, , , we, just, moved, into, new, house, didn, t, want, screw, into, brand, new, cabinets, but, these, were, just, solution, we, needed, , , adhesive, really, easy, apply, get, straight, , , my, , , hulk, , , we, have, nicknamed, him, 18, months, can, t, get, into, cabinets, now, , , would, absolutely, recommend, these, locks, , , they, even, have, feature, that, you, can, leave, them, installed, but, not, set, up, , , lock, , , when, your, little, one, old, enough, , , , they, can, be, used, lock, again, if, you, should, happen, have, next, baby, need, babyproofing, again)\t[-41.4534812106843,41.4534812106843]\t[9.930745553971718E-19,1.0]\t1.0\n\tWe have had these locks now for almost 2 years and the adhesive is still going strong  Before we moved into our new house  2 years ago  we had the Tot Lock magnet locks and boy what a time my hubby had installing them and they left a huge hole in my cabinets  I knew when we moved to our new house I wanted the magnets again but  didn t want to deal with drilling holes my cabinets After doing some research I found these from kidco and what an awesome product    I am now buying more since our newest addition will be crawling soon and I want all my doors locked  The only time the adhesive was an issue was when I was having tile put in the kitchen and my contractor  with much force  ripped open the door  He didn t know I had the locks on he just thought the door was stuck  Even then he had to use quiet a bit of force to get the door open  I had no damage to my door and I just reapplied the adhesive and all has been fine  that was over a year ago  I am also not very handy and I installed these in my kitchen and in my bathroom much to my husband surprise   since he had such a hard time installing the other brand \t1.0\tWrappedArray(we, have, had, these, locks, now, almost, 2, years, adhesive, still, going, strong, , before, we, moved, into, our, new, house, , 2, years, ago, , we, had, tot, lock, magnet, locks, boy, what, time, my, hubby, had, installing, them, they, left, huge, hole, my, cabinets, , knew, when, we, moved, our, new, house, wanted, magnets, again, but, , didn, t, want, deal, with, drilling, holes, my, cabinets, after, doing, some, research, found, these, from, kidco, what, awesome, product, , , , am, now, buying, more, since, our, newest, addition, will, be, crawling, soon, want, all, my, doors, locked, , only, time, adhesive, issue, when, having, tile, put, kitchen, my, contractor, , with, much, force, , ripped, open, door, , he, didn, t, know, had, locks, he, just, thought, door, stuck, , even, he, had, use, quiet, bit, force, get, door, open, , had, no, damage, my, door, just, reapplied, adhesive, all, has, been, fine, , that, over, year, ago, , am, also, not, very, handy, installed, these, my, kitchen, my, bathroom, much, my, husband, surprise, , , since, he, had, such, hard, time, installing, other, brand)\t[-48.66049221662042,48.66049221662042]\t[7.362354814925871E-22,1.0]\t1.0\n\tWhat the previous reviewer didn t realize is that there are 2 different packaging options for this item  The first option is a pack that contains 1 key and 2 locks for people who want to try it out and the second option is to buy the pack that contains 4 locks but no key for those who already bought the starter kit and happened to like the product  So make sure you really read the description of what you re getting if you re buying online   This one happens do be the 4 locks with no key so you might want to try the starter kit first   I actually rec  it because UNFORTUNATELY the lock doesn t work with all situations because of draw designs  Then on top of that Kidco also sells the key seperately with no locks for those who have the product  love it  and happened to misplace or lose their key OR want to purchase an additional incase they ever lose the 1st key  I will admit that I think it s pretty lame for a company to try to squeeze every penny out of you especially when it probaby only costs 5 cents to make the darn key and especially when you re dealing with child safety products  As far as how well the product works   I LOVE IT and wish it had worked out better with all my draw situations  It s especially great for those cabinet doors that stand alone and don t have another door next to it where you can just buy one of those wrap around door knob locks that require 2 knobs to be side by side  I didn t have as great of luck with my kitchen draws because the draw panel is added on to the actual draw so it isn t flush with where you put the catch  I put 5 stars to bring the rating up because the last reviewer only gave one and it s actually a great product  I know it will outsmart my baby far beyond any cheaper options out there  I installed them with the adhesive tape that comes with it but I plan on reattaching it with the screws also included because I personally feel that the screws will do a better job AND because I love my child more than my freaking cabinet doors for all those worried about messing up your precious wood cabinets   I mean give me a break   the holes are so small anyway and it s totally concealed  only you will know it s there  ALSO  this locks so tight that little fingers hands can t reach inside small openings  which usually occures with the other types of locks  and pull stuff out  And also there s an option to turn the lock off for in between kids  DEFINITELY CONSIDER THIS PRODUCT     \t1.0\tWrappedArray(what, previous, reviewer, didn, t, realize, that, there, 2, different, packaging, options, item, , first, option, pack, that, contains, 1, key, 2, locks, people, who, want, try, out, second, option, buy, pack, that, contains, 4, locks, but, no, key, those, who, already, bought, starter, kit, happened, like, product, , so, make, sure, you, really, read, description, what, you, re, getting, if, you, re, buying, online, , , one, happens, do, be, 4, locks, with, no, key, so, you, might, want, try, starter, kit, first, , , actually, rec, , because, unfortunately, lock, doesn, t, work, with, all, situations, because, draw, designs, , top, that, kidco, also, sells, key, seperately, with, no, locks, those, who, have, product, , love, , happened, misplace, lose, their, key, want, purchase, additional, incase, they, ever, lose, 1st, key, , will, admit, that, think, s, pretty, lame, company, try, squeeze, every, penny, out, you, especially, when, probaby, only, costs, 5, cents, make, darn, key, especially, when, you, re, dealing, with, child, safety, products, , far, how, well, product, works, , , love, wish, had, worked, out, better, with, all, my, draw, situations, , s, especially, great, those, cabinet, doors, that, stand, alone, don, t, have, another, door, next, where, you, can, just, buy, one, those, wrap, around, door, knob, locks, that, require, 2, knobs, be, side, by, side, , didn, t, have, great, luck, with, my, kitchen, draws, because, draw, panel, added, actual, draw, so, isn, t, flush, with, where, you, put, catch, , put, 5, stars, bring, rating, up, because, last, reviewer, only, gave, one, s, actually, great, product, , know, will, outsmart, my, baby, far, beyond, any, cheaper, options, out, there, , installed, them, with, adhesive, tape, that, comes, with, but, plan, reattaching, with, screws, also, included, because, personally, feel, that, screws, will, do, better, job, because, love, my, child, more, than, my, freaking, cabinet, doors, all, those, worried, about, messing, up, your, precious, wood, cabinets, , , mean, give, me, break, , , holes, so, small, anyway, s, totally, concealed, , only, you, will, know, s, there, , also, , locks, so, tight, that, little, fingers, hands, can, t, reach, inside, small, openings, , which, usually, occures, with, other, types, locks, , pull, stuff, out, , also, there, s, option, turn, lock, off, between, kids, , definitely, consider, product)\t[-75.21765354474202,75.21765354474202]\t[2.15470651007699E-33,1.0]\t1.0\n"}]},"apps":[],"jobName":"paragraph_1521913810488_-2133128974","id":"20170129-044704_1120754047","dateCreated":"2018-03-24T17:50:10+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:30052"},{"text":"%md\n# Find the most Positive Review\n\nUsing the column rawPrediction, we can find the review which has the highest positive prediction.\n","dateUpdated":"2018-03-24T17:50:10+0000","config":{"editorSetting":{},"colWidth":12,"editorMode":"ace/mode/markdown","editorHide":true,"results":[{"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}}}],"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h1>Find the most Positive Review</h1>\n<p>Using the column rawPrediction, we can find the review which has the highest positive prediction.</p>\n"}]},"apps":[],"jobName":"paragraph_1521913810489_-2133513723","id":"20170129-044715_63959255","dateCreated":"2018-03-24T17:50:10+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:30053"},{"text":"import org.apache.spark.ml.linalg.Vector\n// Extract one component from a Vectors\nval extractFromVector = udf{ (v:Vector, i:Integer) => v(i) }\n\nval positives = pred.orderBy(extractFromVector(pred(\"rawPrediction\"),lit(1)).desc)\n\nz.show()\n    positives.select(col(\"name\"),col(\"review\"),col(\"sentiment\"),col(\"rawPrediction\"),col(\"prediction\")).limit(6)\n)    ","dateUpdated":"2018-03-24T17:50:10+0000","config":{"colWidth":12,"editorMode":"ace/mode/scala","results":[{"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[{"name":"name","index":0,"aggr":"sum"}],"values":[{"name":"review","index":1,"aggr":"sum"}],"groups":[],"scatter":{"xAxis":{"name":"name","index":0,"aggr":"sum"},"yAxis":{"name":"review","index":1,"aggr":"sum"}}}}],"enabled":true,"editorSetting":{"language":"scala","editOnDblClick":false}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"name\treview\tsentiment\trawPrediction\tprediction\nBritax B-Ready Stroller, Black\t\"Some differences with Uppababy Vs. Britax B-Ready:WHEELS - Vista wins. Vista had better wheels. Vista had tread and were more grippery tire like feel.  B-Ready had smooth plastic feel to them. I can see that they would get all scratched up easily. B-Ready also had fenders on them which seem to add to bulk. Comparing closely it almost appear one could put Vista's wheels to B-Ready.  It's that similar!HANDLE - B-Ready wins. Handle on B-Ready was nicer than Vista. It pivoted instead of telescoping (which was what the Vista does). The center was had a grip that was molded for one-handed steering. The arms and wrist seem more comfortable (rested more parallel like on a keyboard). My wife at 5'2 found the Vista handle too high and wished it could adjust lower.FOLDING - Vista wins (barely). Comparing the two, the wife like the Vista (it did take several attempts for wife to get the feel for it, as did I ! Once figured out it was ok).B-Ready  required two hands as well but you sort of have to use your stomach so that you could pull the levers toward you and have  it collapse. I found it easy if you have larger hands you can pull down the levers easier but since my wife is 5'2, her hands are smaller and sort of used her stomach a bit.  With time, I think she could avoid using her stomach.  She would just hold the bar and use her fingers to pull down.  We also found that you had to straighten out the B-Ready's handle so that when you fold it, it would stand properly stand up and you could lock the folding clasp. DEFINITELY TRY FOLDING IT YOURSELF IN THE STORE! (just to add an another stroller, the Baby Jogger City Select has really easy folding capability!). Both stands up when folded although you have to consciously stand it up.  The sales person always seems to fold it and let it flop to the ground.  I doubt one  would do that outside.Note on second seat folding - The folding of the B-Ready allows the second seat to be on but it was very bulky (and heavy at a total of 35 lbs) and the canopy of the second seat would get dirty.  It's better to just remove the seat.MAIN SEAT - Vista wins. Vista has 0 degree seat position and B-Ready did not. Vista 2010 added this to address a common complaint.  B-Ready is slightly on the decline.  So while the  B-Ready has a handle that is more ergonomically correct for mom's wrist, it seems the seat upright capability is better for the kid. (previous Vista 2009 owners found the kid pulling themselves forward to get upright).SECOND SEAT (REAR) - B-Ready wins . Recline of 2nd child add on - B ready  was clearly better since it can recline to horizontal sleeping position. Vista had one position.  It was not upright but slightly tilted back.  More for a child chilling out and may nit be the best if kid is sleeping. The Vista seat was also closer to the front seat and B- Ready has more room for child in rear. A taller person may hit the B-Ready seat with their stride but I'm 5'10 and its not a problem.  Also, note that the B-Ready second seat is in the rear of parent behind main seat  FORWARD FACING whereas, Vista is in FRONT of main seat REAR FACING.  Big difference here!  I believe that's why the B-Ready can recline safely.  I don't think I would want to have a Vista recline in front and therefore exposing the child's head.STORAGE - B-Ready wins (barely).  B-Ready is accessible on all sides.  Vista's is on the rear only.  With the rear seat, this is important.  However, the Vista has a bar running across where the kid can sort of step their feet on.  The B-Ready has their feet in the entire basket and the kids would probably kick at your diaper bag.CONFIGURATIONS - B-Ready wins.  B-Ready has 14 configurations vs. Vista's 3 configurations.  Most notably are: B-Ready has ability to use two infant carriers at the same time.  You can also place infant carrier in the rear (Vista you cannot.  You can only put it in the front).  B-Ready can use the bassinet with the second seat.  Vista cannot use bassinet with rear seat.After all this, I am still having problems deciding.  For me, it comes down to Vista's 0 degree position but no full recline in rear seat Vs. B-Ready's full recline rear seat but lack of 0 degree position.Edit:Update - I ended up buying the Britax B-ready.  It's been used it for 6 weeks now.  So far, its been great!  Very nice, easy ride.  It can be bumpy on cobble stones and uneven surfaces.  If you want a smoother ride on these surfaces, you'll need bigger, air-filled tires.  My complaint is the unfolding part.  When unfolding, the plastic clip that holds the stroller , is tricky to \"\"undo\"\" so you can unfold it.  You need to pull it out a bit before you unfold which can be tough.  I think we'll need more practice at doing this.  I'll report back in a few more months.\"\t1.0\t[-263.7286210856005,263.7286210856005]\t1.0\nBABYBJORN Travel Crib Light , Blue\tBOTTOM LINE: I would buy this again in a heart-beat and I would buy it over any other travel crib or pack n' play. I have been so impressed with this crib. 100% worth every penny!! It has been used every night for seven months and shows no signs of wear!My husband and I bought this crib as our only crib for our first baby. We were nervous because it was such a large purchase for us. (This is the most expensive thing we have purchased besides our car.) After extensive research we decided on the babybjorn because my husband is in graduate school and we will be doing a lot of moving in the next few years. She has slept in it since she was three days old and she is now seven months and the crib looks and functions as if it was new!Our BabyBjorn has been in six states and five countries. We have checked it at airports all over Europe and the US. We have checked it in its carrying case alone and it has not been damaged in anyway. It has been on trains, buses, metros, trams, in taxis, cars, and planes! Even the bag has yet to show signs of wearing.The crib unzips from the metal bars so it can be washed as well. This is really nice if you travel a lot. We moved into our apartment in Italy and found out that there were bed bugs in it! We were worried we would have to replace our loved crib but it can be washed and the matress is cased in plastic so it is safe. (The plastic liner can unzip and both the matress and the plastic can be washed.) If you are planning on doing any extensive traveling you will run into bed bugs and this crib is a must.The sheets and matress pad made by babybjorn are expensive however I found them for half the price at sheetworld.com. And we were able to get hot pink cotton ones and hot pink flannel ones.The crib is so easy to put together. I personally hate setting things up but it is one motion - just lifting it out of the case! It also comes ready-to-go so no need to put together. It even is easy to put back into its case. Amazingly, seven months plus six countries later it still opens up perfectly everytime.I love that I can see into it so easily through the mesh. Being a first time mom I was super nervous when she slept but I could see her without lifting my head off the pillow. Also, our little one moves a lot while she sleeps and sometimes ends up pressed against the side. Luckily the babybjorn is light fabric so she can breath while her face is planted into the side. Another great thing is that all the bars are outside of the crib so there is nothing hard for her little head to hit.Durning the night she sleeps in it and during the day she plays in it. Unlike pack n' plays the bottom will not sag because the matress is supported by the floor.Also, it is small enough to fit in tight hotel rooms and even on some trains but large enough to provide comfort and space for even the most wiggley babies! The carrying case is also slim enough for us to pack it on the floor of our Saturn in front of her car seat. It even was smashed in our trunk from Washington DC to Idaho and worked just fine when we pulled it out.Two things about it to keep in mind. The crib sits on the floor so it is cooler at the lower elevation than a traditonal crib. Also, I had a c-section and it was difficult for the first week to bend over and lift her out of it. However the crib has been built well enough that I do lean on it to grab her and it has not had any issues.It is hands down the best purchase we made. Although it is a bit pricey it is worth every penny. I would pay twice what it cost for it. I have told friends to buy it. I will buy another all over again.\t1.0\t[-257.7744231071574,257.7744231071574]\t1.0\nButtons Cloth Diaper Cover - One Size - 8 Color Options\tWe are big Best Bottoms fans here, but I wanted to try these as a cheaper option to designate for daycare use. They are well made, super soft in feel, with gentle waist elastics, and snug leg elastics. The leg elastics initially caused red marks on my super chubby thighed baby, but since he's trimmed down with crawling, that's no longer an issue and I now appreciate the snugger fit.Compared to Best Bottoms, I prefer these for the soft stretchy feel, but still get a better fit with our Best Bottoms (so I tend to reach for the Best Bottoms more often). Best Bottoms give a better fit because they have one additional rise setting (4 instead of just 3 rise options). Fewer rise options on the Buttons inevitably leads to more awkward in-between size stages where one is too snug and the other looks (or really is) huge. Our Best Bottoms always look nice and trim. Buttons do, too, but only when the fit is right, and that is less frequently with the Buttons. We've gotten around the in-between stage by unsnapping the outer two snaps in the rise completely on the Buttons covers to allow more room in the legs, but leaving the middle rise snap snapped down to pull up all the excess material. It still looks a bit sloppy, but it works, and looks / fits better than being 100% on the largest rise.The inserts: We have small, medium, large best bottom inserts in hemp/cotton as well as stay dry. All are compatible with Buttons, although they can be a bit stubborn snapping in, but they do snap in. The larges are a hair big for the Buttons covers in my opinion, but you can make them fit on the largest rise if you need to. I definitely prefer to use the medium Best Bottom inserts or the Buttons large inserts on the middle and large rise with Buttons.The large Buttons inserts we got to try are super soft, seem just as absorbent as our Best Bottoms but more flexible and bunch a bit more, though it's not caused any problems for us. They are in-between the medium and large Best Bottom stay dry sizes. Just as wide at the ends. As wide in the middle as the Best Bottom larges. Wider than the Best Bottom mediums. Just thought I'd share if anyone was wondering how they compare.I'd definitely recommend the Buttons covers and inserts to anyone looking to try an AI2 system at an affordable price-point. Although I still prefer our Best Bottoms, for the price, I'll definitely be adding more Buttons to our stash, especially now that they've added some cool new colors and prints :-)\t1.0\t[-251.2402412961459,251.2402412961459]\t1.0\nBaby K'tan Baby Carrier, Black, X-Large\tCheck and recheck the K'Tan for size issues before letting your guard down and wearing..... NO ISSUES OCCURED, however, I thought I was good to go, and then realized that this large was different than the large I had been given before it.... Odd, but, fabric.... This makes the moby wrap appear like a midevil torture devise (and bonus! you wont have to worry about some Baby-Wearing freak watching you in the parking lot at the mall as you struggle to turn a bolt of fabric into what the KTan has simplified...seriously! Dad approved!!!!! (and if the moby is your thing, that's cool, just, perhaps, realize that its not as easy as everyone thinks to wrap that amount of fabric around yourself evenly, snug, comfortable and without mummifying yourself and lord help you, your baby!  Another bonus to the KTAN, issue with baby, takes only a second to move her out of the KTAN, but in a moby.... We thought for the first two days after returning the moby &#34;have you seen Katy?&#34;love it, love it, love it, love it, love it, love it love it, love it, love it love it, love it, love it love it, love it, love it love it, love it, love it love it, love it, love it love it, love it, love it love it, love it, love it love it, love it, love it love it, love it, love it love it, love it, love it love it, love it, love it\t1.0\t[-239.8823813151965,239.8823813151965]\t1.0\nMaxi Cosi Prezi Infant Car Seat, Courageous Green\tAfter reading the reviews of several others that have tried the Maxi Cosi Prezi, I was a little concerned. Several people reported that this car seat was so snug that, in some cases, it actually harmed their baby. In one instance, an individual claimed that the seat was so restrictive that it would not even fit their newborn. Having used the carrier myself, I now believe that the product has been altered since those reviews were written, those reviewers did not read the user&#8217;s manual, and/or those folks were just out to write a negative review for what is actually an amazing product. It is true that the Maxi Cosi Prezi is cozy; but cozy in a warm hug way, not in a reticulated python way.We received this seat late in the game. My child was already 18 pounds 6 ounces and 27 and-a-half inches long. Not a huge baby, but much larger than the newborn that others claimed having trouble squeezing into the seat. He fit like a glove, and loved it. Yes, I did have to adjust the straps and take out the included newborn wedge, which required almost no effort compared to some carriers. This adjustment, however, would be required of any baby carrier unless it just happened to be adjusted to the size of one&#8217;s child right out of the box.Our other carrier is the Britax Chaperone, and is my point of comparison. After making the mistake of originally purchasing a much cheaper carrier prior to my child&#8217;s birth, I can confidently say that both the Britax and the Maxi Cosi are of superior material and build quality than carriers on the lower end of the cost scale. I only mention this because I am admittedly and, if you ask my wife, painfully cheap. Nonetheless, there is a discernable difference in quality for the price in this case. When one&#8217;s child is involved, in my opinion, it is worth the extra expense.One feature present on the Maxi Cosi that originally prompted me to purchase the Britax, is a rear impact bar (I think Maxi Cosi refers to it as an anti-rebound bar) on the car seat base. While it blows my mind that this feature is not required on all infant car seats, it is only seen on a couple of models. The purpose of this bar is that of preventing the rear-facing car seat from smashing the contained baby&#8217;s head and face against the seat of the car it is attached to in a rear impact, or recoil from front impact, situation. For first time parents, I recommend that you try some car seats without this feature in your own car (without a baby in it, of course) and see for yourself how easily the base and seat fold up against the seat they are attached to if the weight is shifted as it would be in a rear impact scenario. Then try the seats with the bar. Again, ridiculous that this feature is not a requirement. Big points for both this seat and the Chaperone.The primary difference, in my book, between my two favorite car seats &#8211; this seat and the Chaperone &#8211; is that the Maxi Cosi is substantially lighter than the Chaperone. The Chaperone&#8217;s big claim being safety, I just cannot say for sure whether any safety is sacrificed for the sake of weight. Other differences include the multiple travel systems offered by Britax for Britax carriers, whereas it seems that Maxi Cosi is following more of a universal adapter approach. It might seem insignificant but the Prezi also has this piece of elastic fabric that stretches across the infant occupant&#8217;s feet that seems to produce a calming effect. Very nice. The same type of fabric serves as the European style canopy. My wife prefers this canopy, I do not.All in all, I believe the Maxi Cosi Prezi is a legitimate top tier product that easily competes with the trusted standards in the industry. As far as comfort is concerned, I have not personally seen a carrier that my own child has looked more comfortable in. In my opinion, any claims that the Maxi Cosi Prezi is too cozy are simply false within the context of the recommended weight and height restrictions.\t1.0\t[-233.6875590945047,233.6875590945047]\t1.0\nPura Stainless Kiki Sippy Bottle Stainless Steel, 11 Ounce, Natural\tWe have four of these bottles for our twins - one plain stainless, as well as green, pink and aqua bottles.  We love them: they are eco-friendly, sturdy, attractive and durable, and the colours allow our twins to distinguish which bottle is theirs.However, my kids don't like the Pura sippy spouts.  Instead we started out using Mam wide mouth nipples, then transitioned to Avent sippy spouts.  I would really like it if there were a silicone straw top option for these sippy cups -Zo-li Bot Straw Sippy Cupsare the best straw option I have found, but those cups are plastic.Addressing some criticisms in other reviews (here and in reviews for other finishes):1) Liquid measurements - The interior of the bottle is marked in ounces and mL.  It is hard to see the markings when the bottle is empty, but as soon as you start filling it with milk any overhead light reflects off the surface of the milk and makes it much easier to see the markings.  I've found that with time I got very good at estimating amounts just by glancing into the bottle.  If you really need to track every half ounce that your child consumes, stainless bottles are not going to be the best option.2) Heat transfer / durability - We useSiliskinsto cover our bottles, protect our children's hands from heat and cold, and protect the bottles from dings when they are inevitably dropped.  At the time I got my bottles the Pura skins weren't available through Amazon.  Our bottles have endured numerous drops from toddler height and from a 42 inch high counter and they are as good as new.3) Paint flaking - This has been noted as an issue by some reviewers who used the coloured bottles.  Well, we did an A/B test... my son has nails like Wolverine and sure enough he scratched his bottles; my daughter is far more gentle and has never scratched her bottles.  Choose a stainless or coloured bottle according to your own child's tendencies...  The Siliskins also help to protect the paint since they prevent scratching.4) Silicone caps - at first these seemed weird but I grew to like them.  They do fit securely but aren't as secure as screw-on lids would be: I wouldn't recommend inverting the bottles and hoping that they don't leak.  The upside to not being rigid is that they squish easily into a pocket or corner of the diaper bag when you've taken them off the bottle, and with twins every square inch of space counts.This is a great product.  If I were adding to my wishlist of features and accessories I can only say it would also be nice to have a wider range of colours (Pura has added Grape to their line-up since we bought our bottles; yellow, red and orange would be great additions).  In addition to the straw top, as another reviewer mentioned, an adult sport spout would also be a great thing to have.  Pura could also offer screw-on stainless caps for people who hate the silicone caps.  Finally, since the colours are so attractive it seems a shame to cover them with coloured silicone covers - clear covers would allow the bottles to show through more attractively.\t1.0\t[-233.08469758394472,233.08469758394472]\t1.0\n"}]},"apps":[],"jobName":"paragraph_1521913810489_-2133513723","id":"20170129-044725_1084497064","dateCreated":"2018-03-24T17:50:10+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:30054"},{"text":"%md\n# Evaluation of Prediction\n\nAgain we want to assess the performance of the prediction model. This can be done using the builtin class BinaryClassificationEvaluator.\n","dateUpdated":"2018-03-24T17:50:10+0000","config":{"editorSetting":{},"colWidth":12,"editorMode":"ace/mode/markdown","editorHide":true,"results":[{"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}}}],"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h1>Evaluation of Prediction</h1>\n<p>Again we want to assess the performance of the prediction model. This can be done using the builtin class BinaryClassificationEvaluator.</p>\n"}]},"apps":[],"jobName":"paragraph_1521913810490_-2132359476","id":"20170129-044740_1008352335","dateCreated":"2018-03-24T17:50:10+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:30055"},{"text":"import org.apache.spark.ml.evaluation.BinaryClassificationEvaluator\n\nval evaluator = new BinaryClassificationEvaluator()\n    .setLabelCol(\"sentiment\")\nprintln(evaluator.evaluate(pred))\n","dateUpdated":"2018-03-24T17:50:10+0000","config":{"colWidth":12,"editorMode":"ace/mode/scala","results":[{"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}}}],"enabled":true,"editorSetting":{"language":"scala","editOnDblClick":false}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"\nimport org.apache.spark.ml.evaluation.BinaryClassificationEvaluator\n\nevaluator: org.apache.spark.ml.evaluation.BinaryClassificationEvaluator = binEval_740d3f9f704e\n0.8786996127558191\n"}]},"apps":[],"jobName":"paragraph_1521913810491_-2132744225","id":"20170129-044751_2122449463","dateCreated":"2018-03-24T17:50:10+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:30056"},{"text":"%md\n# Custom Evaluator\n\nWe want to use a different metric namely accuracy. Accuracy is defined as\n\nnumber_correct_predictions / total_number_predictions\n\nFirst let us directly calculate that metric\n","dateUpdated":"2018-03-24T17:50:10+0000","config":{"editorSetting":{},"colWidth":12,"editorMode":"ace/mode/markdown","editorHide":true,"results":[{"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}}}],"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h1>Custom Evaluator</h1>\n<p>We want to use a different metric namely accuracy. Accuracy is defined as</p>\n<p>number_correct_predictions / total_number_predictions</p>\n<p>First let us directly calculate that metric</p>\n"}]},"apps":[],"jobName":"paragraph_1521913810491_-2132744225","id":"20170129-044803_1942847520","dateCreated":"2018-03-24T17:50:10+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:30057"},{"text":"val numTotal = pred.count()\nval numCorrect = pred.filter(pred(\"sentiment\") === pred(\"prediction\")).count()\n\nval modelAccuracy = numCorrect.toFloat / numTotal.toFloat\n\nprintln(s\"Model Accuracy: $modelAccuracy\")","dateUpdated":"2018-03-24T17:50:10+0000","config":{"colWidth":12,"editorMode":"ace/mode/scala","results":[{"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}}}],"enabled":true,"editorSetting":{"language":"scala","editOnDblClick":false}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"\nnumTotal: Long = 31823\n\nnumCorrect: Long = 28282\n\nmodelAccuracy: Float = 0.88872826\nModel Accuracy: 0.88872826\n"}]},"apps":[],"jobName":"paragraph_1521913810492_-2134667970","id":"20170129-044811_586986077","dateCreated":"2018-03-24T17:50:10+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:30058"},{"text":"%md\n## Compare with Dummy Predictor\n\nIt is always interesting to see how a trivial prediction performs. The trivial predictor simply predicts the most common class for all objects. In this case this would be a positive review.\n","dateUpdated":"2018-03-24T17:50:10+0000","config":{"editorSetting":{},"colWidth":12,"editorMode":"ace/mode/markdown","editorHide":true,"results":[{"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}}}],"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h2>Compare with Dummy Predictor</h2>\n<p>It is always interesting to see how a trivial prediction performs. The trivial predictor simply predicts the most common class for all objects. In this case this would be a positive review.</p>\n"}]},"apps":[],"jobName":"paragraph_1521913810492_-2134667970","id":"20170129-044827_1506840292","dateCreated":"2018-03-24T17:50:10+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:30059"},{"text":"val numTotal = pred.count()\nval numPositive = pred.filter(pred(\"sentiment\") === lit(1.0)).count()\n\nval baselineAccuracy = numPositive.toFloat / numTotal\n\nprintln(s\"Baseline Accuracy: $baselineAccuracy\")","dateUpdated":"2018-03-24T17:50:10+0000","config":{"colWidth":12,"editorMode":"ace/mode/scala","results":[{"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}}}],"enabled":true,"editorSetting":{"language":"scala","editOnDblClick":false}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"\nnumTotal: Long = 31823\n\nnumPositive: Long = 26858\n\nbaselineAccuracy: Float = 0.8439808\nBaseline Accuracy: 0.8439808\n"}]},"apps":[],"jobName":"paragraph_1521913810493_-2135052718","id":"20170129-044840_1725986384","dateCreated":"2018-03-24T17:50:10+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:30060"},{"text":"","dateUpdated":"2018-03-24T17:50:10+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false},"colWidth":12,"editorMode":"ace/mode/scala","results":{},"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1521913810493_-2135052718","id":"20170129-080247_746419066","dateCreated":"2018-03-24T17:50:10+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:30061"}],"name":"Classification - Sentiment Analysis Full","id":"2DABS7AEC","angularObjects":{"2D98FMAH1:shared_process":[],"2D7JMBHMW:shared_process":[],"2D97KQQMQ:shared_process":[],"2D75J9G8A:shared_process":[],"2D7EN88U2:shared_process":[],"2D9JW72F7:shared_process":[],"2D833H41P:shared_process":[],"2D9GNB6ZN:shared_process":[],"2D6C3QSGG:shared_process":[]},"config":{"looknfeel":"default","personalizedMode":"false"},"info":{}}