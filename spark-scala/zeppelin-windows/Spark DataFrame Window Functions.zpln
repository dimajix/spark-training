{"paragraphs":[{"text":"%md\n# Window Functions\nSpark also offers window functions, which are used for some specific use cases. The basic idea is that for every record, a window is created containing surrounding records. Inside this window (which is created differently for every record) an aggregation function or a special analytical function is executed on the window. The result of this aggregation then is attached to the original record as a new column.\n\nWe will play a little bit with window functions using the weather data set, which naturally provides some time series data. This allows us to calculate sliding window averages of temperatures.","user":"anonymous","dateUpdated":"2018-03-24T17:37:44+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h1>Window Functions</h1>\n<p>Spark also offers window functions, which are used for some specific use cases. The basic idea is that for every record, a window is created containing surrounding records. Inside this window (which is created differently for every record) an aggregation function or a special analytical function is executed on the window. The result of this aggregation then is attached to the original record as a new column.</p>\n<p>We will play a little bit with window functions using the weather data set, which naturally provides some time series data. This allows us to calculate sliding window averages of temperatures.</p>\n</div>"}]},"apps":[],"jobName":"paragraph_1521912895228_997699829","id":"20180324-173455_1911772873","dateCreated":"2018-03-24T17:34:55+0000","dateStarted":"2018-03-24T17:37:44+0000","dateFinished":"2018-03-24T17:37:44+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:16848"},{"text":"// Common data location - adjust if not correct\nval storageLocation = \"s3://dimajix-training/data/weather\"","dateUpdated":"2018-03-24T17:32:31+0000","config":{"colWidth":12,"editorMode":"ace/mode/scala","results":{},"enabled":true,"editorSetting":{"language":"scala","editOnDblClick":false}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"storageLocation: String = s3://dimajix-training/data/weather\n"}]},"apps":[],"jobName":"paragraph_1521912751082_-122905151","id":"20180320-164041_2103108319","dateCreated":"2018-03-24T17:32:31+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:16849"},{"text":"import org.apache.spark.sql.types._\n\nval rawWeatherData = spark.read.text(s\"${storageLocation}/2003\")\nval weatherData = rawWeatherData.select(\n    substring(col(\"value\"),5,6) as \"usaf\",\n    substring(col(\"value\"),11,5) as \"wban\",\n    to_timestamp(substring(col(\"value\"),16,12),\"yyyyMMddHHmm\") as \"timestamp\",\n    to_timestamp(substring(col(\"value\"),16,12),\"yyyyMMddHHmm\").cast(\"long\") as \"ts\",\n    substring(col(\"value\"),42,5) as \"report_type\",\n    substring(col(\"value\"),61,3) as \"wind_direction\",\n    substring(col(\"value\"),64,1) as \"wind_direction_qual\",\n    substring(col(\"value\"),65,1) as \"wind_observation\",\n    substring(col(\"value\"),66,4).cast(FloatType) / lit(10.0) as \"wind_speed\",\n    substring(col(\"value\"),70,1) as \"wind_speed_qual\",\n    substring(col(\"value\"),88,5).cast(FloatType) / lit(10.0) as \"air_temperature\",\n    substring(col(\"value\"),93,1) as \"air_temperature_qual\"\n)\n\nz.show(weatherData.limit(10))","dateUpdated":"2018-03-24T17:32:31+0000","config":{"colWidth":12,"editorMode":"ace/mode/scala","results":{},"enabled":true,"editorSetting":{"language":"scala","editOnDblClick":false}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"import org.apache.spark.sql.types._\nweatherData: org.apache.spark.sql.DataFrame = [usaf: string, wban: string ... 10 more fields]\n"},{"type":"TABLE","data":"usaf\twban\ttimestamp\tts\treport_type\twind_direction\twind_direction_qual\twind_observation\twind_speed\twind_speed_qual\tair_temperature\tair_temperature_qual\n703160\t25624\t2003-01-01 00:00:00.0\t1041379200\tSY-MT\t010\t5\tN\t5.2\t5\t-0.6\t5\n703160\t25624\t2003-01-01 00:17:00.0\t1041380220\tFM-16\t020\t1\tN\t4.6\t1\t-2.0\t1\n703160\t25624\t2003-01-01 00:53:00.0\t1041382380\tFM-15\t010\t5\tN\t5.2\t5\t-2.8\t5\n703160\t25624\t2003-01-01 01:00:00.0\t1041382800\tNSRDB\t999\t9\t9\t999.9\t9\t999.9\t9\n703160\t25624\t2003-01-01 01:53:00.0\t1041385980\tFM-15\t010\t5\tN\t6.2\t5\t-2.2\t5\n703160\t25624\t2003-01-01 02:00:00.0\t1041386400\tNSRDB\t999\t9\t9\t999.9\t9\t999.9\t9\n703160\t25624\t2003-01-01 02:53:00.0\t1041389580\tFM-15\t010\t5\tN\t7.2\t5\t-3.3\t5\n703160\t25624\t2003-01-01 03:00:00.0\t1041390000\tNSRDB\t999\t9\t9\t999.9\t9\t999.9\t9\n703160\t25624\t2003-01-01 03:53:00.0\t1041393180\tFM-15\t020\t5\tN\t6.2\t5\t-1.1\t5\n703160\t25624\t2003-01-01 04:00:00.0\t1041393600\tNSRDB\t999\t9\t9\t999.9\t9\t999.9\t9\n"}]},"apps":[],"jobName":"paragraph_1521912751083_-123289900","id":"20180320-164117_1907831333","dateCreated":"2018-03-24T17:32:31+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:16850"},{"text":"val weather_single = weatherData.where(\"usaf='954920' and wban='99999'\").cache()\nweather_single.createOrReplaceTempView(\"weather_single\")","dateUpdated":"2018-03-24T17:32:31+0000","config":{"colWidth":12,"editorMode":"ace/mode/scala","results":{},"enabled":true,"editorSetting":{"language":"scala","editOnDblClick":false}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"weather_single: org.apache.spark.sql.Dataset[org.apache.spark.sql.Row] = [usaf: string, wban: string ... 10 more fields]\n"}]},"apps":[],"jobName":"paragraph_1521912751084_-125213644","id":"20180320-164551_716559663","dateCreated":"2018-03-24T17:32:31+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:16851"},{"text":"%sql\nSELECT * FROM weather_single LIMIT 10","dateUpdated":"2018-03-24T17:32:31+0000","config":{"colWidth":12,"editorMode":"ace/mode/sql","results":{},"enabled":true,"editorSetting":{"language":"sql","editOnDblClick":false}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"usaf\twban\ttimestamp\tts\treport_type\twind_direction\twind_direction_qual\twind_observation\twind_speed\twind_speed_qual\tair_temperature\tair_temperature_qual\n954920\t99999\t2003-01-01 00:00:00.0\t1041379200\tFM-12\t200\t1\tN\t4.6\t1\t25.6\t1\n954920\t99999\t2003-01-01 02:00:00.0\t1041386400\tFM-12\t230\t1\tN\t5.7\t1\t27.8\t1\n954920\t99999\t2003-01-01 03:00:00.0\t1041390000\tFM-12\t220\t1\tN\t7.7\t1\t29.6\t1\n954920\t99999\t2003-01-01 05:00:00.0\t1041397200\tFM-12\t230\t1\tN\t6.2\t1\t29.7\t1\n954920\t99999\t2003-01-01 06:00:00.0\t1041400800\tFM-12\t240\t1\tN\t6.7\t1\t30.2\t1\n954920\t99999\t2003-01-01 08:00:00.0\t1041408000\tFM-12\t210\t1\tN\t6.7\t1\t29.1\t1\n954920\t99999\t2003-01-01 09:00:00.0\t1041411600\tFM-12\t220\t1\tN\t5.7\t1\t28.0\t1\n954920\t99999\t2003-01-01 11:00:00.0\t1041418800\tFM-12\t210\t1\tN\t3.6\t1\t25.9\t1\n954920\t99999\t2003-01-01 12:00:00.0\t1041422400\tFM-12\t200\t1\tN\t4.1\t1\t25.0\t1\n954920\t99999\t2003-01-01 14:00:00.0\t1041429600\tFM-12\t190\t1\tN\t6.2\t1\t23.0\t1\n"}]},"apps":[],"jobName":"paragraph_1521912751085_-125598393","id":"20180320-165048_1983761351","dateCreated":"2018-03-24T17:32:31+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:16852"},{"text":"%md\n## Sliding Window\nLet us create a sliding window that looks back 10 hours (36000 seconds) and ahead 10 hours and calculates the average temperature. In contrast to a `group by` operation, the average is calculated for every record, therefore the result has the same number of rows than the incoming data set. \n\nThe basic syntax of a sliding window in SQL is as follows:\n\n    AGG(value) OVER (ORDER BY ordering_column RANGE BETWEEN n PRECEEDING AND m FOLLOWING)\n\nor\n\n    AGG(value) OVER (ORDER BY ordering_column ROWS BETWEEN n PRECEEDING AND m FOLLOWING)\n\nIf you want to create the window by comparing the value of a specific column (in this case the time), then you use `RANGE`. If you simply want to create windows of a constant number of rows, you use `ROWS`.\n\nIn this simple case, the sliding window is defined over all weather stations, since we only have a single one.","user":"anonymous","dateUpdated":"2018-03-24T17:40:38+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h2>Sliding Window</h2>\n<p>Let us create a sliding window that looks back 10 hours (36000 seconds) and ahead 10 hours and calculates the average temperature. In contrast to a <code>group by</code> operation, the average is calculated for every record, therefore the result has the same number of rows than the incoming data set. </p>\n<p>The basic syntax of a sliding window in SQL is as follows:</p>\n<pre><code>AGG(value) OVER (ORDER BY ordering_column RANGE BETWEEN n PRECEEDING AND m FOLLOWING)\n</code></pre>\n<p>or</p>\n<pre><code>AGG(value) OVER (ORDER BY ordering_column ROWS BETWEEN n PRECEEDING AND m FOLLOWING)\n</code></pre>\n<p>If you want to create the window by comparing the value of a specific column (in this case the time), then you use <code>RANGE</code>. If you simply want to create windows of a constant number of rows, you use <code>ROWS</code>.</p>\n<p>In this simple case, the sliding window is defined over all weather stations, since we only have a single one.</p>\n</div>"}]},"apps":[],"jobName":"paragraph_1521912804474_-1726661160","id":"20180324-173324_642243569","dateCreated":"2018-03-24T17:33:24+0000","dateStarted":"2018-03-24T17:40:38+0000","dateFinished":"2018-03-24T17:40:38+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:16853"},{"text":"%sql\nSELECT\n    *,\n    CASE WHEN air_temperature_qual = 1 THEN air_temperature END AS temp,\n    avg(CASE WHEN air_temperature_qual = 1 THEN air_temperature END) OVER (ORDER BY ts DESC RANGE BETWEEN 36000 PRECEDING AND 36000 FOLLOWING) AS avg_temp\nFROM\n    weather_single\nORDER BY ts    \nLIMIT 300    ","dateUpdated":"2018-03-24T17:32:31+0000","config":{"colWidth":12,"editorMode":"ace/mode/sql","results":{"0":{"graph":{"mode":"lineChart","height":300,"optionOpen":false,"setting":{"lineChart":{}},"commonSetting":{},"keys":[{"name":"timestamp","index":2,"aggr":"sum"}],"groups":[],"values":[{"name":"temp","index":12,"aggr":"sum"},{"name":"avg_temp","index":13,"aggr":"sum"}]},"helium":{}}},"enabled":true,"editorSetting":{"language":"sql","editOnDblClick":false}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"usaf\twban\ttimestamp\tts\treport_type\twind_direction\twind_direction_qual\twind_observation\twind_speed\twind_speed_qual\tair_temperature\tair_temperature_qual\ttemp\tavg_temp\n954920\t99999\t2003-01-01 00:00:00.0\t1041379200\tFM-12\t200\t1\tN\t4.6\t1\t25.6\t1\t25.6\t28.571428571428573\n954920\t99999\t2003-01-01 02:00:00.0\t1041386400\tFM-12\t230\t1\tN\t5.7\t1\t27.8\t1\t27.8\t27.877777777777776\n954920\t99999\t2003-01-01 03:00:00.0\t1041390000\tFM-12\t220\t1\tN\t7.7\t1\t29.6\t1\t29.6\t27.877777777777776\n954920\t99999\t2003-01-01 05:00:00.0\t1041397200\tFM-12\t230\t1\tN\t6.2\t1\t29.7\t1\t29.7\t26.89090909090909\n954920\t99999\t2003-01-01 06:00:00.0\t1041400800\tFM-12\t240\t1\tN\t6.7\t1\t30.2\t1\t30.2\t26.89090909090909\n954920\t99999\t2003-01-01 08:00:00.0\t1041408000\tFM-12\t210\t1\tN\t6.7\t1\t29.1\t1\t29.1\t25.761538461538464\n954920\t99999\t2003-01-01 09:00:00.0\t1041411600\tFM-12\t220\t1\tN\t5.7\t1\t28.0\t1\t28.0\t25.761538461538464\n954920\t99999\t2003-01-01 11:00:00.0\t1041418800\tFM-12\t210\t1\tN\t3.6\t1\t25.9\t1\t25.9\t24.892857142857142\n954920\t99999\t2003-01-01 12:00:00.0\t1041422400\tFM-12\t200\t1\tN\t4.1\t1\t25.0\t1\t25.0\t24.892857142857142\n954920\t99999\t2003-01-01 14:00:00.0\t1041429600\tFM-12\t190\t1\tN\t6.2\t1\t23.0\t1\t23.0\t24.192857142857143\n954920\t99999\t2003-01-01 15:00:00.0\t1041433200\tFM-12\t200\t1\tN\t5.1\t1\t21.9\t1\t21.9\t24.192857142857143\n954920\t99999\t2003-01-01 17:00:00.0\t1041440400\tFM-12\t200\t1\tN\t3.1\t1\t19.8\t1\t19.8\t23.864285714285717\n954920\t99999\t2003-01-01 18:00:00.0\t1041444000\tFM-12\t190\t1\tN\t3.1\t1\t19.3\t1\t19.3\t23.864285714285717\n954920\t99999\t2003-01-01 20:00:00.0\t1041451200\tFM-12\t150\t1\tN\t4.6\t1\t18.9\t1\t18.9\t24.178571428571427\n954920\t99999\t2003-01-01 21:00:00.0\t1041454800\tFM-12\t140\t1\tN\t5.7\t1\t20.3\t1\t20.3\t24.178571428571427\n954920\t99999\t2003-01-01 23:00:00.0\t1041462000\tFM-12\t150\t1\tN\t6.2\t1\t23.3\t1\t23.3\t24.96428571428572\n954920\t99999\t2003-01-02 00:00:00.0\t1041465600\tFM-12\t130\t1\tN\t5.1\t1\t24.3\t1\t24.3\t24.96428571428572\n954920\t99999\t2003-01-02 02:00:00.0\t1041472800\tFM-12\t160\t1\tN\t2.1\t1\t27.0\t1\t27.0\t25.692857142857147\n954920\t99999\t2003-01-02 03:00:00.0\t1041476400\tFM-12\t240\t1\tN\t4.1\t1\t28.3\t1\t28.3\t25.692857142857147\n954920\t99999\t2003-01-02 05:00:00.0\t1041483600\tFM-12\t170\t1\tN\t4.1\t1\t30.3\t1\t30.3\t26.414285714285715\n954920\t99999\t2003-01-02 06:00:00.0\t1041487200\tFM-12\t170\t1\tN\t4.1\t1\t31.2\t1\t31.2\t26.414285714285715\n954920\t99999\t2003-01-02 08:00:00.0\t1041494400\tFM-12\t160\t1\tN\t4.1\t1\t31.3\t1\t31.3\t26.764285714285716\n954920\t99999\t2003-01-02 09:00:00.0\t1041498000\tFM-12\t160\t1\tN\t5.1\t1\t30.6\t1\t30.6\t26.764285714285716\n954920\t99999\t2003-01-02 11:00:00.0\t1041505200\tFM-12\t150\t1\tN\t4.1\t1\t28.0\t1\t28.0\t26.421428571428574\n954920\t99999\t2003-01-02 12:00:00.0\t1041508800\tFM-12\t160\t1\tN\t4.6\t1\t27.1\t1\t27.1\t26.421428571428574\n954920\t99999\t2003-01-02 14:00:00.0\t1041516000\tFM-12\t150\t1\tN\t4.6\t1\t25.0\t1\t25.0\t26.5\n954920\t99999\t2003-01-02 15:00:00.0\t1041519600\tFM-12\t140\t1\tN\t4.1\t1\t24.2\t1\t24.2\t26.5\n954920\t99999\t2003-01-02 17:00:00.0\t1041526800\tFM-12\t150\t1\tN\t3.6\t1\t22.4\t1\t22.4\t26.68571428571429\n954920\t99999\t2003-01-02 18:00:00.0\t1041530400\tFM-12\t150\t1\tN\t3.6\t1\t21.7\t1\t21.7\t26.68571428571429\n954920\t99999\t2003-01-02 20:00:00.0\t1041537600\tFM-12\t150\t1\tN\t3.1\t1\t20.4\t1\t20.4\t27.15\n954920\t99999\t2003-01-02 21:00:00.0\t1041541200\tFM-12\t140\t1\tN\t4.6\t1\t22.4\t1\t22.4\t27.15\n954920\t99999\t2003-01-02 23:00:00.0\t1041548400\tFM-12\t070\t1\tN\t5.1\t1\t27.2\t1\t27.2\t28.00714285714285\n954920\t99999\t2003-01-03 00:00:00.0\t1041552000\tFM-12\t100\t1\tN\t4.1\t1\t29.2\t1\t29.2\t28.00714285714285\n954920\t99999\t2003-01-03 02:00:00.0\t1041559200\tFM-12\t220\t1\tN\t4.1\t1\t32.0\t1\t32.0\t28.72857142857142\n954920\t99999\t2003-01-03 03:00:00.0\t1041562800\tFM-12\t180\t1\tN\t4.6\t1\t32.1\t1\t32.1\t28.72857142857142\n954920\t99999\t2003-01-03 05:00:00.0\t1041570000\tFM-12\t220\t1\tN\t4.6\t1\t34.1\t1\t34.1\t29.407142857142848\n954920\t99999\t2003-01-03 06:00:00.0\t1041573600\tFM-12\t170\t1\tN\t7.2\t1\t34.3\t1\t34.3\t29.407142857142848\n954920\t99999\t2003-01-03 08:00:00.0\t1041580800\tFM-12\t160\t1\tN\t4.6\t1\t34.1\t1\t34.1\t29.814285714285717\n954920\t99999\t2003-01-03 09:00:00.0\t1041584400\tFM-12\t150\t1\tN\t4.6\t1\t33.0\t1\t33.0\t29.814285714285717\n954920\t99999\t2003-01-03 11:00:00.0\t1041591600\tFM-12\t140\t1\tN\t4.1\t1\t30.2\t1\t30.2\t29.271428571428572\n954920\t99999\t2003-01-03 12:00:00.0\t1041595200\tFM-12\t140\t1\tN\t4.1\t1\t29.1\t1\t29.1\t29.271428571428572\n954920\t99999\t2003-01-03 14:00:00.0\t1041602400\tFM-12\t150\t1\tN\t4.6\t1\t27.2\t1\t27.2\t29.142857142857146\n954920\t99999\t2003-01-03 15:00:00.0\t1041606000\tFM-12\t150\t1\tN\t4.1\t1\t26.4\t1\t26.4\t29.142857142857146\n954920\t99999\t2003-01-03 17:00:00.0\t1041613200\tFM-12\t160\t1\tN\t3.6\t1\t24.7\t1\t24.7\t29.164285714285718\n954920\t99999\t2003-01-03 18:00:00.0\t1041616800\tFM-12\t170\t1\tN\t3.1\t1\t23.8\t1\t23.8\t29.164285714285718\n954920\t99999\t2003-01-03 20:00:00.0\t1041624000\tFM-12\t150\t1\tN\t4.1\t1\t23.4\t1\t23.4\t29.030769230769234\n954920\t99999\t2003-01-03 21:00:00.0\t1041627600\tFM-12\t130\t1\tN\t4.6\t1\t25.4\t1\t25.4\t29.030769230769234\n954920\t99999\t2003-01-03 23:00:00.0\t1041634800\tFM-12\t100\t1\tN\t8.2\t1\t30.1\t1\t30.1\t29.93846153846153\n954920\t99999\t2003-01-04 00:00:00.0\t1041638400\tFM-12\t120\t1\tN\t8.7\t1\t32.2\t1\t32.2\t29.93846153846153\n954920\t99999\t2003-01-04 02:00:00.0\t1041645600\tFM-12\t130\t1\tN\t6.7\t1\t33.6\t1\t33.6\t30.599999999999994\n954920\t99999\t2003-01-04 03:00:00.0\t1041649200\tFM-12\t170\t1\tN\t6.7\t1\t35.1\t1\t35.1\t30.599999999999994\n954920\t99999\t2003-01-04 05:00:00.0\t1041656400\tFM-12\t160\t1\tN\t6.7\t1\t36.2\t1\t36.2\t31.549999999999997\n954920\t99999\t2003-01-04 08:00:00.0\t1041667200\tFM-12\t160\t1\tN\t5.1\t1\t36.1\t1\t36.1\t32.091666666666676\n954920\t99999\t2003-01-04 09:00:00.0\t1041670800\tFM-12\t150\t1\tN\t5.7\t1\t35.0\t1\t35.0\t32.091666666666676\n954920\t99999\t2003-01-04 12:00:00.0\t1041681600\tFM-12\t160\t1\tN\t4.6\t1\t31.6\t1\t31.6\t31.633333333333336\n954920\t99999\t2003-01-04 14:00:00.0\t1041688800\tFM-12\t150\t1\tN\t4.6\t1\t30.3\t1\t30.3\t31.633333333333336\n954920\t99999\t2003-01-04 15:00:00.0\t1041692400\tFM-12\t150\t1\tN\t4.6\t1\t29.6\t1\t29.6\t31.633333333333336\n954920\t99999\t2003-01-04 17:00:00.0\t1041699600\tFM-12\t150\t1\tN\t5.1\t1\t28.0\t1\t28.0\t31.976923076923086\n954920\t99999\t2003-01-04 18:00:00.0\t1041703200\tFM-12\t150\t1\tN\t4.6\t1\t27.3\t1\t27.3\t31.976923076923086\n954920\t99999\t2003-01-04 20:00:00.0\t1041710400\tFM-12\t130\t1\tN\t6.2\t1\t27.5\t1\t27.5\t32.27692307692308\n954920\t99999\t2003-01-04 21:00:00.0\t1041714000\tFM-12\t110\t1\tN\t6.7\t1\t29.3\t1\t29.3\t32.27692307692308\n954920\t99999\t2003-01-04 23:00:00.0\t1041721200\tFM-12\t090\t1\tN\t6.2\t1\t34.0\t1\t34.0\t32.78571428571429\n954920\t99999\t2003-01-05 00:00:00.0\t1041724800\tFM-12\t090\t1\tN\t5.1\t1\t34.7\t1\t34.7\t32.78571428571429\n954920\t99999\t2003-01-05 02:00:00.0\t1041732000\tFM-12\t070\t1\tN\t4.1\t1\t35.9\t1\t35.9\t33.107142857142854\n954920\t99999\t2003-01-05 03:00:00.0\t1041735600\tFM-12\t080\t1\tN\t4.1\t1\t36.4\t1\t36.4\t33.107142857142854\n954920\t99999\t2003-01-05 05:00:00.0\t1041742800\tFM-12\t090\t1\tN\t5.1\t1\t38.0\t1\t38.0\t33.285714285714285\n954920\t99999\t2003-01-05 06:00:00.0\t1041746400\tFM-12\t060\t1\tN\t4.1\t1\t37.0\t1\t37.0\t33.285714285714285\n954920\t99999\t2003-01-05 08:00:00.0\t1041753600\tFM-12\t070\t1\tN\t5.1\t1\t36.4\t1\t36.4\t32.942857142857136\n954920\t99999\t2003-01-05 09:00:00.0\t1041757200\tFM-12\t020\t1\tN\t6.7\t1\t34.6\t1\t34.6\t32.942857142857136\n954920\t99999\t2003-01-05 11:00:00.0\t1041764400\tFM-12\t060\t1\tN\t4.1\t1\t32.8\t1\t32.8\t32.46923076923077\n954920\t99999\t2003-01-05 12:00:00.0\t1041768000\tFM-12\t060\t1\tN\t2.6\t1\t31.6\t1\t31.6\t32.46923076923077\n954920\t99999\t2003-01-05 14:00:00.0\t1041775200\tFM-12\t060\t1\tN\t2.6\t1\t29.6\t1\t29.6\t32.153846153846146\n954920\t99999\t2003-01-05 15:00:00.0\t1041778800\tFM-12\t070\t1\tN\t1.0\t1\t28.2\t1\t28.2\t32.153846153846146\n954920\t99999\t2003-01-05 17:00:00.0\t1041786000\tFM-12\t110\t1\tN\t2.6\t1\t26.3\t1\t26.3\t32.03076923076923\n954920\t99999\t2003-01-05 18:00:00.0\t1041789600\tFM-12\t110\t1\tN\t3.1\t1\t25.7\t1\t25.7\t32.03076923076923\n954920\t99999\t2003-01-05 21:00:00.0\t1041800400\tFM-12\t070\t1\tN\t5.1\t1\t29.6\t1\t29.6\t32.392307692307696\n954920\t99999\t2003-01-05 23:00:00.0\t1041807600\tFM-12\t040\t1\tN\t6.7\t1\t33.3\t1\t33.3\t33.16153846153847\n954920\t99999\t2003-01-06 00:00:00.0\t1041811200\tFM-12\t030\t1\tN\t7.2\t1\t34.9\t1\t34.9\t33.16153846153847\n954920\t99999\t2003-01-06 02:00:00.0\t1041818400\tFM-12\t360\t1\tN\t5.1\t1\t36.9\t1\t36.9\t33.89230769230769\n954920\t99999\t2003-01-06 03:00:00.0\t1041822000\tFM-12\t010\t1\tN\t2.1\t1\t36.5\t1\t36.5\t33.89230769230769\n954920\t99999\t2003-01-06 05:00:00.0\t1041829200\tFM-12\t130\t1\tN\t3.6\t1\t38.0\t1\t38.0\t34.69230769230769\n954920\t99999\t2003-01-06 06:00:00.0\t1041832800\tFM-12\t140\t1\tN\t6.2\t1\t37.7\t1\t37.7\t34.69230769230769\n954920\t99999\t2003-01-06 08:00:00.0\t1041840000\tFM-12\t100\t1\tN\t5.1\t1\t37.5\t1\t37.5\t34.07142857142857\n954920\t99999\t2003-01-06 09:00:00.0\t1041843600\tFM-12\t100\t1\tN\t4.1\t1\t36.9\t1\t36.9\t34.07142857142857\n954920\t99999\t2003-01-06 11:00:00.0\t1041850800\tFM-12\t080\t1\tN\t2.6\t1\t34.0\t1\t34.0\t33.07857142857142\n954920\t99999\t2003-01-06 12:00:00.0\t1041854400\tFM-12\t090\t1\tN\t3.6\t1\t33.3\t1\t33.3\t33.07857142857142\n954920\t99999\t2003-01-06 14:00:00.0\t1041861600\tFM-12\t080\t1\tN\t3.6\t1\t31.4\t1\t31.4\t32.84285714285714\n954920\t99999\t2003-01-06 15:00:00.0\t1041865200\tFM-12\t080\t1\tN\t4.1\t1\t31.0\t1\t31.0\t32.84285714285714\n954920\t99999\t2003-01-06 17:00:00.0\t1041872400\tFM-12\t080\t1\tN\t3.1\t1\t28.2\t1\t28.2\t32.77142857142857\n954920\t99999\t2003-01-06 18:00:00.0\t1041876000\tFM-12\t060\t1\tN\t3.1\t1\t27.4\t1\t27.4\t32.77142857142857\n954920\t99999\t2003-01-06 20:00:00.0\t1041883200\tFM-12\t070\t1\tN\t2.6\t1\t25.5\t1\t25.5\t32.97142857142857\n954920\t99999\t2003-01-06 21:00:00.0\t1041886800\tFM-12\t070\t1\tN\t4.1\t1\t28.8\t1\t28.8\t32.97142857142857\n954920\t99999\t2003-01-06 23:00:00.0\t1041894000\tFM-12\t010\t1\tN\t7.2\t1\t34.3\t1\t34.3\t33.66428571428571\n954920\t99999\t2003-01-07 00:00:00.0\t1041897600\tFM-12\t360\t1\tN\t7.2\t1\t35.8\t1\t35.8\t33.66428571428571\n954920\t99999\t2003-01-07 02:00:00.0\t1041904800\tFM-12\t040\t1\tN\t6.2\t1\t37.1\t1\t37.1\t33.94285714285714\n954920\t99999\t2003-01-07 03:00:00.0\t1041908400\tFM-12\t040\t1\tN\t4.6\t1\t37.6\t1\t37.6\t33.94285714285714\n954920\t99999\t2003-01-07 05:00:00.0\t1041915600\tFM-12\t050\t1\tN\t3.6\t1\t38.5\t1\t38.5\t34.150000000000006\n954920\t99999\t2003-01-07 06:00:00.0\t1041919200\tFM-12\t070\t1\tN\t3.1\t1\t38.7\t1\t38.7\t34.150000000000006\n954920\t99999\t2003-01-07 08:00:00.0\t1041926400\tFM-12\t080\t1\tN\t3.6\t1\t39.1\t1\t39.1\t34.02142857142858\n954920\t99999\t2003-01-07 09:00:00.0\t1041930000\tFM-12\t100\t1\tN\t3.6\t1\t37.9\t1\t37.9\t34.02142857142858\n954920\t99999\t2003-01-07 11:00:00.0\t1041937200\tFM-12\t080\t1\tN\t3.1\t1\t34.0\t1\t34.0\t32.98571428571429\n954920\t99999\t2003-01-07 12:00:00.0\t1041940800\tFM-12\t050\t1\tN\t3.1\t1\t32.3\t1\t32.3\t32.98571428571429\n954920\t99999\t2003-01-07 14:00:00.0\t1041948000\tFM-12\t050\t1\tN\t3.1\t1\t29.8\t1\t29.8\t32.94285714285714\n954920\t99999\t2003-01-07 15:00:00.0\t1041951600\tFM-12\t050\t1\tN\t2.6\t1\t28.7\t1\t28.7\t32.94285714285714\n954920\t99999\t2003-01-07 17:00:00.0\t1041958800\tFM-12\t360\t1\tN\t1.0\t1\t25.7\t1\t25.7\t33.07857142857143\n954920\t99999\t2003-01-07 18:00:00.0\t1041962400\tFM-12\t360\t1\tN\t3.1\t1\t26.8\t1\t26.8\t33.07857142857143\n954920\t99999\t2003-01-07 20:00:00.0\t1041969600\tFM-12\t030\t1\tN\t2.6\t1\t26.4\t1\t26.4\t33.25\n954920\t99999\t2003-01-07 21:00:00.0\t1041973200\tFM-12\t020\t1\tN\t3.1\t1\t29.2\t1\t29.2\t33.25\n954920\t99999\t2003-01-07 23:00:00.0\t1041980400\tFM-12\t310\t1\tN\t5.7\t1\t35.9\t1\t35.9\t34.04285714285714\n954920\t99999\t2003-01-08 00:00:00.0\t1041984000\tFM-12\t310\t1\tN\t6.7\t1\t38.2\t1\t38.2\t34.04285714285714\n954920\t99999\t2003-01-08 02:00:00.0\t1041991200\tFM-12\t280\t1\tN\t4.6\t1\t39.9\t1\t39.9\t34.84166666666666\n954920\t99999\t2003-01-08 03:00:00.0\t1041994800\tFM-12\t260\t1\tN\t5.7\t1\t39.2\t1\t39.2\t34.84166666666666\n954920\t99999\t2003-01-08 05:00:00.0\t1042002000\tFM-12\t320\t1\tN\t3.6\t1\t39.6\t1\t39.6\t35.408333333333324\n954920\t99999\t2003-01-08 06:00:00.0\t1042005600\tFM-12\t260\t1\tN\t2.1\t1\t39.8\t1\t39.8\t35.408333333333324\n954920\t99999\t2003-01-08 08:00:00.0\t1042012800\tFM-12\t240\t1\tN\t3.6\t1\t39.2\t1\t39.2\t35.166666666666664\n954920\t99999\t2003-01-08 09:00:00.0\t1042016400\tFM-12\t140\t1\tN\t7.2\t1\t38.2\t1\t38.2\t35.166666666666664\n954920\t99999\t2003-01-08 14:00:00.0\t1042034400\tFM-12\t170\t1\tN\t6.2\t1\t30.2\t1\t30.2\t30.933333333333337\n954920\t99999\t2003-01-08 15:00:00.0\t1042038000\tFM-12\t160\t1\tN\t7.2\t1\t29.1\t1\t29.1\t30.933333333333337\n954920\t99999\t2003-01-08 17:00:00.0\t1042045200\tFM-12\t150\t1\tN\t7.7\t1\t26.9\t1\t26.9\t29.272727272727273\n954920\t99999\t2003-01-08 18:00:00.0\t1042048800\tFM-12\t150\t1\tN\t6.2\t1\t25.8\t1\t25.8\t29.272727272727273\n954920\t99999\t2003-01-08 20:00:00.0\t1042056000\tFM-12\t150\t1\tN\t5.7\t1\t23.9\t1\t23.9\t28.481818181818184\n954920\t99999\t2003-01-08 21:00:00.0\t1042059600\tFM-12\t140\t1\tN\t6.7\t1\t24.2\t1\t24.2\t28.481818181818184\n954920\t99999\t2003-01-08 23:00:00.0\t1042066800\tFM-12\t130\t1\tN\t6.7\t1\t26.4\t1\t26.4\t29.323076923076922\n954920\t99999\t2003-01-09 00:00:00.0\t1042070400\tFM-12\t140\t1\tN\t6.2\t1\t27.9\t1\t27.9\t29.323076923076922\n954920\t99999\t2003-01-09 02:00:00.0\t1042077600\tFM-12\t130\t1\tN\t5.7\t1\t30.2\t1\t30.2\t29.176923076923075\n954920\t99999\t2003-01-09 03:00:00.0\t1042081200\tFM-12\t999\t9\t9\t999.9\t9\t999.9\t9\tnull\t29.176923076923075\n954920\t99999\t2003-01-09 05:00:00.0\t1042088400\tFM-12\t150\t1\tN\t3.1\t1\t33.9\t1\t33.9\t29.230769230769226\n954920\t99999\t2003-01-09 06:00:00.0\t1042092000\tFM-12\t180\t1\tN\t5.1\t1\t34.8\t1\t34.8\t29.230769230769226\n954920\t99999\t2003-01-09 08:00:00.0\t1042099200\tFM-12\t140\t1\tN\t4.6\t1\t34.4\t1\t34.4\t29.269230769230766\n954920\t99999\t2003-01-09 09:00:00.0\t1042102800\tFM-12\t160\t1\tN\t5.7\t1\t33.5\t1\t33.5\t29.269230769230766\n954920\t99999\t2003-01-09 11:00:00.0\t1042110000\tFM-12\t150\t1\tN\t3.1\t1\t29.5\t1\t29.5\t28.746153846153845\n954920\t99999\t2003-01-09 12:00:00.0\t1042113600\tFM-12\t160\t1\tN\t3.1\t1\t27.9\t1\t27.9\t28.746153846153845\n954920\t99999\t2003-01-09 14:00:00.0\t1042120800\tFM-12\t150\t1\tN\t6.2\t1\t27.2\t1\t27.2\t28.77857142857142\n954920\t99999\t2003-01-09 15:00:00.0\t1042124400\tFM-12\t150\t1\tN\t5.7\t1\t26.2\t1\t26.2\t28.77857142857142\n954920\t99999\t2003-01-09 17:00:00.0\t1042131600\tFM-12\t150\t1\tN\t5.1\t1\t24.4\t1\t24.4\t28.68571428571428\n954920\t99999\t2003-01-09 18:00:00.0\t1042135200\tFM-12\t140\t1\tN\t6.7\t1\t24.2\t1\t24.2\t28.68571428571428\n954920\t99999\t2003-01-09 20:00:00.0\t1042142400\tFM-12\t130\t1\tN\t5.7\t1\t23.1\t1\t23.1\t29.049999999999994\n954920\t99999\t2003-01-09 21:00:00.0\t1042146000\tFM-12\t120\t1\tN\t5.7\t1\t24.4\t1\t24.4\t29.049999999999994\n954920\t99999\t2003-01-09 23:00:00.0\t1042153200\tFM-12\t100\t1\tN\t7.2\t1\t28.8\t1\t28.8\t30.06428571428571\n954920\t99999\t2003-01-10 00:00:00.0\t1042156800\tFM-12\t090\t1\tN\t7.2\t1\t30.6\t1\t30.6\t30.06428571428571\n954920\t99999\t2003-01-10 02:00:00.0\t1042164000\tFM-12\t130\t1\tN\t5.7\t1\t32.9\t1\t32.9\t30.685714285714283\n954920\t99999\t2003-01-10 03:00:00.0\t1042167600\tFM-12\t160\t1\tN\t5.7\t1\t34.5\t1\t34.5\t30.685714285714283\n954920\t99999\t2003-01-10 05:00:00.0\t1042174800\tFM-12\t140\t1\tN\t5.1\t1\t36.8\t1\t36.8\t31.271428571428572\n954920\t99999\t2003-01-10 06:00:00.0\t1042178400\tFM-12\t140\t1\tN\t5.7\t1\t36.2\t1\t36.2\t31.271428571428572\n954920\t99999\t2003-01-10 08:00:00.0\t1042185600\tFM-12\t130\t1\tN\t5.7\t1\t36.3\t1\t36.3\t31.785714285714285\n954920\t99999\t2003-01-10 09:00:00.0\t1042189200\tFM-12\t150\t1\tN\t5.7\t1\t35.3\t1\t35.3\t31.785714285714285\n954920\t99999\t2003-01-10 11:00:00.0\t1042196400\tFM-12\t150\t1\tN\t3.1\t1\t31.6\t1\t31.6\t31.36428571428571\n954920\t99999\t2003-01-10 12:00:00.0\t1042200000\tFM-12\t150\t1\tN\t3.6\t1\t30.5\t1\t30.5\t31.36428571428571\n954920\t99999\t2003-01-10 14:00:00.0\t1042207200\tFM-12\t130\t1\tN\t4.6\t1\t28.7\t1\t28.7\t31.107142857142858\n954920\t99999\t2003-01-10 15:00:00.0\t1042210800\tFM-12\t130\t1\tN\t4.1\t1\t28.1\t1\t28.1\t31.107142857142858\n954920\t99999\t2003-01-10 17:00:00.0\t1042218000\tFM-12\t100\t1\tN\t5.7\t1\t27.7\t1\t27.7\t30.584615384615386\n954920\t99999\t2003-01-10 18:00:00.0\t1042221600\tFM-12\t110\t1\tN\t5.1\t1\t27.0\t1\t27.0\t30.584615384615386\n954920\t99999\t2003-01-10 20:00:00.0\t1042228800\tFM-12\t110\t1\tN\t5.1\t1\t26.0\t1\t26.0\t30.7923076923077\n954920\t99999\t2003-01-10 21:00:00.0\t1042232400\tFM-12\t100\t1\tN\t6.2\t1\t27.5\t1\t27.5\t30.7923076923077\n954920\t99999\t2003-01-10 23:00:00.0\t1042239600\tFM-12\t090\t1\tN\t7.7\t1\t31.4\t1\t31.4\t31.630769230769236\n954920\t99999\t2003-01-11 00:00:00.0\t1042243200\tFM-12\t080\t1\tN\t7.2\t1\t32.4\t1\t32.4\t31.630769230769236\n954920\t99999\t2003-01-11 02:00:00.0\t1042250400\tFM-12\t080\t1\tN\t5.7\t1\t35.1\t1\t35.1\t32.33076923076923\n954920\t99999\t2003-01-11 05:00:00.0\t1042261200\tFM-12\t130\t1\tN\t6.2\t1\t36.8\t1\t36.8\t32.784615384615385\n954920\t99999\t2003-01-11 06:00:00.0\t1042264800\tFM-12\t090\t1\tN\t5.7\t1\t37.5\t1\t37.5\t32.784615384615385\n954920\t99999\t2003-01-11 08:00:00.0\t1042272000\tFM-12\t110\t1\tN\t6.2\t1\t37.1\t1\t37.1\t32.93076923076923\n954920\t99999\t2003-01-11 09:00:00.0\t1042275600\tFM-12\t110\t1\tN\t5.7\t1\t35.9\t1\t35.9\t32.93076923076923\n954920\t99999\t2003-01-11 11:00:00.0\t1042282800\tFM-12\t120\t1\tN\t5.1\t1\t33.4\t1\t33.4\t32.13846153846154\n954920\t99999\t2003-01-11 12:00:00.0\t1042286400\tFM-12\t120\t1\tN\t5.1\t1\t32.5\t1\t32.5\t32.13846153846154\n954920\t99999\t2003-01-11 14:00:00.0\t1042293600\tFM-12\t110\t1\tN\t7.2\t1\t30.7\t1\t30.7\t31.771428571428572\n954920\t99999\t2003-01-11 15:00:00.0\t1042297200\tFM-12\t110\t1\tN\t6.7\t1\t29.9\t1\t29.9\t31.771428571428572\n954920\t99999\t2003-01-11 17:00:00.0\t1042304400\tFM-12\t100\t1\tN\t5.7\t1\t28.0\t1\t28.0\t31.52142857142857\n954920\t99999\t2003-01-11 18:00:00.0\t1042308000\tFM-12\t110\t1\tN\t5.1\t1\t27.4\t1\t27.4\t31.52142857142857\n954920\t99999\t2003-01-11 20:00:00.0\t1042315200\tFM-12\t110\t1\tN\t7.2\t1\t26.5\t1\t26.5\t31.678571428571423\n954920\t99999\t2003-01-11 21:00:00.0\t1042318800\tFM-12\t100\t1\tN\t8.2\t1\t27.0\t1\t27.0\t31.678571428571423\n954920\t99999\t2003-01-11 23:00:00.0\t1042326000\tFM-12\t090\t1\tN\t8.7\t1\t30.0\t1\t30.0\t32.22857142857143\n954920\t99999\t2003-01-12 00:00:00.0\t1042329600\tFM-12\t100\t1\tN\t8.2\t1\t32.1\t1\t32.1\t32.22857142857143\n954920\t99999\t2003-01-12 02:00:00.0\t1042336800\tFM-12\t100\t1\tN\t6.7\t1\t34.8\t1\t34.8\t32.65714285714286\n954920\t99999\t2003-01-12 03:00:00.0\t1042340400\tFM-12\t100\t1\tN\t5.7\t1\t36.0\t1\t36.0\t32.65714285714286\n954920\t99999\t2003-01-12 05:00:00.0\t1042347600\tFM-12\t120\t1\tN\t5.1\t1\t37.5\t1\t37.5\t33.1\n954920\t99999\t2003-01-12 06:00:00.0\t1042351200\tFM-12\t140\t1\tN\t5.1\t1\t37.7\t1\t37.7\t33.1\n954920\t99999\t2003-01-12 08:00:00.0\t1042358400\tFM-12\t140\t1\tN\t6.7\t1\t37.4\t1\t37.4\t33.41428571428572\n954920\t99999\t2003-01-12 09:00:00.0\t1042362000\tFM-12\t100\t1\tN\t6.2\t1\t36.2\t1\t36.2\t33.41428571428572\n954920\t99999\t2003-01-12 11:00:00.0\t1042369200\tFM-12\t120\t1\tN\t5.1\t1\t33.8\t1\t33.8\t33.021428571428565\n954920\t99999\t2003-01-12 12:00:00.0\t1042372800\tFM-12\t120\t1\tN\t6.2\t1\t32.8\t1\t32.8\t33.021428571428565\n954920\t99999\t2003-01-12 14:00:00.0\t1042380000\tFM-12\t110\t1\tN\t6.2\t1\t31.2\t1\t31.2\t32.67857142857142\n954920\t99999\t2003-01-12 15:00:00.0\t1042383600\tFM-12\t100\t1\tN\t6.7\t1\t30.4\t1\t30.4\t32.67857142857142\n954920\t99999\t2003-01-12 17:00:00.0\t1042390800\tFM-12\t090\t1\tN\t5.1\t1\t29.1\t1\t29.1\t32.635714285714286\n954920\t99999\t2003-01-12 18:00:00.0\t1042394400\tFM-12\t090\t1\tN\t5.7\t1\t28.8\t1\t28.8\t32.635714285714286\n954920\t99999\t2003-01-12 20:00:00.0\t1042401600\tFM-12\t090\t1\tN\t4.6\t1\t27.9\t1\t27.9\t33.028571428571425\n954920\t99999\t2003-01-12 21:00:00.0\t1042405200\tFM-12\t100\t1\tN\t6.7\t1\t28.7\t1\t28.7\t33.028571428571425\n954920\t99999\t2003-01-12 23:00:00.0\t1042412400\tFM-12\t070\t1\tN\t6.2\t1\t32.0\t1\t32.0\t33.8\n954920\t99999\t2003-01-13 00:00:00.0\t1042416000\tFM-12\t060\t1\tN\t6.2\t1\t34.0\t1\t34.0\t33.8\n954920\t99999\t2003-01-13 02:00:00.0\t1042423200\tFM-12\t040\t1\tN\t5.1\t1\t36.7\t1\t36.7\t34.44285714285714\n954920\t99999\t2003-01-13 03:00:00.0\t1042426800\tFM-12\t360\t1\tN\t4.1\t1\t37.9\t1\t37.9\t34.44285714285714\n954920\t99999\t2003-01-13 05:00:00.0\t1042434000\tFM-12\t120\t1\tN\t2.6\t1\t39.8\t1\t39.8\t35.00714285714285\n954920\t99999\t2003-01-13 06:00:00.0\t1042437600\tFM-12\t100\t1\tN\t3.6\t1\t39.3\t1\t39.3\t35.00714285714285\n954920\t99999\t2003-01-13 08:00:00.0\t1042444800\tFM-12\t060\t1\tN\t2.1\t1\t38.9\t1\t38.9\t35.30714285714286\n954920\t99999\t2003-01-13 09:00:00.0\t1042448400\tFM-12\t130\t1\tN\t5.1\t1\t38.5\t1\t38.5\t35.30714285714286\n954920\t99999\t2003-01-13 11:00:00.0\t1042455600\tFM-12\t120\t1\tN\t3.6\t1\t35.9\t1\t35.9\t34.83571428571428\n954920\t99999\t2003-01-13 12:00:00.0\t1042459200\tFM-12\t100\t1\tN\t4.1\t1\t34.7\t1\t34.7\t34.83571428571428\n954920\t99999\t2003-01-13 14:00:00.0\t1042466400\tFM-12\t090\t1\tN\t5.7\t1\t33.3\t1\t33.3\t34.392857142857146\n954920\t99999\t2003-01-13 15:00:00.0\t1042470000\tFM-12\t090\t1\tN\t4.6\t1\t32.5\t1\t32.5\t34.392857142857146\n954920\t99999\t2003-01-13 17:00:00.0\t1042477200\tFM-12\t090\t1\tN\t4.6\t1\t30.8\t1\t30.8\t34.15714285714285\n954920\t99999\t2003-01-13 18:00:00.0\t1042480800\tFM-12\t080\t1\tN\t4.1\t1\t30.0\t1\t30.0\t34.15714285714285\n954920\t99999\t2003-01-13 20:00:00.0\t1042488000\tFM-12\t090\t1\tN\t3.6\t1\t28.9\t1\t28.9\t34.31428571428571\n954920\t99999\t2003-01-13 21:00:00.0\t1042491600\tFM-12\t070\t1\tN\t4.6\t1\t30.5\t1\t30.5\t34.31428571428571\n954920\t99999\t2003-01-13 23:00:00.0\t1042498800\tFM-12\t040\t1\tN\t3.6\t1\t33.2\t1\t33.2\t34.92142857142857\n954920\t99999\t2003-01-14 00:00:00.0\t1042502400\tFM-12\t020\t1\tN\t3.6\t1\t35.2\t1\t35.2\t34.92142857142857\n954920\t99999\t2003-01-14 02:00:00.0\t1042509600\tFM-12\t150\t1\tN\t2.6\t1\t37.4\t1\t37.4\t35.37142857142857\n954920\t99999\t2003-01-14 03:00:00.0\t1042513200\tFM-12\t150\t1\tN\t2.1\t1\t38.4\t1\t38.4\t35.37142857142857\n954920\t99999\t2003-01-14 05:00:00.0\t1042520400\tFM-12\t080\t1\tN\t2.1\t1\t39.5\t1\t39.5\t35.62142857142857\n954920\t99999\t2003-01-14 06:00:00.0\t1042524000\tFM-12\t100\t1\tN\t4.6\t1\t40.1\t1\t40.1\t35.62142857142857\n954920\t99999\t2003-01-14 08:00:00.0\t1042531200\tFM-12\t150\t1\tN\t2.6\t1\t39.9\t1\t39.9\t35.55\n954920\t99999\t2003-01-14 09:00:00.0\t1042534800\tFM-12\t130\t1\tN\t4.6\t1\t39.2\t1\t39.2\t35.55\n954920\t99999\t2003-01-14 11:00:00.0\t1042542000\tFM-12\t130\t1\tN\t4.1\t1\t36.6\t1\t36.6\t34.74999999999999\n954920\t99999\t2003-01-14 12:00:00.0\t1042545600\tFM-12\t130\t1\tN\t5.1\t1\t35.5\t1\t35.5\t34.74999999999999\n954920\t99999\t2003-01-14 14:00:00.0\t1042552800\tFM-12\t120\t1\tN\t4.1\t1\t32.6\t1\t32.6\t34.34285714285714\n954920\t99999\t2003-01-14 15:00:00.0\t1042556400\tFM-12\t110\t1\tN\t4.1\t1\t31.7\t1\t31.7\t34.34285714285714\n954920\t99999\t2003-01-14 17:00:00.0\t1042563600\tFM-12\t090\t1\tN\t3.6\t1\t29.6\t1\t29.6\t34.25\n954920\t99999\t2003-01-14 18:00:00.0\t1042567200\tFM-12\t090\t1\tN\t3.6\t1\t28.8\t1\t28.8\t34.25\n954920\t99999\t2003-01-14 20:00:00.0\t1042574400\tFM-12\t090\t1\tN\t4.6\t1\t27.6\t1\t27.6\t34.42142857142858\n954920\t99999\t2003-01-14 21:00:00.0\t1042578000\tFM-12\t090\t1\tN\t5.1\t1\t29.6\t1\t29.6\t34.42142857142858\n954920\t99999\t2003-01-14 23:00:00.0\t1042585200\tFM-12\t040\t1\tN\t4.6\t1\t34.5\t1\t34.5\t35.01428571428572\n954920\t99999\t2003-01-15 00:00:00.0\t1042588800\tFM-12\t010\t1\tN\t4.6\t1\t35.6\t1\t35.6\t35.01428571428572\n954920\t99999\t2003-01-15 02:00:00.0\t1042596000\tFM-12\t340\t1\tN\t3.1\t1\t38.7\t1\t38.7\t35.47142857142858\n954920\t99999\t2003-01-15 03:00:00.0\t1042599600\tFM-12\t030\t1\tN\t4.1\t1\t39.6\t1\t39.6\t35.47142857142858\n954920\t99999\t2003-01-15 05:00:00.0\t1042606800\tFM-12\t130\t1\tN\t2.1\t1\t40.8\t1\t40.8\t36.10714285714286\n954920\t99999\t2003-01-15 06:00:00.0\t1042610400\tFM-12\t090\t1\tN\t3.6\t1\t40.7\t1\t40.7\t36.10714285714286\n954920\t99999\t2003-01-15 08:00:00.0\t1042617600\tFM-12\t110\t1\tN\t5.7\t1\t40.7\t1\t40.7\t36.32857142857143\n954920\t99999\t2003-01-15 09:00:00.0\t1042621200\tFM-12\t110\t1\tN\t4.6\t1\t39.7\t1\t39.7\t36.32857142857143\n954920\t99999\t2003-01-15 11:00:00.0\t1042628400\tFM-12\t100\t1\tN\t2.6\t1\t35.8\t1\t35.8\t35.33571428571428\n954920\t99999\t2003-01-15 12:00:00.0\t1042632000\tFM-12\t090\t1\tN\t3.6\t1\t34.9\t1\t34.9\t35.33571428571428\n954920\t99999\t2003-01-15 14:00:00.0\t1042639200\tFM-12\t080\t1\tN\t4.6\t1\t34.2\t1\t34.2\t35.07142857142857\n954920\t99999\t2003-01-15 15:00:00.0\t1042642800\tFM-12\t070\t1\tN\t4.1\t1\t33.1\t1\t33.1\t35.07142857142857\n954920\t99999\t2003-01-15 17:00:00.0\t1042650000\tFM-12\t080\t1\tN\t3.6\t1\t30.5\t1\t30.5\t35.06428571428571\n954920\t99999\t2003-01-15 18:00:00.0\t1042653600\tFM-12\t020\t1\tN\t5.1\t1\t29.8\t1\t29.8\t35.06428571428571\n954920\t99999\t2003-01-15 20:00:00.0\t1042660800\tFM-12\t100\t1\tN\t2.6\t1\t26.8\t1\t26.8\t35.18571428571429\n954920\t99999\t2003-01-15 21:00:00.0\t1042664400\tFM-12\t080\t1\tN\t2.6\t1\t29.4\t1\t29.4\t35.18571428571429\n954920\t99999\t2003-01-15 23:00:00.0\t1042671600\tFM-12\t010\t1\tN\t5.7\t1\t36.0\t1\t36.0\t35.90714285714286\n954920\t99999\t2003-01-16 00:00:00.0\t1042675200\tFM-12\t010\t1\tN\t6.7\t1\t38.6\t1\t38.6\t35.90714285714286\n954920\t99999\t2003-01-16 02:00:00.0\t1042682400\tFM-12\t040\t1\tN\t4.1\t1\t40.1\t1\t40.1\t36.34285714285714\n954920\t99999\t2003-01-16 03:00:00.0\t1042686000\tFM-12\t100\t1\tN\t5.7\t1\t41.3\t1\t41.3\t36.34285714285714\n954920\t99999\t2003-01-16 05:00:00.0\t1042693200\tFM-12\t090\t1\tN\t6.2\t1\t40.9\t1\t40.9\t37.00714285714286\n954920\t99999\t2003-01-16 06:00:00.0\t1042696800\tFM-12\t060\t1\tN\t5.7\t1\t41.2\t1\t41.2\t37.00714285714286\n954920\t99999\t2003-01-16 08:00:00.0\t1042704000\tFM-12\t080\t1\tN\t6.2\t1\t41.0\t1\t41.0\t37.75\n954920\t99999\t2003-01-16 09:00:00.0\t1042707600\tFM-12\t100\t1\tN\t4.6\t1\t39.8\t1\t39.8\t37.75\n954920\t99999\t2003-01-16 11:00:00.0\t1042714800\tFM-12\t080\t1\tN\t3.6\t1\t37.0\t1\t37.0\t37.042857142857144\n954920\t99999\t2003-01-16 12:00:00.0\t1042718400\tFM-12\t080\t1\tN\t4.6\t1\t36.4\t1\t36.4\t37.042857142857144\n954920\t99999\t2003-01-16 14:00:00.0\t1042725600\tFM-12\t070\t1\tN\t5.1\t1\t34.9\t1\t34.9\t36.43333333333333\n954920\t99999\t2003-01-16 15:00:00.0\t1042729200\tFM-12\t060\t1\tN\t6.2\t1\t34.7\t1\t34.7\t36.43333333333333\n954920\t99999\t2003-01-16 17:00:00.0\t1042736400\tFM-12\t040\t1\tN\t6.2\t1\t33.6\t1\t33.6\t35.510000000000005\n954920\t99999\t2003-01-16 18:00:00.0\t1042740000\tFM-12\t030\t1\tN\t5.7\t1\t33.0\t1\t33.0\t35.510000000000005\n954920\t99999\t2003-01-16 20:00:00.0\t1042747200\tFM-12\t010\t1\tN\t5.1\t1\t31.9\t1\t31.9\t34.2875\n954920\t99999\t2003-01-16 21:00:00.0\t1042750800\tFM-12\t010\t1\tN\t6.2\t1\t32.8\t1\t32.8\t34.2875\n954920\t99999\t2003-01-18 23:00:00.0\t1042930800\tFM-12\t999\t9\tC\t0.0\t1\t34.3\t1\t34.3\t39.075\n954920\t99999\t2003-01-19 00:00:00.0\t1042934400\tFM-12\t360\t1\tN\t1.5\t1\t36.8\t1\t36.8\t39.075\n954920\t99999\t2003-01-19 02:00:00.0\t1042941600\tFM-12\t040\t1\tN\t4.6\t1\t39.3\t1\t39.3\t38.410000000000004\n954920\t99999\t2003-01-19 03:00:00.0\t1042945200\tFM-12\t050\t1\tN\t6.2\t1\t40.6\t1\t40.6\t38.410000000000004\n954920\t99999\t2003-01-19 05:00:00.0\t1042952400\tFM-12\t070\t1\tN\t3.6\t1\t41.5\t1\t41.5\t37.31666666666667\n954920\t99999\t2003-01-19 06:00:00.0\t1042956000\tFM-12\t040\t1\tN\t6.2\t1\t40.9\t1\t40.9\t37.31666666666667\n954920\t99999\t2003-01-19 08:00:00.0\t1042963200\tFM-12\t020\t1\tN\t6.2\t1\t40.0\t1\t40.0\t36.35\n954920\t99999\t2003-01-19 09:00:00.0\t1042966800\tFM-12\t020\t1\tN\t5.1\t1\t39.2\t1\t39.2\t36.35\n954920\t99999\t2003-01-19 11:00:00.0\t1042974000\tFM-12\t360\t1\tN\t3.6\t1\t36.3\t1\t36.3\t35.82142857142857\n954920\t99999\t2003-01-19 12:00:00.0\t1042977600\tFM-12\t250\t1\tN\t2.1\t1\t35.2\t1\t35.2\t35.82142857142857\n954920\t99999\t2003-01-19 14:00:00.0\t1042984800\tFM-12\t300\t1\tN\t1.5\t1\t32.5\t1\t32.5\t35.40714285714285\n954920\t99999\t2003-01-19 15:00:00.0\t1042988400\tFM-12\t999\t9\tC\t0.0\t1\t31.2\t1\t31.2\t35.40714285714285\n954920\t99999\t2003-01-19 17:00:00.0\t1042995600\tFM-12\t210\t1\tN\t2.1\t1\t30.6\t1\t30.6\t35.3\n954920\t99999\t2003-01-19 18:00:00.0\t1042999200\tFM-12\t110\t1\tN\t3.1\t1\t30.5\t1\t30.5\t35.3\n954920\t99999\t2003-01-19 20:00:00.0\t1043006400\tFM-12\t140\t1\tN\t3.6\t1\t31.9\t1\t31.9\t35.13846153846154\n954920\t99999\t2003-01-19 21:00:00.0\t1043010000\tFM-12\t090\t1\tN\t4.1\t1\t31.8\t1\t31.8\t35.13846153846154\n954920\t99999\t2003-01-19 23:00:00.0\t1043017200\tFM-12\t070\t1\tN\t5.1\t1\t36.0\t1\t36.0\t35.33333333333333\n954920\t99999\t2003-01-20 00:00:00.0\t1043020800\tFM-12\t060\t1\tN\t3.6\t1\t38.1\t1\t38.1\t35.33333333333333\n954920\t99999\t2003-01-20 02:00:00.0\t1043028000\tFM-12\t280\t1\tN\t2.6\t1\t39.8\t1\t39.8\t36.14166666666667\n954920\t99999\t2003-01-20 03:00:00.0\t1043031600\tFM-12\t230\t1\tN\t3.6\t1\t41.1\t1\t41.1\t36.14166666666667\n954920\t99999\t2003-01-20 05:00:00.0\t1043038800\tFM-12\t030\t1\tN\t4.6\t1\t41.8\t1\t41.8\t36.300000000000004\n954920\t99999\t2003-01-20 09:00:00.0\t1043053200\tFM-12\t020\t1\tN\t6.7\t1\t38.7\t1\t38.7\t35.716666666666676\n954920\t99999\t2003-01-20 11:00:00.0\t1043060400\tFM-12\t360\t1\tN\t1.0\t1\t37.4\t1\t37.4\t34.21666666666667\n954920\t99999\t2003-01-20 12:00:00.0\t1043064000\tFM-12\t090\t1\tN\t1.5\t1\t36.0\t1\t36.0\t34.21666666666667\n954920\t99999\t2003-01-20 14:00:00.0\t1043071200\tFM-12\t160\t1\tN\t0.5\t1\t32.8\t1\t32.8\t33.61666666666666\n954920\t99999\t2003-01-20 15:00:00.0\t1043074800\tFM-12\t090\t1\tN\t2.6\t1\t30.2\t1\t30.2\t33.61666666666666\n954920\t99999\t2003-01-20 17:00:00.0\t1043082000\tFM-12\t999\t9\tC\t0.0\t1\t29.1\t1\t29.1\t34.161538461538456\n954920\t99999\t2003-01-20 18:00:00.0\t1043085600\tFM-12\t340\t1\tN\t1.0\t1\t27.6\t1\t27.6\t34.161538461538456\n954920\t99999\t2003-01-20 20:00:00.0\t1043092800\tFM-12\t210\t1\tN\t2.6\t1\t27.2\t1\t27.2\t35.08571428571429\n954920\t99999\t2003-01-20 21:00:00.0\t1043096400\tFM-12\t999\t9\tC\t0.0\t1\t28.9\t1\t28.9\t35.08571428571429\n954920\t99999\t2003-01-20 23:00:00.0\t1043103600\tFM-12\t360\t1\tN\t3.1\t1\t35.4\t1\t35.4\t35.79285714285714\n954920\t99999\t2003-01-21 00:00:00.0\t1043107200\tFM-12\t340\t1\tN\t2.1\t1\t38.3\t1\t38.3\t35.79285714285714\n954920\t99999\t2003-01-21 02:00:00.0\t1043114400\tFM-12\t290\t1\tN\t3.6\t1\t41.0\t1\t41.0\t36.607692307692304\n954920\t99999\t2003-01-21 03:00:00.0\t1043118000\tFM-12\t240\t1\tN\t4.1\t1\t41.5\t1\t41.5\t36.607692307692304\n954920\t99999\t2003-01-21 05:00:00.0\t1043125200\tFM-12\t260\t1\tN\t4.1\t1\t43.3\t1\t43.3\t37.83846153846154\n954920\t99999\t2003-01-21 06:00:00.0\t1043128800\tFM-12\t280\t1\tN\t2.1\t1\t42.5\t1\t42.5\t37.83846153846154\n954920\t99999\t2003-01-21 08:00:00.0\t1043136000\tFM-12\t120\t1\tN\t3.6\t1\t41.9\t1\t41.9\t38.300000000000004\n954920\t99999\t2003-01-21 09:00:00.0\t1043139600\tFM-12\t220\t1\tN\t2.1\t1\t41.4\t1\t41.4\t38.300000000000004\n954920\t99999\t2003-01-21 11:00:00.0\t1043146800\tFM-12\t270\t1\tN\t2.1\t1\t37.8\t1\t37.8\t36.97692307692308\n954920\t99999\t2003-01-21 14:00:00.0\t1043157600\tFM-12\t030\t1\tN\t3.1\t1\t36.2\t1\t36.2\t36.15384615384615\n954920\t99999\t2003-01-21 15:00:00.0\t1043161200\tFM-12\t140\t1\tN\t4.6\t1\t36.5\t1\t36.5\t36.15384615384615\n954920\t99999\t2003-01-21 17:00:00.0\t1043168400\tFM-12\t310\t1\tN\t3.1\t1\t31.6\t1\t31.6\t35.79230769230769\n954920\t99999\t2003-01-21 18:00:00.0\t1043172000\tFM-12\t350\t1\tN\t2.6\t1\t30.5\t1\t30.5\t35.79230769230769\n954920\t99999\t2003-01-21 20:00:00.0\t1043179200\tFM-12\t090\t1\tN\t1.5\t1\t27.4\t1\t27.4\t35.93076923076923\n954920\t99999\t2003-01-21 21:00:00.0\t1043182800\tFM-12\t120\t1\tN\t2.6\t1\t29.1\t1\t29.1\t35.93076923076923\n954920\t99999\t2003-01-21 23:00:00.0\t1043190000\tFM-12\t130\t1\tN\t6.7\t1\t35.4\t1\t35.4\t36.47142857142857\n954920\t99999\t2003-01-22 00:00:00.0\t1043193600\tFM-12\t120\t1\tN\t7.2\t1\t36.4\t1\t36.4\t36.47142857142857\n954920\t99999\t2003-01-22 02:00:00.0\t1043200800\tFM-12\t140\t1\tN\t5.7\t1\t40.3\t1\t40.3\t36.478571428571435\n954920\t99999\t2003-01-22 03:00:00.0\t1043204400\tFM-12\t120\t1\tN\t6.2\t1\t40.8\t1\t40.8\t36.478571428571435\n954920\t99999\t2003-01-22 05:00:00.0\t1043211600\tFM-12\t170\t1\tN\t6.2\t1\t42.7\t1\t42.7\t36.67857142857143\n954920\t99999\t2003-01-22 06:00:00.0\t1043215200\tFM-12\t150\t1\tN\t5.7\t1\t42.4\t1\t42.4\t36.67857142857143\n"}]},"apps":[],"jobName":"paragraph_1521912751085_-125598393","id":"20180320-170716_141967933","dateCreated":"2018-03-24T17:32:31+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:16854"},{"text":"%md\nIn most cases we have multiple items (weather stations) in your data. Then we need to specify a *partition key* which defines for every records which other records will be used for creating the window. Onyl records with the same partition keys will be used. In our example this allows to create sliding windows for all weather stations at the same time.\n\nIn SQL this is expressed by additonally specifying the partions as follows\n\n    AGG(value) OVER(PARTITION BY partition_keys ORDER BY order_column RANGE BETWEEN n PRECEEDING and m FOLLOWING)","user":"anonymous","dateUpdated":"2018-03-24T17:43:25+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<p>In most cases we have multiple items (weather stations) in your data. Then we need to specify a <em>partition key</em> which defines for every records which other records will be used for creating the window. Onyl records with the same partition keys will be used. In our example this allows to create sliding windows for all weather stations at the same time.</p>\n<p>In SQL this is expressed by additonally specifying the partions as follows</p>\n<pre><code>AGG(value) OVER(PARTITION BY partition_keys ORDER BY order_column RANGE BETWEEN n PRECEEDING and m FOLLOWING)\n</code></pre>\n</div>"}]},"apps":[],"jobName":"paragraph_1521913245719_1413301973","id":"20180324-174045_1243867278","dateCreated":"2018-03-24T17:40:45+0000","dateStarted":"2018-03-24T17:43:25+0000","dateFinished":"2018-03-24T17:43:25+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:16855"},{"text":"weatherData.createOrReplaceTempView(\"weather\")","dateUpdated":"2018-03-24T17:32:31+0000","config":{"colWidth":12,"editorMode":"ace/mode/scala","results":{},"enabled":true,"editorSetting":{"language":"scala","editOnDblClick":false}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1521912751083_-123289900","id":"20180320-164121_858135351","dateCreated":"2018-03-24T17:32:31+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:16856"},{"text":"%sql\nSELECT\n    *,\n    avg(CASE WHEN air_temperature_qual = 1 THEN air_temperature END) OVER (PARTITION BY usaf,wban ORDER BY ts DESC RANGE BETWEEN 36000 PRECEDING AND 36000 FOLLOWING) AS avg_temp\nFROM\n    weather\nWHERE\n    usaf='954920'\nORDER BY ts    \nLIMIT 100","dateUpdated":"2018-03-24T17:32:31+0000","config":{"colWidth":12,"editorMode":"ace/mode/sql","results":{"0":{"graph":{"mode":"lineChart","height":300,"optionOpen":false,"setting":{"lineChart":{}},"commonSetting":{},"keys":[{"name":"timestamp","index":2,"aggr":"sum"}],"groups":[{"name":"usaf","index":0,"aggr":"sum"},{"name":"wban","index":1,"aggr":"sum"}],"values":[{"name":"air_temperature","index":10,"aggr":"sum"},{"name":"avg_temp","index":12,"aggr":"sum"}]},"helium":{}}},"enabled":true,"editorSetting":{"language":"sql","editOnDblClick":false}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"usaf\twban\ttimestamp\tts\treport_type\twind_direction\twind_direction_qual\twind_observation\twind_speed\twind_speed_qual\tair_temperature\tair_temperature_qual\tavg_temp\n954920\t99999\t2003-01-01 00:00:00.0\t1041379200\tFM-12\t200\t1\tN\t4.6\t1\t25.6\t1\t28.571428571428573\n954920\t99999\t2003-01-01 02:00:00.0\t1041386400\tFM-12\t230\t1\tN\t5.7\t1\t27.8\t1\t27.877777777777776\n954920\t99999\t2003-01-01 03:00:00.0\t1041390000\tFM-12\t220\t1\tN\t7.7\t1\t29.6\t1\t27.877777777777776\n954920\t99999\t2003-01-01 05:00:00.0\t1041397200\tFM-12\t230\t1\tN\t6.2\t1\t29.7\t1\t26.89090909090909\n954920\t99999\t2003-01-01 06:00:00.0\t1041400800\tFM-12\t240\t1\tN\t6.7\t1\t30.2\t1\t26.89090909090909\n954920\t99999\t2003-01-01 08:00:00.0\t1041408000\tFM-12\t210\t1\tN\t6.7\t1\t29.1\t1\t25.761538461538464\n954920\t99999\t2003-01-01 09:00:00.0\t1041411600\tFM-12\t220\t1\tN\t5.7\t1\t28.0\t1\t25.761538461538464\n954920\t99999\t2003-01-01 11:00:00.0\t1041418800\tFM-12\t210\t1\tN\t3.6\t1\t25.9\t1\t24.892857142857142\n954920\t99999\t2003-01-01 12:00:00.0\t1041422400\tFM-12\t200\t1\tN\t4.1\t1\t25.0\t1\t24.892857142857142\n954920\t99999\t2003-01-01 14:00:00.0\t1041429600\tFM-12\t190\t1\tN\t6.2\t1\t23.0\t1\t24.192857142857143\n954920\t99999\t2003-01-01 15:00:00.0\t1041433200\tFM-12\t200\t1\tN\t5.1\t1\t21.9\t1\t24.192857142857143\n954920\t99999\t2003-01-01 17:00:00.0\t1041440400\tFM-12\t200\t1\tN\t3.1\t1\t19.8\t1\t23.864285714285717\n954920\t99999\t2003-01-01 18:00:00.0\t1041444000\tFM-12\t190\t1\tN\t3.1\t1\t19.3\t1\t23.864285714285717\n954920\t99999\t2003-01-01 20:00:00.0\t1041451200\tFM-12\t150\t1\tN\t4.6\t1\t18.9\t1\t24.178571428571427\n954920\t99999\t2003-01-01 21:00:00.0\t1041454800\tFM-12\t140\t1\tN\t5.7\t1\t20.3\t1\t24.178571428571427\n954920\t99999\t2003-01-01 23:00:00.0\t1041462000\tFM-12\t150\t1\tN\t6.2\t1\t23.3\t1\t24.96428571428572\n954920\t99999\t2003-01-02 00:00:00.0\t1041465600\tFM-12\t130\t1\tN\t5.1\t1\t24.3\t1\t24.96428571428572\n954920\t99999\t2003-01-02 02:00:00.0\t1041472800\tFM-12\t160\t1\tN\t2.1\t1\t27.0\t1\t25.692857142857147\n954920\t99999\t2003-01-02 03:00:00.0\t1041476400\tFM-12\t240\t1\tN\t4.1\t1\t28.3\t1\t25.692857142857147\n954920\t99999\t2003-01-02 05:00:00.0\t1041483600\tFM-12\t170\t1\tN\t4.1\t1\t30.3\t1\t26.414285714285715\n954920\t99999\t2003-01-02 06:00:00.0\t1041487200\tFM-12\t170\t1\tN\t4.1\t1\t31.2\t1\t26.414285714285715\n954920\t99999\t2003-01-02 08:00:00.0\t1041494400\tFM-12\t160\t1\tN\t4.1\t1\t31.3\t1\t26.764285714285716\n954920\t99999\t2003-01-02 09:00:00.0\t1041498000\tFM-12\t160\t1\tN\t5.1\t1\t30.6\t1\t26.764285714285716\n954920\t99999\t2003-01-02 11:00:00.0\t1041505200\tFM-12\t150\t1\tN\t4.1\t1\t28.0\t1\t26.421428571428574\n954920\t99999\t2003-01-02 12:00:00.0\t1041508800\tFM-12\t160\t1\tN\t4.6\t1\t27.1\t1\t26.421428571428574\n954920\t99999\t2003-01-02 14:00:00.0\t1041516000\tFM-12\t150\t1\tN\t4.6\t1\t25.0\t1\t26.5\n954920\t99999\t2003-01-02 15:00:00.0\t1041519600\tFM-12\t140\t1\tN\t4.1\t1\t24.2\t1\t26.5\n954920\t99999\t2003-01-02 17:00:00.0\t1041526800\tFM-12\t150\t1\tN\t3.6\t1\t22.4\t1\t26.68571428571429\n954920\t99999\t2003-01-02 18:00:00.0\t1041530400\tFM-12\t150\t1\tN\t3.6\t1\t21.7\t1\t26.68571428571429\n954920\t99999\t2003-01-02 20:00:00.0\t1041537600\tFM-12\t150\t1\tN\t3.1\t1\t20.4\t1\t27.15\n954920\t99999\t2003-01-02 21:00:00.0\t1041541200\tFM-12\t140\t1\tN\t4.6\t1\t22.4\t1\t27.15\n954920\t99999\t2003-01-02 23:00:00.0\t1041548400\tFM-12\t070\t1\tN\t5.1\t1\t27.2\t1\t28.00714285714285\n954920\t99999\t2003-01-03 00:00:00.0\t1041552000\tFM-12\t100\t1\tN\t4.1\t1\t29.2\t1\t28.00714285714285\n954920\t99999\t2003-01-03 02:00:00.0\t1041559200\tFM-12\t220\t1\tN\t4.1\t1\t32.0\t1\t28.72857142857142\n954920\t99999\t2003-01-03 03:00:00.0\t1041562800\tFM-12\t180\t1\tN\t4.6\t1\t32.1\t1\t28.72857142857142\n954920\t99999\t2003-01-03 05:00:00.0\t1041570000\tFM-12\t220\t1\tN\t4.6\t1\t34.1\t1\t29.407142857142848\n954920\t99999\t2003-01-03 06:00:00.0\t1041573600\tFM-12\t170\t1\tN\t7.2\t1\t34.3\t1\t29.407142857142848\n954920\t99999\t2003-01-03 08:00:00.0\t1041580800\tFM-12\t160\t1\tN\t4.6\t1\t34.1\t1\t29.814285714285717\n954920\t99999\t2003-01-03 09:00:00.0\t1041584400\tFM-12\t150\t1\tN\t4.6\t1\t33.0\t1\t29.814285714285717\n954920\t99999\t2003-01-03 11:00:00.0\t1041591600\tFM-12\t140\t1\tN\t4.1\t1\t30.2\t1\t29.271428571428572\n954920\t99999\t2003-01-03 12:00:00.0\t1041595200\tFM-12\t140\t1\tN\t4.1\t1\t29.1\t1\t29.271428571428572\n954920\t99999\t2003-01-03 14:00:00.0\t1041602400\tFM-12\t150\t1\tN\t4.6\t1\t27.2\t1\t29.142857142857146\n954920\t99999\t2003-01-03 15:00:00.0\t1041606000\tFM-12\t150\t1\tN\t4.1\t1\t26.4\t1\t29.142857142857146\n954920\t99999\t2003-01-03 17:00:00.0\t1041613200\tFM-12\t160\t1\tN\t3.6\t1\t24.7\t1\t29.164285714285718\n954920\t99999\t2003-01-03 18:00:00.0\t1041616800\tFM-12\t170\t1\tN\t3.1\t1\t23.8\t1\t29.164285714285718\n954920\t99999\t2003-01-03 20:00:00.0\t1041624000\tFM-12\t150\t1\tN\t4.1\t1\t23.4\t1\t29.030769230769234\n954920\t99999\t2003-01-03 21:00:00.0\t1041627600\tFM-12\t130\t1\tN\t4.6\t1\t25.4\t1\t29.030769230769234\n954920\t99999\t2003-01-03 23:00:00.0\t1041634800\tFM-12\t100\t1\tN\t8.2\t1\t30.1\t1\t29.93846153846153\n954920\t99999\t2003-01-04 00:00:00.0\t1041638400\tFM-12\t120\t1\tN\t8.7\t1\t32.2\t1\t29.93846153846153\n954920\t99999\t2003-01-04 02:00:00.0\t1041645600\tFM-12\t130\t1\tN\t6.7\t1\t33.6\t1\t30.599999999999994\n954920\t99999\t2003-01-04 03:00:00.0\t1041649200\tFM-12\t170\t1\tN\t6.7\t1\t35.1\t1\t30.599999999999994\n954920\t99999\t2003-01-04 05:00:00.0\t1041656400\tFM-12\t160\t1\tN\t6.7\t1\t36.2\t1\t31.549999999999997\n954920\t99999\t2003-01-04 08:00:00.0\t1041667200\tFM-12\t160\t1\tN\t5.1\t1\t36.1\t1\t32.091666666666676\n954920\t99999\t2003-01-04 09:00:00.0\t1041670800\tFM-12\t150\t1\tN\t5.7\t1\t35.0\t1\t32.091666666666676\n954920\t99999\t2003-01-04 12:00:00.0\t1041681600\tFM-12\t160\t1\tN\t4.6\t1\t31.6\t1\t31.633333333333336\n954920\t99999\t2003-01-04 14:00:00.0\t1041688800\tFM-12\t150\t1\tN\t4.6\t1\t30.3\t1\t31.633333333333336\n954920\t99999\t2003-01-04 15:00:00.0\t1041692400\tFM-12\t150\t1\tN\t4.6\t1\t29.6\t1\t31.633333333333336\n954920\t99999\t2003-01-04 17:00:00.0\t1041699600\tFM-12\t150\t1\tN\t5.1\t1\t28.0\t1\t31.976923076923086\n954920\t99999\t2003-01-04 18:00:00.0\t1041703200\tFM-12\t150\t1\tN\t4.6\t1\t27.3\t1\t31.976923076923086\n954920\t99999\t2003-01-04 20:00:00.0\t1041710400\tFM-12\t130\t1\tN\t6.2\t1\t27.5\t1\t32.27692307692308\n954920\t99999\t2003-01-04 21:00:00.0\t1041714000\tFM-12\t110\t1\tN\t6.7\t1\t29.3\t1\t32.27692307692308\n954920\t99999\t2003-01-04 23:00:00.0\t1041721200\tFM-12\t090\t1\tN\t6.2\t1\t34.0\t1\t32.78571428571429\n954920\t99999\t2003-01-05 00:00:00.0\t1041724800\tFM-12\t090\t1\tN\t5.1\t1\t34.7\t1\t32.78571428571429\n954920\t99999\t2003-01-05 02:00:00.0\t1041732000\tFM-12\t070\t1\tN\t4.1\t1\t35.9\t1\t33.107142857142854\n954920\t99999\t2003-01-05 03:00:00.0\t1041735600\tFM-12\t080\t1\tN\t4.1\t1\t36.4\t1\t33.107142857142854\n954920\t99999\t2003-01-05 05:00:00.0\t1041742800\tFM-12\t090\t1\tN\t5.1\t1\t38.0\t1\t33.285714285714285\n954920\t99999\t2003-01-05 06:00:00.0\t1041746400\tFM-12\t060\t1\tN\t4.1\t1\t37.0\t1\t33.285714285714285\n954920\t99999\t2003-01-05 08:00:00.0\t1041753600\tFM-12\t070\t1\tN\t5.1\t1\t36.4\t1\t32.942857142857136\n954920\t99999\t2003-01-05 09:00:00.0\t1041757200\tFM-12\t020\t1\tN\t6.7\t1\t34.6\t1\t32.942857142857136\n954920\t99999\t2003-01-05 11:00:00.0\t1041764400\tFM-12\t060\t1\tN\t4.1\t1\t32.8\t1\t32.46923076923077\n954920\t99999\t2003-01-05 12:00:00.0\t1041768000\tFM-12\t060\t1\tN\t2.6\t1\t31.6\t1\t32.46923076923077\n954920\t99999\t2003-01-05 14:00:00.0\t1041775200\tFM-12\t060\t1\tN\t2.6\t1\t29.6\t1\t32.153846153846146\n954920\t99999\t2003-01-05 15:00:00.0\t1041778800\tFM-12\t070\t1\tN\t1.0\t1\t28.2\t1\t32.153846153846146\n954920\t99999\t2003-01-05 17:00:00.0\t1041786000\tFM-12\t110\t1\tN\t2.6\t1\t26.3\t1\t32.03076923076923\n954920\t99999\t2003-01-05 18:00:00.0\t1041789600\tFM-12\t110\t1\tN\t3.1\t1\t25.7\t1\t32.03076923076923\n954920\t99999\t2003-01-05 21:00:00.0\t1041800400\tFM-12\t070\t1\tN\t5.1\t1\t29.6\t1\t32.392307692307696\n954920\t99999\t2003-01-05 23:00:00.0\t1041807600\tFM-12\t040\t1\tN\t6.7\t1\t33.3\t1\t33.16153846153847\n954920\t99999\t2003-01-06 00:00:00.0\t1041811200\tFM-12\t030\t1\tN\t7.2\t1\t34.9\t1\t33.16153846153847\n954920\t99999\t2003-01-06 02:00:00.0\t1041818400\tFM-12\t360\t1\tN\t5.1\t1\t36.9\t1\t33.89230769230769\n954920\t99999\t2003-01-06 03:00:00.0\t1041822000\tFM-12\t010\t1\tN\t2.1\t1\t36.5\t1\t33.89230769230769\n954920\t99999\t2003-01-06 05:00:00.0\t1041829200\tFM-12\t130\t1\tN\t3.6\t1\t38.0\t1\t34.69230769230769\n954920\t99999\t2003-01-06 06:00:00.0\t1041832800\tFM-12\t140\t1\tN\t6.2\t1\t37.7\t1\t34.69230769230769\n954920\t99999\t2003-01-06 08:00:00.0\t1041840000\tFM-12\t100\t1\tN\t5.1\t1\t37.5\t1\t34.07142857142857\n954920\t99999\t2003-01-06 09:00:00.0\t1041843600\tFM-12\t100\t1\tN\t4.1\t1\t36.9\t1\t34.07142857142857\n954920\t99999\t2003-01-06 11:00:00.0\t1041850800\tFM-12\t080\t1\tN\t2.6\t1\t34.0\t1\t33.07857142857142\n954920\t99999\t2003-01-06 12:00:00.0\t1041854400\tFM-12\t090\t1\tN\t3.6\t1\t33.3\t1\t33.07857142857142\n954920\t99999\t2003-01-06 14:00:00.0\t1041861600\tFM-12\t080\t1\tN\t3.6\t1\t31.4\t1\t32.84285714285714\n954920\t99999\t2003-01-06 15:00:00.0\t1041865200\tFM-12\t080\t1\tN\t4.1\t1\t31.0\t1\t32.84285714285714\n954920\t99999\t2003-01-06 17:00:00.0\t1041872400\tFM-12\t080\t1\tN\t3.1\t1\t28.2\t1\t32.77142857142857\n954920\t99999\t2003-01-06 18:00:00.0\t1041876000\tFM-12\t060\t1\tN\t3.1\t1\t27.4\t1\t32.77142857142857\n954920\t99999\t2003-01-06 20:00:00.0\t1041883200\tFM-12\t070\t1\tN\t2.6\t1\t25.5\t1\t32.97142857142857\n954920\t99999\t2003-01-06 21:00:00.0\t1041886800\tFM-12\t070\t1\tN\t4.1\t1\t28.8\t1\t32.97142857142857\n954920\t99999\t2003-01-06 23:00:00.0\t1041894000\tFM-12\t010\t1\tN\t7.2\t1\t34.3\t1\t33.66428571428571\n954920\t99999\t2003-01-07 00:00:00.0\t1041897600\tFM-12\t360\t1\tN\t7.2\t1\t35.8\t1\t33.66428571428571\n954920\t99999\t2003-01-07 02:00:00.0\t1041904800\tFM-12\t040\t1\tN\t6.2\t1\t37.1\t1\t33.94285714285714\n954920\t99999\t2003-01-07 03:00:00.0\t1041908400\tFM-12\t040\t1\tN\t4.6\t1\t37.6\t1\t33.94285714285714\n954920\t99999\t2003-01-07 05:00:00.0\t1041915600\tFM-12\t050\t1\tN\t3.6\t1\t38.5\t1\t34.150000000000006\n954920\t99999\t2003-01-07 06:00:00.0\t1041919200\tFM-12\t070\t1\tN\t3.1\t1\t38.7\t1\t34.150000000000006\n954920\t99999\t2003-01-07 08:00:00.0\t1041926400\tFM-12\t080\t1\tN\t3.6\t1\t39.1\t1\t34.02142857142858\n954920\t99999\t2003-01-07 09:00:00.0\t1041930000\tFM-12\t100\t1\tN\t3.6\t1\t37.9\t1\t34.02142857142858\n"}]},"apps":[],"jobName":"paragraph_1521912751087_-124828895","id":"20180320-165112_824807909","dateCreated":"2018-03-24T17:32:31+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:16857"},{"text":"%md\n## Using programmatic SQL\n\nOf course the window functionality can also be accessed from the Spark DataFrame interface.\n","user":"anonymous","dateUpdated":"2018-03-24T17:43:56+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h2>Using programmatic SQL</h2>\n<p>Of course the window functionality can also be accessed from the Spark DataFrame interface.</p>\n</div>"}]},"apps":[],"jobName":"paragraph_1521913410859_265458087","id":"20180324-174330_1734699199","dateCreated":"2018-03-24T17:43:30+0000","dateStarted":"2018-03-24T17:43:56+0000","dateFinished":"2018-03-24T17:43:56+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:16858"},{"text":"import org.apache.spark.sql.expressions.Window\n\nval window = Window.partitionBy(\"usaf\",\"wban\").orderBy(\"ts\").rangeBetween(-36000, 36000)\nval df = weatherData.select(\n            col(\"*\"), \n            avg(when(col(\"air_temperature_qual\") === lit(1), col(\"air_temperature\"))).over(window).as(\"avg_temp\")\n        ).orderBy(col(\"ts\"))\n        \nz.show(df.where(\"usaf='954920'\").limit(100))","dateUpdated":"2018-03-24T17:32:31+0000","config":{"colWidth":12,"editorMode":"ace/mode/scala","results":{"1":{"graph":{"mode":"lineChart","height":300,"optionOpen":false,"setting":{"lineChart":{}},"commonSetting":{},"keys":[{"name":"timestamp","index":2,"aggr":"sum"}],"groups":[{"name":"usaf","index":0,"aggr":"sum"},{"name":"wban","index":1,"aggr":"sum"}],"values":[{"name":"air_temperature","index":10,"aggr":"sum"},{"name":"avg_temp","index":12,"aggr":"sum"}]},"helium":{}}},"enabled":true,"editorSetting":{"language":"scala","editOnDblClick":false}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"import org.apache.spark.sql.expressions.Window\nwindow: org.apache.spark.sql.expressions.WindowSpec = org.apache.spark.sql.expressions.WindowSpec@2bb8984f\ndf: org.apache.spark.sql.Dataset[org.apache.spark.sql.Row] = [usaf: string, wban: string ... 11 more fields]\n"},{"type":"TABLE","data":"usaf\twban\ttimestamp\tts\treport_type\twind_direction\twind_direction_qual\twind_observation\twind_speed\twind_speed_qual\tair_temperature\tair_temperature_qual\tavg_temp\n954920\t99999\t2003-01-01 00:00:00.0\t1041379200\tFM-12\t200\t1\tN\t4.6\t1\t25.6\t1\t28.571428571428573\n954920\t99999\t2003-01-01 02:00:00.0\t1041386400\tFM-12\t230\t1\tN\t5.7\t1\t27.8\t1\t27.87777777777778\n954920\t99999\t2003-01-01 03:00:00.0\t1041390000\tFM-12\t220\t1\tN\t7.7\t1\t29.6\t1\t27.87777777777778\n954920\t99999\t2003-01-01 05:00:00.0\t1041397200\tFM-12\t230\t1\tN\t6.2\t1\t29.7\t1\t26.890909090909087\n954920\t99999\t2003-01-01 06:00:00.0\t1041400800\tFM-12\t240\t1\tN\t6.7\t1\t30.2\t1\t26.890909090909087\n954920\t99999\t2003-01-01 08:00:00.0\t1041408000\tFM-12\t210\t1\tN\t6.7\t1\t29.1\t1\t25.76153846153846\n954920\t99999\t2003-01-01 09:00:00.0\t1041411600\tFM-12\t220\t1\tN\t5.7\t1\t28.0\t1\t25.76153846153846\n954920\t99999\t2003-01-01 11:00:00.0\t1041418800\tFM-12\t210\t1\tN\t3.6\t1\t25.9\t1\t24.892857142857142\n954920\t99999\t2003-01-01 12:00:00.0\t1041422400\tFM-12\t200\t1\tN\t4.1\t1\t25.0\t1\t24.892857142857142\n954920\t99999\t2003-01-01 14:00:00.0\t1041429600\tFM-12\t190\t1\tN\t6.2\t1\t23.0\t1\t24.192857142857147\n954920\t99999\t2003-01-01 15:00:00.0\t1041433200\tFM-12\t200\t1\tN\t5.1\t1\t21.9\t1\t24.192857142857147\n954920\t99999\t2003-01-01 17:00:00.0\t1041440400\tFM-12\t200\t1\tN\t3.1\t1\t19.8\t1\t23.86428571428572\n954920\t99999\t2003-01-01 18:00:00.0\t1041444000\tFM-12\t190\t1\tN\t3.1\t1\t19.3\t1\t23.86428571428572\n954920\t99999\t2003-01-01 20:00:00.0\t1041451200\tFM-12\t150\t1\tN\t4.6\t1\t18.9\t1\t24.178571428571434\n954920\t99999\t2003-01-01 21:00:00.0\t1041454800\tFM-12\t140\t1\tN\t5.7\t1\t20.3\t1\t24.178571428571434\n954920\t99999\t2003-01-01 23:00:00.0\t1041462000\tFM-12\t150\t1\tN\t6.2\t1\t23.3\t1\t24.96428571428572\n954920\t99999\t2003-01-02 00:00:00.0\t1041465600\tFM-12\t130\t1\tN\t5.1\t1\t24.3\t1\t24.96428571428572\n954920\t99999\t2003-01-02 02:00:00.0\t1041472800\tFM-12\t160\t1\tN\t2.1\t1\t27.0\t1\t25.692857142857147\n954920\t99999\t2003-01-02 03:00:00.0\t1041476400\tFM-12\t240\t1\tN\t4.1\t1\t28.3\t1\t25.692857142857147\n954920\t99999\t2003-01-02 05:00:00.0\t1041483600\tFM-12\t170\t1\tN\t4.1\t1\t30.3\t1\t26.414285714285715\n954920\t99999\t2003-01-02 06:00:00.0\t1041487200\tFM-12\t170\t1\tN\t4.1\t1\t31.2\t1\t26.414285714285715\n954920\t99999\t2003-01-02 08:00:00.0\t1041494400\tFM-12\t160\t1\tN\t4.1\t1\t31.3\t1\t26.76428571428571\n954920\t99999\t2003-01-02 09:00:00.0\t1041498000\tFM-12\t160\t1\tN\t5.1\t1\t30.6\t1\t26.76428571428571\n954920\t99999\t2003-01-02 11:00:00.0\t1041505200\tFM-12\t150\t1\tN\t4.1\t1\t28.0\t1\t26.42142857142856\n954920\t99999\t2003-01-02 12:00:00.0\t1041508800\tFM-12\t160\t1\tN\t4.6\t1\t27.1\t1\t26.42142857142856\n954920\t99999\t2003-01-02 14:00:00.0\t1041516000\tFM-12\t150\t1\tN\t4.6\t1\t25.0\t1\t26.499999999999996\n954920\t99999\t2003-01-02 15:00:00.0\t1041519600\tFM-12\t140\t1\tN\t4.1\t1\t24.2\t1\t26.499999999999996\n954920\t99999\t2003-01-02 17:00:00.0\t1041526800\tFM-12\t150\t1\tN\t3.6\t1\t22.4\t1\t26.685714285714287\n954920\t99999\t2003-01-02 18:00:00.0\t1041530400\tFM-12\t150\t1\tN\t3.6\t1\t21.7\t1\t26.685714285714287\n954920\t99999\t2003-01-02 20:00:00.0\t1041537600\tFM-12\t150\t1\tN\t3.1\t1\t20.4\t1\t27.150000000000002\n954920\t99999\t2003-01-02 21:00:00.0\t1041541200\tFM-12\t140\t1\tN\t4.6\t1\t22.4\t1\t27.150000000000002\n954920\t99999\t2003-01-02 23:00:00.0\t1041548400\tFM-12\t070\t1\tN\t5.1\t1\t27.2\t1\t28.00714285714286\n954920\t99999\t2003-01-03 00:00:00.0\t1041552000\tFM-12\t100\t1\tN\t4.1\t1\t29.2\t1\t28.00714285714286\n954920\t99999\t2003-01-03 02:00:00.0\t1041559200\tFM-12\t220\t1\tN\t4.1\t1\t32.0\t1\t28.72857142857143\n954920\t99999\t2003-01-03 03:00:00.0\t1041562800\tFM-12\t180\t1\tN\t4.6\t1\t32.1\t1\t28.72857142857143\n954920\t99999\t2003-01-03 05:00:00.0\t1041570000\tFM-12\t220\t1\tN\t4.6\t1\t34.1\t1\t29.407142857142855\n954920\t99999\t2003-01-03 06:00:00.0\t1041573600\tFM-12\t170\t1\tN\t7.2\t1\t34.3\t1\t29.407142857142855\n954920\t99999\t2003-01-03 08:00:00.0\t1041580800\tFM-12\t160\t1\tN\t4.6\t1\t34.1\t1\t29.814285714285713\n954920\t99999\t2003-01-03 09:00:00.0\t1041584400\tFM-12\t150\t1\tN\t4.6\t1\t33.0\t1\t29.814285714285713\n954920\t99999\t2003-01-03 11:00:00.0\t1041591600\tFM-12\t140\t1\tN\t4.1\t1\t30.2\t1\t29.271428571428565\n954920\t99999\t2003-01-03 12:00:00.0\t1041595200\tFM-12\t140\t1\tN\t4.1\t1\t29.1\t1\t29.271428571428565\n954920\t99999\t2003-01-03 14:00:00.0\t1041602400\tFM-12\t150\t1\tN\t4.6\t1\t27.2\t1\t29.14285714285714\n954920\t99999\t2003-01-03 15:00:00.0\t1041606000\tFM-12\t150\t1\tN\t4.1\t1\t26.4\t1\t29.14285714285714\n954920\t99999\t2003-01-03 17:00:00.0\t1041613200\tFM-12\t160\t1\tN\t3.6\t1\t24.7\t1\t29.164285714285718\n954920\t99999\t2003-01-03 18:00:00.0\t1041616800\tFM-12\t170\t1\tN\t3.1\t1\t23.8\t1\t29.164285714285718\n954920\t99999\t2003-01-03 20:00:00.0\t1041624000\tFM-12\t150\t1\tN\t4.1\t1\t23.4\t1\t29.030769230769234\n954920\t99999\t2003-01-03 21:00:00.0\t1041627600\tFM-12\t130\t1\tN\t4.6\t1\t25.4\t1\t29.030769230769234\n954920\t99999\t2003-01-03 23:00:00.0\t1041634800\tFM-12\t100\t1\tN\t8.2\t1\t30.1\t1\t29.93846153846154\n954920\t99999\t2003-01-04 00:00:00.0\t1041638400\tFM-12\t120\t1\tN\t8.7\t1\t32.2\t1\t29.93846153846154\n954920\t99999\t2003-01-04 02:00:00.0\t1041645600\tFM-12\t130\t1\tN\t6.7\t1\t33.6\t1\t30.600000000000005\n954920\t99999\t2003-01-04 03:00:00.0\t1041649200\tFM-12\t170\t1\tN\t6.7\t1\t35.1\t1\t30.600000000000005\n954920\t99999\t2003-01-04 05:00:00.0\t1041656400\tFM-12\t160\t1\tN\t6.7\t1\t36.2\t1\t31.550000000000008\n954920\t99999\t2003-01-04 08:00:00.0\t1041667200\tFM-12\t160\t1\tN\t5.1\t1\t36.1\t1\t32.09166666666667\n954920\t99999\t2003-01-04 09:00:00.0\t1041670800\tFM-12\t150\t1\tN\t5.7\t1\t35.0\t1\t32.09166666666667\n954920\t99999\t2003-01-04 12:00:00.0\t1041681600\tFM-12\t160\t1\tN\t4.6\t1\t31.6\t1\t31.633333333333336\n954920\t99999\t2003-01-04 14:00:00.0\t1041688800\tFM-12\t150\t1\tN\t4.6\t1\t30.3\t1\t31.633333333333336\n954920\t99999\t2003-01-04 15:00:00.0\t1041692400\tFM-12\t150\t1\tN\t4.6\t1\t29.6\t1\t31.633333333333336\n954920\t99999\t2003-01-04 17:00:00.0\t1041699600\tFM-12\t150\t1\tN\t5.1\t1\t28.0\t1\t31.97692307692307\n954920\t99999\t2003-01-04 18:00:00.0\t1041703200\tFM-12\t150\t1\tN\t4.6\t1\t27.3\t1\t31.97692307692307\n954920\t99999\t2003-01-04 20:00:00.0\t1041710400\tFM-12\t130\t1\tN\t6.2\t1\t27.5\t1\t32.276923076923076\n954920\t99999\t2003-01-04 21:00:00.0\t1041714000\tFM-12\t110\t1\tN\t6.7\t1\t29.3\t1\t32.276923076923076\n954920\t99999\t2003-01-04 23:00:00.0\t1041721200\tFM-12\t090\t1\tN\t6.2\t1\t34.0\t1\t32.785714285714285\n954920\t99999\t2003-01-05 00:00:00.0\t1041724800\tFM-12\t090\t1\tN\t5.1\t1\t34.7\t1\t32.785714285714285\n954920\t99999\t2003-01-05 02:00:00.0\t1041732000\tFM-12\t070\t1\tN\t4.1\t1\t35.9\t1\t33.10714285714286\n954920\t99999\t2003-01-05 03:00:00.0\t1041735600\tFM-12\t080\t1\tN\t4.1\t1\t36.4\t1\t33.10714285714286\n954920\t99999\t2003-01-05 05:00:00.0\t1041742800\tFM-12\t090\t1\tN\t5.1\t1\t38.0\t1\t33.28571428571429\n954920\t99999\t2003-01-05 06:00:00.0\t1041746400\tFM-12\t060\t1\tN\t4.1\t1\t37.0\t1\t33.28571428571429\n954920\t99999\t2003-01-05 08:00:00.0\t1041753600\tFM-12\t070\t1\tN\t5.1\t1\t36.4\t1\t32.94285714285714\n954920\t99999\t2003-01-05 09:00:00.0\t1041757200\tFM-12\t020\t1\tN\t6.7\t1\t34.6\t1\t32.94285714285714\n954920\t99999\t2003-01-05 11:00:00.0\t1041764400\tFM-12\t060\t1\tN\t4.1\t1\t32.8\t1\t32.469230769230776\n954920\t99999\t2003-01-05 12:00:00.0\t1041768000\tFM-12\t060\t1\tN\t2.6\t1\t31.6\t1\t32.469230769230776\n954920\t99999\t2003-01-05 14:00:00.0\t1041775200\tFM-12\t060\t1\tN\t2.6\t1\t29.6\t1\t32.15384615384615\n954920\t99999\t2003-01-05 15:00:00.0\t1041778800\tFM-12\t070\t1\tN\t1.0\t1\t28.2\t1\t32.15384615384615\n954920\t99999\t2003-01-05 17:00:00.0\t1041786000\tFM-12\t110\t1\tN\t2.6\t1\t26.3\t1\t32.03076923076923\n954920\t99999\t2003-01-05 18:00:00.0\t1041789600\tFM-12\t110\t1\tN\t3.1\t1\t25.7\t1\t32.03076923076923\n954920\t99999\t2003-01-05 21:00:00.0\t1041800400\tFM-12\t070\t1\tN\t5.1\t1\t29.6\t1\t32.39230769230768\n954920\t99999\t2003-01-05 23:00:00.0\t1041807600\tFM-12\t040\t1\tN\t6.7\t1\t33.3\t1\t33.161538461538456\n954920\t99999\t2003-01-06 00:00:00.0\t1041811200\tFM-12\t030\t1\tN\t7.2\t1\t34.9\t1\t33.161538461538456\n954920\t99999\t2003-01-06 02:00:00.0\t1041818400\tFM-12\t360\t1\tN\t5.1\t1\t36.9\t1\t33.89230769230769\n954920\t99999\t2003-01-06 03:00:00.0\t1041822000\tFM-12\t010\t1\tN\t2.1\t1\t36.5\t1\t33.89230769230769\n954920\t99999\t2003-01-06 05:00:00.0\t1041829200\tFM-12\t130\t1\tN\t3.6\t1\t38.0\t1\t34.692307692307686\n954920\t99999\t2003-01-06 06:00:00.0\t1041832800\tFM-12\t140\t1\tN\t6.2\t1\t37.7\t1\t34.692307692307686\n954920\t99999\t2003-01-06 08:00:00.0\t1041840000\tFM-12\t100\t1\tN\t5.1\t1\t37.5\t1\t34.07142857142857\n954920\t99999\t2003-01-06 09:00:00.0\t1041843600\tFM-12\t100\t1\tN\t4.1\t1\t36.9\t1\t34.07142857142857\n954920\t99999\t2003-01-06 11:00:00.0\t1041850800\tFM-12\t080\t1\tN\t2.6\t1\t34.0\t1\t33.07857142857143\n954920\t99999\t2003-01-06 12:00:00.0\t1041854400\tFM-12\t090\t1\tN\t3.6\t1\t33.3\t1\t33.07857142857143\n954920\t99999\t2003-01-06 14:00:00.0\t1041861600\tFM-12\t080\t1\tN\t3.6\t1\t31.4\t1\t32.84285714285714\n954920\t99999\t2003-01-06 15:00:00.0\t1041865200\tFM-12\t080\t1\tN\t4.1\t1\t31.0\t1\t32.84285714285714\n954920\t99999\t2003-01-06 17:00:00.0\t1041872400\tFM-12\t080\t1\tN\t3.1\t1\t28.2\t1\t32.77142857142858\n954920\t99999\t2003-01-06 18:00:00.0\t1041876000\tFM-12\t060\t1\tN\t3.1\t1\t27.4\t1\t32.77142857142858\n954920\t99999\t2003-01-06 20:00:00.0\t1041883200\tFM-12\t070\t1\tN\t2.6\t1\t25.5\t1\t32.971428571428575\n954920\t99999\t2003-01-06 21:00:00.0\t1041886800\tFM-12\t070\t1\tN\t4.1\t1\t28.8\t1\t32.971428571428575\n954920\t99999\t2003-01-06 23:00:00.0\t1041894000\tFM-12\t010\t1\tN\t7.2\t1\t34.3\t1\t33.66428571428572\n954920\t99999\t2003-01-07 00:00:00.0\t1041897600\tFM-12\t360\t1\tN\t7.2\t1\t35.8\t1\t33.66428571428572\n954920\t99999\t2003-01-07 02:00:00.0\t1041904800\tFM-12\t040\t1\tN\t6.2\t1\t37.1\t1\t33.94285714285714\n954920\t99999\t2003-01-07 03:00:00.0\t1041908400\tFM-12\t040\t1\tN\t4.6\t1\t37.6\t1\t33.94285714285714\n954920\t99999\t2003-01-07 05:00:00.0\t1041915600\tFM-12\t050\t1\tN\t3.6\t1\t38.5\t1\t34.15\n954920\t99999\t2003-01-07 06:00:00.0\t1041919200\tFM-12\t070\t1\tN\t3.1\t1\t38.7\t1\t34.15\n954920\t99999\t2003-01-07 08:00:00.0\t1041926400\tFM-12\t080\t1\tN\t3.6\t1\t39.1\t1\t34.02142857142857\n954920\t99999\t2003-01-07 09:00:00.0\t1041930000\tFM-12\t100\t1\tN\t3.6\t1\t37.9\t1\t34.02142857142857\n"}]},"apps":[],"jobName":"paragraph_1521912751088_-114440675","id":"20180320-170247_471850660","dateCreated":"2018-03-24T17:32:31+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:16859"},{"dateUpdated":"2018-03-24T17:32:31+0000","config":{"colWidth":12,"editorMode":"ace/mode/scala","results":{},"enabled":true,"editorSetting":{"language":"scala","editOnDblClick":false}},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1521912751088_-114440675","id":"20180320-172048_924710381","dateCreated":"2018-03-24T17:32:31+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:16860"}],"name":"Spark DataFrame Window Functions","id":"2D8J8DTZJ","angularObjects":{"2D98FMAH1:shared_process":[],"2D7JMBHMW:shared_process":[],"2D97KQQMQ:shared_process":[],"2D75J9G8A:shared_process":[],"2D7EN88U2:shared_process":[],"2D9JW72F7:shared_process":[],"2D833H41P:shared_process":[],"2D9GNB6ZN:shared_process":[],"2D6C3QSGG:shared_process":[]},"config":{"looknfeel":"default","personalizedMode":"false"},"info":{}}