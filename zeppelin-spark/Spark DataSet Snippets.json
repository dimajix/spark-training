{"paragraphs":[{"text":"%md\n# Creating DataSets","dateUpdated":"Jun 17, 2016 8:51:01 PM","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/markdown","editorHide":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1466194467057_-1690552456","id":"20160617-201427_857258739","result":{"code":"SUCCESS","type":"HTML","msg":"<h1>Creating DataSets</h1>\n"},"dateCreated":"Jun 17, 2016 8:14:27 PM","dateStarted":"Jun 17, 2016 8:14:35 PM","dateFinished":"Jun 17, 2016 8:14:35 PM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:4293"},{"text":"case class Person(\n    name:String,\n    gender:String,\n    age:Int)\n{\n}","dateUpdated":"Jun 18, 2016 9:33:45 AM","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1466193738720_1658791373","id":"20160617-200218_1910498306","result":{"code":"SUCCESS","type":"TEXT","msg":"defined class Person\n"},"dateCreated":"Jun 17, 2016 8:02:18 PM","dateStarted":"Jun 18, 2016 9:33:45 AM","dateFinished":"Jun 18, 2016 9:33:45 AM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:4294","focus":true},{"text":"val persons = Seq(\n        Person(\"Alice\", \"female\", 32), \n        Person(\"Bob\", \"male\", 24),\n        Person(\"Christine\", \"female\", 42), \n        Person(\"Dale\", \"male\", 19),\n        Person(\"Eve\", \"female\", 33)\n    ).toDS\npersons.collect()","dateUpdated":"Jun 18, 2016 6:50:48 AM","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1466193986034_575306177","id":"20160617-200626_1254551091","result":{"code":"SUCCESS","type":"TEXT","msg":"persons: org.apache.spark.sql.Dataset[Person] = [name: string, gender: string, age: int]\nres2: Array[Person] = Array(Person(Alice,female,32), Person(Bob,male,24), Person(Christine,female,42), Person(Dale,male,19), Person(Eve,female,33))\n"},"dateCreated":"Jun 17, 2016 8:06:26 PM","dateStarted":"Jun 18, 2016 6:50:48 AM","dateFinished":"Jun 18, 2016 6:50:58 AM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:4295"},{"text":"%md\n## Inspect Schema","dateUpdated":"Jun 17, 2016 8:54:25 PM","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/markdown","editorHide":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1466196827360_706219177","id":"20160617-205347_1951340760","result":{"code":"SUCCESS","type":"HTML","msg":"<h2>Inspect Schema</h2>\n"},"dateCreated":"Jun 17, 2016 8:53:47 PM","dateStarted":"Jun 17, 2016 8:54:25 PM","dateFinished":"Jun 17, 2016 8:54:25 PM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:4296"},{"text":"persons.schema","dateUpdated":"Jun 18, 2016 6:50:51 AM","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1466194406844_122872119","id":"20160617-201326_798645553","result":{"code":"SUCCESS","type":"TEXT","msg":"res4: org.apache.spark.sql.types.StructType = StructType(StructField(name,StringType,true), StructField(gender,StringType,true), StructField(age,IntegerType,false))\n"},"dateCreated":"Jun 17, 2016 8:13:26 PM","dateStarted":"Jun 18, 2016 6:50:51 AM","dateFinished":"Jun 18, 2016 6:50:58 AM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:4297"},{"text":"%md\n# Pretty Printing","dateUpdated":"Jun 18, 2016 5:43:59 AM","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/markdown","editorHide":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1466228628176_641579423","id":"20160618-054348_706632489","result":{"code":"SUCCESS","type":"HTML","msg":"<h1>Pretty Printing</h1>\n"},"dateCreated":"Jun 18, 2016 5:43:48 AM","dateStarted":"Jun 18, 2016 5:43:56 AM","dateFinished":"Jun 18, 2016 5:43:56 AM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:4298"},{"text":"import org.apache.spark.sql.Dataset\n\nimplicit class DataSetZeppelinOutput[T](ds:Dataset[T]) {\n    def toZeppelin(limit:Int = -1)  = {\n        val df = ds.toDF\n        println(\"%table\")\n        println(df.schema.map(_.name).mkString(\"\\t\"))\n        val data = if (limit <= 0) df else df.limit(limit)\n        data.collect.foreach(row => println(row.mkString(\"\\t\")))\n    }\n}","dateUpdated":"Jun 18, 2016 6:50:53 AM","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1466228459524_1028238388","id":"20160618-054059_1129017124","result":{"code":"SUCCESS","type":"TEXT","msg":"import org.apache.spark.sql.Dataset\ndefined class DataSetZeppelinOutput\n"},"dateCreated":"Jun 18, 2016 5:40:59 AM","dateStarted":"Jun 18, 2016 6:50:58 AM","dateFinished":"Jun 18, 2016 6:50:59 AM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:4299"},{"text":"persons.toZeppelin()","dateUpdated":"Jun 18, 2016 6:50:58 AM","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1466228617847_-1352204702","id":"20160618-054337_2135335309","result":{"code":"SUCCESS","type":"TABLE","msg":"name\tgender\tage\nAlice\tfemale\t32\nBob\tmale\t24\nChristine\tfemale\t42\nDale\tmale\t19\nEve\tfemale\t33\n","comment":"","msgTable":[[{"key":"gender","value":"Alice"},{"key":"gender","value":"female"},{"key":"gender","value":"32"}],[{"key":"age","value":"Bob"},{"key":"age","value":"male"},{"key":"age","value":"24"}],[{"value":"Christine"},{"value":"female"},{"value":"42"}],[{"value":"Dale"},{"value":"male"},{"value":"19"}],[{"value":"Eve"},{"value":"female"},{"value":"33"}]],"columnNames":[{"name":"name","index":0,"aggr":"sum"},{"name":"gender","index":1,"aggr":"sum"},{"name":"age","index":2,"aggr":"sum"}],"rows":[["Alice","female","32"],["Bob","male","24"],["Christine","female","42"],["Dale","male","19"],["Eve","female","33"]]},"dateCreated":"Jun 18, 2016 5:43:37 AM","dateStarted":"Jun 18, 2016 6:50:59 AM","dateFinished":"Jun 18, 2016 6:51:00 AM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:4300"},{"text":"%md\n## Use DataFrame-Like API","dateUpdated":"Jun 17, 2016 8:54:37 PM","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/markdown","editorHide":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1466196855694_-263686828","id":"20160617-205415_2045240993","result":{"code":"SUCCESS","type":"HTML","msg":"<h2>Use DataFrame-Like API</h2>\n"},"dateCreated":"Jun 17, 2016 8:54:15 PM","dateStarted":"Jun 17, 2016 8:54:25 PM","dateFinished":"Jun 17, 2016 8:54:25 PM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:4301"},{"text":"persons.select($\"name\".as[String], $\"age\".as[String]).toZeppelin()","dateUpdated":"Jun 18, 2016 6:51:09 AM","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1466229185316_540199470","id":"20160618-055305_406692908","result":{"code":"SUCCESS","type":"TABLE","msg":"name\tage\nAlice\t32\nBob\t24\nChristine\t42\nDale\t19\nEve\t33\n","comment":"","msgTable":[[{"key":"age","value":"Alice"},{"key":"age","value":"32"}],[{"value":"Bob"},{"value":"24"}],[{"value":"Christine"},{"value":"42"}],[{"value":"Dale"},{"value":"19"}],[{"value":"Eve"},{"value":"33"}]],"columnNames":[{"name":"name","index":0,"aggr":"sum"},{"name":"age","index":1,"aggr":"sum"}],"rows":[["Alice","32"],["Bob","24"],["Christine","42"],["Dale","19"],["Eve","33"]]},"dateCreated":"Jun 18, 2016 5:53:05 AM","dateStarted":"Jun 18, 2016 6:51:09 AM","dateFinished":"Jun 18, 2016 6:51:10 AM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:4302"},{"text":"%md\n## Attention: Schema Mismatch!","dateUpdated":"Jun 18, 2016 5:57:09 AM","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/markdown","editorHide":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1466229180306_2147310950","id":"20160618-055300_955043762","result":{"code":"SUCCESS","type":"HTML","msg":"<h2>Attention: Schema Mismatch!</h2>\n"},"dateCreated":"Jun 18, 2016 5:53:00 AM","dateStarted":"Jun 18, 2016 5:57:05 AM","dateFinished":"Jun 18, 2016 5:57:05 AM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:4303"},{"text":"val result = persons.select($\"name\".as[String], $\"age\".as[String])\n\nprintln(persons.schema)\nprintln(result.schema)\nprintln(result.toDF.schema)","dateUpdated":"Jun 18, 2016 6:51:18 AM","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1466229431520_204266063","id":"20160618-055711_1113780936","result":{"code":"SUCCESS","type":"TEXT","msg":"result: org.apache.spark.sql.Dataset[(String, String)] = [_1: string, _2: string]\nStructType(StructField(name,StringType,true), StructField(gender,StringType,true), StructField(age,IntegerType,false))\nStructType(StructField(_1,StringType,true), StructField(_2,StringType,true))\nStructType(StructField(name,StringType,true), StructField(age,IntegerType,false))\n"},"dateCreated":"Jun 18, 2016 5:57:11 AM","dateStarted":"Jun 18, 2016 6:51:18 AM","dateFinished":"Jun 18, 2016 6:51:19 AM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:4304"},{"text":"%md\n## Joining","dateUpdated":"Jun 18, 2016 6:48:16 AM","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/markdown","editorHide":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1466232476961_1209553045","id":"20160618-064756_323624134","result":{"code":"SUCCESS","type":"HTML","msg":"<h2>Joining</h2>\n"},"dateCreated":"Jun 18, 2016 6:47:56 AM","dateStarted":"Jun 18, 2016 6:48:03 AM","dateFinished":"Jun 18, 2016 6:48:03 AM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:4305"},{"text":"case class PersonAddress (\n    name:String,\n    city:String\n) { }\n\nval addresses = Seq(\n    PersonAddress(\"Alice\", \"Frankfurt\"),\n    PersonAddress(\"Bob\", \"Berlin\")\n    ).toDS","dateUpdated":"Jun 18, 2016 6:53:10 AM","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1466232486342_-723810178","id":"20160618-064806_552944470","result":{"code":"SUCCESS","type":"TEXT","msg":"defined class PersonAddress\naddresses: org.apache.spark.sql.Dataset[PersonAddress] = [name: string, city: string]\n"},"dateCreated":"Jun 18, 2016 6:48:06 AM","dateStarted":"Jun 18, 2016 6:53:10 AM","dateFinished":"Jun 18, 2016 6:53:11 AM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:4306"},{"text":"persons.as(\"person\").joinWith(addresses.as(\"address\"), $\"person.name\" === $\"address.name\").toZeppelin()","dateUpdated":"Jun 18, 2016 6:55:05 AM","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1466232795091_1899852224","id":"20160618-065315_531175389","result":{"code":"SUCCESS","type":"TABLE","msg":"_1\t_2\n[Alice,female,32]\t[Alice,Frankfurt]\n[Bob,male,24]\t[Bob,Berlin]\n","comment":"","msgTable":[[{"key":"_2","value":"[Alice,female,32]"},{"key":"_2","value":"[Alice,Frankfurt]"}],[{"value":"[Bob,male,24]"},{"value":"[Bob,Berlin]"}]],"columnNames":[{"name":"_1","index":0,"aggr":"sum"},{"name":"_2","index":1,"aggr":"sum"}],"rows":[["[Alice,female,32]","[Alice,Frankfurt]"],["[Bob,male,24]","[Bob,Berlin]"]]},"dateCreated":"Jun 18, 2016 6:53:15 AM","dateStarted":"Jun 18, 2016 6:55:05 AM","dateFinished":"Jun 18, 2016 6:55:13 AM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:4307"},{"text":"%md\n## Grouping","dateUpdated":"Jun 18, 2016 6:03:04 AM","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/markdown","editorHide":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1466229667311_-1699149687","id":"20160618-060107_408877976","result":{"code":"SUCCESS","type":"HTML","msg":"<h2>Grouping</h2>\n"},"dateCreated":"Jun 18, 2016 6:01:07 AM","dateStarted":"Jun 18, 2016 6:03:04 AM","dateFinished":"Jun 18, 2016 6:03:04 AM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:4308"},{"text":"persons.groupBy(_.gender)\n    .agg(sum($\"age\").as(\"sum_age\").as[Long])\n    .toZeppelin()","dateUpdated":"Jun 18, 2016 6:51:41 AM","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[{"name":"value","index":0,"aggr":"sum"}],"values":[],"groups":[],"scatter":{"xAxis":{"name":"value","index":0,"aggr":"sum"}}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1466196866702_1174904634","id":"20160617-205426_874417461","result":{"code":"SUCCESS","type":"TABLE","msg":"value\tsum_age\nfemale\t107\nmale\t43\n","comment":"","msgTable":[[{"key":"sum_age","value":"female"},{"key":"sum_age","value":"107"}],[{"value":"male"},{"value":"43"}]],"columnNames":[{"name":"value","index":0,"aggr":"sum"},{"name":"sum_age","index":1,"aggr":"sum"}],"rows":[["female","107"],["male","43"]]},"dateCreated":"Jun 17, 2016 8:54:26 PM","dateStarted":"Jun 18, 2016 5:56:25 AM","dateFinished":"Jun 18, 2016 5:56:30 AM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:4309"},{"text":"def avg_age(persons:Iterator[Person]) = {\n    val (age,count) = persons\n        .map(p => (p.age,1))\n        .reduce((l,r) => (l._1 + r._1, l._2 + r._2))\n        \n    age.toFloat / count.toFloat\n}\n\npersons.groupBy(_.gender)\n  .mapGroups { case (key,values) => (key, avg_age(values)) }\n  .toZeppelin()","dateUpdated":"Jun 18, 2016 6:51:31 AM","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[{"name":"_1","index":0,"aggr":"sum"}],"values":[{"name":"_2","index":1,"aggr":"sum"}],"groups":[],"scatter":{"xAxis":{"name":"_1","index":0,"aggr":"sum"},"yAxis":{"name":"_2","index":1,"aggr":"sum"}}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1466229680109_-1186633503","id":"20160618-060120_1186022942","result":{"code":"SUCCESS","type":"TABLE","msg":"_1\t_2\nfemale\t35.666668\nmale\t21.5\n","comment":"","msgTable":[[{"key":"_2","value":"female"},{"key":"_2","value":"35.666668"}],[{"value":"male"},{"value":"21.5"}]],"columnNames":[{"name":"_1","index":0,"aggr":"sum"},{"name":"_2","index":1,"aggr":"sum"}],"rows":[["female","35.666668"],["male","21.5"]]},"dateCreated":"Jun 18, 2016 6:01:20 AM","dateStarted":"Jun 18, 2016 6:51:31 AM","dateFinished":"Jun 18, 2016 6:51:35 AM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:4310"},{"text":"%md\n## Convert to RDD","dateUpdated":"Jun 18, 2016 5:40:19 AM","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/markdown","editorHide":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1466194435746_536892584","id":"20160617-201355_1310344176","result":{"code":"SUCCESS","type":"HTML","msg":"<h2>Convert to RDD</h2>\n"},"dateCreated":"Jun 17, 2016 8:13:55 PM","dateStarted":"Jun 17, 2016 8:20:59 PM","dateFinished":"Jun 17, 2016 8:20:59 PM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:4311"},{"text":"val rdd = persons.as[Person]\n\nrdd.collect()","dateUpdated":"Jun 18, 2016 6:51:47 AM","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1466228352141_-973579491","id":"20160618-053912_1439030409","result":{"code":"SUCCESS","type":"TEXT","msg":"rdd: org.apache.spark.sql.Dataset[Person] = [name: string, gender: string, age: int]\nres24: Array[Person] = Array(Person(Alice,female,32), Person(Bob,male,24), Person(Christine,female,42), Person(Dale,male,19), Person(Eve,female,33))\n"},"dateCreated":"Jun 18, 2016 5:39:12 AM","dateStarted":"Jun 18, 2016 6:51:47 AM","dateFinished":"Jun 18, 2016 6:51:48 AM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:4312"},{"text":"%md\n## Convert back RDD to DataSet","dateUpdated":"Jun 18, 2016 5:40:16 AM","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/markdown","editorHide":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1466228393102_448128991","id":"20160618-053953_1578828210","result":{"code":"SUCCESS","type":"HTML","msg":"<h2>Convert back RDD to DataSet</h2>\n"},"dateCreated":"Jun 18, 2016 5:39:53 AM","dateStarted":"Jun 18, 2016 5:40:14 AM","dateFinished":"Jun 18, 2016 5:40:14 AM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:4313"},{"text":"val ds = rdd.toDS","dateUpdated":"Jun 18, 2016 6:52:04 AM","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1466228366038_-1578789511","id":"20160618-053926_647385200","result":{"code":"SUCCESS","type":"TEXT","msg":"ds: org.apache.spark.sql.Dataset[Person] = [name: string, gender: string, age: int]\n"},"dateCreated":"Jun 18, 2016 5:39:26 AM","dateStarted":"Jun 18, 2016 6:52:04 AM","dateFinished":"Jun 18, 2016 6:52:05 AM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:4314"},{"text":"%md\n## Write to Parquet\n\n1. Convert to DataFrame\n2. Write DataFrame to Parquet","dateUpdated":"Jun 18, 2016 5:34:51 AM","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/markdown","editorHide":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1466194512616_-908666070","id":"20160617-201512_1954263996","result":{"code":"SUCCESS","type":"HTML","msg":"<h2>Write to Parquet</h2>\n<ol>\n<li>Convert to DataFrame</li>\n<li>Write DataFrame to Parquet</li>\n</ol>\n"},"dateCreated":"Jun 17, 2016 8:15:12 PM","dateStarted":"Jun 18, 2016 5:34:49 AM","dateFinished":"Jun 18, 2016 5:34:49 AM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:4315"},{"text":"import org.apache.spark.sql.SaveMode\n\nval df = persons.toDF\n\ndf.write.mode(SaveMode.Overwrite).parquet(\"persons.parquet\")","dateUpdated":"Jun 18, 2016 6:52:34 AM","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala","editorHide":false},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1466194423105_-1949370133","id":"20160617-201343_563402997","result":{"code":"SUCCESS","type":"TEXT","msg":"import org.apache.spark.sql.SaveMode\ndf: org.apache.spark.sql.DataFrame = [name: string, gender: string, age: int]\n"},"dateCreated":"Jun 17, 2016 8:13:43 PM","dateStarted":"Jun 18, 2016 5:48:14 AM","dateFinished":"Jun 18, 2016 5:48:16 AM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:4316"},{"text":"%md\n## Read from Parquet\n1. Read DataFrame from Parquet\n2. Convert DataFrame to DataSet","dateUpdated":"Jun 18, 2016 5:35:16 AM","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/markdown","editorHide":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1466196559189_483481857","id":"20160617-204919_1431109393","result":{"code":"SUCCESS","type":"HTML","msg":"<h2>Read from Parquet</h2>\n<ol>\n<li>Read DataFrame from Parquet</li>\n<li>Convert DataFrame to DataSet</li>\n</ol>\n"},"dateCreated":"Jun 17, 2016 8:49:19 PM","dateStarted":"Jun 18, 2016 5:35:12 AM","dateFinished":"Jun 18, 2016 5:35:12 AM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:4317"},{"text":"val df = sqlContext.read.parquet(\"persons.parquet\")\n\nval ds = df.as[Person]\n\nds.toZeppelin()","dateUpdated":"Jun 18, 2016 5:52:09 AM","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[{"name":"name","index":0,"aggr":"sum"}],"values":[{"name":"gender","index":1,"aggr":"sum"}],"groups":[],"scatter":{"xAxis":{"name":"name","index":0,"aggr":"sum"},"yAxis":{"name":"gender","index":1,"aggr":"sum"}}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1466196572030_-1303676784","id":"20160617-204932_794634446","result":{"code":"SUCCESS","type":"TABLE","msg":"name\tgender\tage\nAlice\tfemale\t32\nBob\tmale\t24\nChristine\tfemale\t42\nDale\tmale\t19\nEve\tfemale\t33\n","comment":"","msgTable":[[{"key":"gender","value":"Alice"},{"key":"gender","value":"female"},{"key":"gender","value":"32"}],[{"key":"age","value":"Bob"},{"key":"age","value":"male"},{"key":"age","value":"24"}],[{"value":"Christine"},{"value":"female"},{"value":"42"}],[{"value":"Dale"},{"value":"male"},{"value":"19"}],[{"value":"Eve"},{"value":"female"},{"value":"33"}]],"columnNames":[{"name":"name","index":0,"aggr":"sum"},{"name":"gender","index":1,"aggr":"sum"},{"name":"age","index":2,"aggr":"sum"}],"rows":[["Alice","female","32"],["Bob","male","24"],["Christine","female","42"],["Dale","male","19"],["Eve","female","33"]]},"dateCreated":"Jun 17, 2016 8:49:32 PM","dateStarted":"Jun 18, 2016 5:52:09 AM","dateFinished":"Jun 18, 2016 5:52:15 AM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:4318"},{"config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/markdown","editorHide":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1466194935909_-1270284064","id":"20160617-202215_225550959","dateCreated":"Jun 17, 2016 8:22:15 PM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:4319","text":"%md\n# Nested Classes","dateUpdated":"Jun 18, 2016 9:33:39 AM","dateFinished":"Jun 18, 2016 9:33:35 AM","dateStarted":"Jun 18, 2016 9:33:35 AM","result":{"code":"SUCCESS","type":"HTML","msg":"<h1>Nested Classes</h1>\n"}},{"config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1466242415725_1569511021","id":"20160618-093335_468111792","dateCreated":"Jun 18, 2016 9:33:35 AM","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:4790","dateUpdated":"Jun 18, 2016 9:37:09 AM","dateFinished":"Jun 18, 2016 9:37:09 AM","dateStarted":"Jun 18, 2016 9:37:09 AM","result":{"code":"SUCCESS","type":"TEXT","msg":"defined class Address\ndefined class Person\n"},"text":"case class Address(\n    city:String,\n    street:String\n)\n    \ncase class Person(\n    name:String,\n    gender:String,\n    addresses:Array[Address]\n)\n"},{"config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1466242492288_1073843879","id":"20160618-093452_1868521561","dateCreated":"Jun 18, 2016 9:34:52 AM","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:4814","dateUpdated":"Jun 18, 2016 9:37:12 AM","dateFinished":"Jun 18, 2016 9:37:13 AM","dateStarted":"Jun 18, 2016 9:37:12 AM","result":{"code":"SUCCESS","type":"TEXT","msg":"ds: org.apache.spark.sql.Dataset[Person] = [name: string, gender: string, addresses: array<struct<city:string,street:string>>]\n"},"text":"val ds = Seq(\n    Person(\"Alice\",\"female\",Array(Address(\"Berlin\",\"Hauptstra√üe 2\"),Address(\"Stuttgart\",\"Am Anger 13\"))),\n    Person(\"Bob\",\"male\",Array(Address(\"Mainz\",\"Kellergasse 23\")))\n).toDS"},{"config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1466242773089_-1561314494","id":"20160618-093933_727106056","dateCreated":"Jun 18, 2016 9:39:33 AM","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:4913","text":"ds.printSchema()","dateUpdated":"Jun 18, 2016 9:39:38 AM","dateFinished":"Jun 18, 2016 9:39:39 AM","dateStarted":"Jun 18, 2016 9:39:38 AM","result":{"code":"SUCCESS","type":"TEXT","msg":"root\n |-- name: string (nullable = true)\n |-- gender: string (nullable = true)\n |-- addresses: array (nullable = true)\n |    |-- element: struct (containsNull = true)\n |    |    |-- city: string (nullable = true)\n |    |    |-- street: string (nullable = true)\n\n"}},{"config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1466242582520_-1490367978","id":"20160618-093622_1119250452","dateCreated":"Jun 18, 2016 9:36:22 AM","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:4834","dateUpdated":"Jun 18, 2016 9:38:08 AM","dateFinished":"Jun 18, 2016 9:38:17 AM","dateStarted":"Jun 18, 2016 9:38:08 AM","result":{"code":"SUCCESS","type":"TEXT","msg":"import org.apache.spark.sql.SaveMode\n"},"text":"import org.apache.spark.sql.SaveMode\n\nds.toDF.write.mode(SaveMode.Overwrite).parquet(\"persons2.parquet\")"},{"config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1466242665769_1194733299","id":"20160618-093745_1829082972","dateCreated":"Jun 18, 2016 9:37:45 AM","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:4864","dateUpdated":"Jun 18, 2016 9:39:17 AM","dateFinished":"Jun 18, 2016 9:39:18 AM","dateStarted":"Jun 18, 2016 9:39:17 AM","result":{"code":"SUCCESS","type":"TEXT","msg":"ds: org.apache.spark.sql.Dataset[Person] = [name: string, gender: string, addresses: array<struct<city:string,street:string>>]\nres282: Int = 3\n"},"text":"val ds = sqlContext.read.parquet(\"persons2.parquet\").as[Person]\n\nds.collect().map(p => p.addresses.size).reduce(_ + _)"},{"config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1466242720140_-115690282","id":"20160618-093840_324274912","dateCreated":"Jun 18, 2016 9:38:40 AM","status":"READY","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:4889"}],"name":"Spark DataSet Snippets","id":"2BR176FHA","angularObjects":{"2B44YVSN1":[],"2AJXGMUUJ":[],"2AK8P7CPX":[],"2AM1YV5CU":[],"2AKK3QQXU":[],"2ANGGHHMQ":[]},"config":{"looknfeel":"default"},"info":{}}