{"paragraphs":[{"user":"anonymous","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1542700549786_1306742688","id":"20181120-075549_878017001","dateCreated":"2018-11-20T07:55:49+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:1151","text":"%md\n# Counting Words\nIn this exercise we try to determine the word frequencies of a text document (Alice in Wonderland). There are multiple different approaches, we chose the following one\n1. Open text file from `/home/hadoop/spark-training/data/alice-in-wonderland.txt`.\n2. Read in all lines using the method `getLines` and convert it to a Scala sequence using the method `toSeq`. Now you have a Scala sequence.\n3. Split all lines into individual words using the sequence method `flatMap` with the String method `split(\" \")` applied to all lines.\n4. Throw away empty words using the sequence method `filter`.\n5. Group the result by the words themselves using `groupBy`. This will return a Scala Map with words as keys.\n6. Count the number of words per Map key using `mapValues` and convert the result back to a Scala sequence using `toSeq`\n7. Sort the result by frequency using the sequence method `sortBy`","dateUpdated":"2018-11-20T07:55:56+0000","dateFinished":"2018-11-20T07:55:56+0000","dateStarted":"2018-11-20T07:55:56+0000","results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h1>Counting Words</h1>\n<p>In this exercise we try to determine the word frequencies of a text document (Alice in Wonderland). There are multiple different approaches, we chose the following one<br/>1. Open text file from <code>/home/hadoop/spark-training/data/alice-in-wonderland.txt</code>.<br/>2. Read in all lines using the method <code>getLines</code> and convert it to a Scala sequence using the method <code>toSeq</code>. Now you have a Scala sequence.<br/>3. Split all lines into individual words using the sequence method <code>flatMap</code> with the String method <code>split(&quot; &quot;)</code> applied to all lines.<br/>4. Throw away empty words using the sequence method <code>filter</code>.<br/>5. Group the result by the words themselves using <code>groupBy</code>. This will return a Scala Map with words as keys.<br/>6. Count the number of words per Map key using <code>mapValues</code> and convert the result back to a Scala sequence using <code>toSeq</code><br/>7. Sort the result by frequency using the sequence method <code>sortBy</code></p>\n</div>"}]}},{"text":"import scala.io.Source\n\nval s = Source.fromFile(\"/home/hadoop/spark-training/data/alice-in-wonderland.txt\")\nval result = s.getLines.toSeq\n    .flatMap(_.split(\" \"))\n    .filter(_ != \"\")\n    .groupBy(x => x)\n    .mapValues(_.size)\n    .toSeq\n    .sortBy(-_._2)","dateUpdated":"2018-11-20T07:48:00+0000","config":{"editorMode":"ace/mode/scala","colWidth":12,"enabled":true,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"results":{},"editorSetting":{"language":"scala","editOnDblClick":false}},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1542643017381_-1514375818","id":"20160620-055108_1345737965","dateCreated":"2018-11-19T15:56:57+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:939"},{"text":"","dateUpdated":"2018-11-19T15:56:57+0000","config":{"colWidth":12,"editorMode":"ace/mode/scala","enabled":true,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"results":{},"editorSetting":{"language":"scala","editOnDblClick":false}},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1542643017385_-1515914814","id":"20160620-055218_390077905","dateCreated":"2018-11-19T15:56:57+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:940"}],"name":"Scala Introduction - WordCount - Full","id":"2DXR3935T","angularObjects":{"2D8DSN3N4:shared_process":[],"2D7W55G1J:shared_process":[],"2DA3X6UGN:shared_process":[],"2D9HTU14T:shared_process":[],"2DBA6X8JB:shared_process":[],"2DBSCZXK2:shared_process":[],"2D9M853BP:shared_process":[],"2DAXFQ4X2:shared_process":[],"2DB3TEGGU:shared_process":[]},"config":{"looknfeel":"default","personalizedMode":"false"},"info":{}}